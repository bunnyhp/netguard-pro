{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\ai_5min_aggregator.py","fileUuid":"73ff8ded-be31-4d42-b0fe-0994bf5df402","fileSizeBytes":20074,"numLines":538,"diffChanges":[{"originalStartLineNumberOneIndexed":69,"originalEndLineNumberExclusiveOneIndexed":69,"modifiedStartLineNumberOneIndexed":69,"modifiedEndLineNumberExclusiveOneIndexed":71,"addedLines":["        unique_devices = set()","        os_distribution = {}"],"tokenizedAddedLines":[1000344,1000345]},{"originalStartLineNumberOneIndexed":73,"originalEndLineNumberExclusiveOneIndexed":73,"modifiedStartLineNumberOneIndexed":75,"modifiedEndLineNumberExclusiveOneIndexed":92,"addedLines":["            ","            for row in rows:","                row_dict = dict(row)","                src_ip = row_dict.get('src_ip')","                dest_ip = row_dict.get('dest_ip')","                os_name = row_dict.get('os_name')","                ","                # Collect unique IPs","                if src_ip:","                    unique_devices.add(src_ip)","                if dest_ip:","                    unique_devices.add(dest_ip)","                ","                # Count OS distribution","                if os_name and os_name != '':","                    os_distribution[os_name] = os_distribution.get(os_name, 0) + 1","            "],"tokenizedAddedLines":[240,74,1000346,1000347,1000348,1000349,326,1000350,1000351,1000352,1000353,1000354,326,1000355,1000356,1000357,240]},{"originalStartLineNumberOneIndexed":76,"originalEndLineNumberExclusiveOneIndexed":77,"modifiedStartLineNumberOneIndexed":95,"modifiedEndLineNumberExclusiveOneIndexed":97,"addedLines":["                'unique_ips': len(unique_devices),","                'os_distribution': os_distribution"],"tokenizedAddedLines":[1000358,1000359]},{"originalStartLineNumberOneIndexed":87,"originalEndLineNumberExclusiveOneIndexed":88,"modifiedStartLineNumberOneIndexed":107,"modifiedEndLineNumberExclusiveOneIndexed":109,"addedLines":["                row_dict = dict(row)","                proto = row_dict.get('protocol', 'Unknown')"],"tokenizedAddedLines":[1000346,1000360]},{"originalStartLineNumberOneIndexed":89,"originalEndLineNumberExclusiveOneIndexed":89,"modifiedStartLineNumberOneIndexed":110,"modifiedEndLineNumberExclusiveOneIndexed":119,"addedLines":["                ","                # Add unique IPs to device list","                src_ip = row_dict.get('src_ip')","                dest_ip = row_dict.get('dest_ip')","                if src_ip and not src_ip.startswith('127.') and src_ip != '::1':","                    unique_devices.add(src_ip)","                if dest_ip and not dest_ip.startswith('127.') and dest_ip != '::1':","                    unique_devices.add(dest_ip)","            "],"tokenizedAddedLines":[326,1000361,1000347,1000348,1000362,1000352,1000363,1000354,240]},{"originalStartLineNumberOneIndexed":132,"originalEndLineNumberExclusiveOneIndexed":132,"modifiedStartLineNumberOneIndexed":162,"modifiedEndLineNumberExclusiveOneIndexed":173,"addedLines":["            ","            # Collect unique devices from tcpdump","            for row in rows:","                row_dict = dict(row)","                src_ip = row_dict.get('src_ip')","                dest_ip = row_dict.get('dest_ip')","                if src_ip and not src_ip.startswith('127.') and src_ip != '::1':","                    unique_devices.add(src_ip)","                if dest_ip and not dest_ip.startswith('127.') and dest_ip != '::1':","                    unique_devices.add(dest_ip)","            "],"tokenizedAddedLines":[240,1000364,74,1000346,1000347,1000348,1000362,1000352,1000363,1000354,240]},{"originalStartLineNumberOneIndexed":204,"originalEndLineNumberExclusiveOneIndexed":204,"modifiedStartLineNumberOneIndexed":245,"modifiedEndLineNumberExclusiveOneIndexed":252,"addedLines":["        # Add network summary with device count","        data['network_summary'] = {","            'total_unique_devices': len(unique_devices),","            'unique_ips': sorted(list(unique_devices)),","            'os_distribution': os_distribution","        }","        "],"tokenizedAddedLines":[1000365,1000366,1000367,1000368,1000369,58,53]},{"originalStartLineNumberOneIndexed":216,"originalEndLineNumberExclusiveOneIndexed":216,"modifiedStartLineNumberOneIndexed":264,"modifiedEndLineNumberExclusiveOneIndexed":272,"addedLines":["**IMPORTANT NOTES:**","- This is a HOME NETWORK with active security monitoring tools","- Normal traffic includes: curl, wget, tshark, tcpdump, p0f, ngrep, httpry, netsniff-ng, iftop, nethogs, suricata","- High process counts are EXPECTED due to monitoring tools running","- Local traffic to 192.168.x.x, 127.0.0.1, and ::1 is NORMAL","- Do NOT flag our own monitoring tools as threats","- Focus on EXTERNAL suspicious activity, not internal monitoring",""],"tokenizedAddedLines":[1000370,1000371,1000372,1000373,1000374,1000375,1000376,6]},{"originalStartLineNumberOneIndexed":217,"originalEndLineNumberExclusiveOneIndexed":217,"modifiedStartLineNumberOneIndexed":273,"modifiedEndLineNumberExclusiveOneIndexed":278,"addedLines":["","### NETWORK SUMMARY","- Total Unique Devices on Network: {data['network_summary']['total_unique_devices']}","- Operating Systems Detected: {json.dumps(data['network_summary']['os_distribution'], indent=2)}","- Active IP Addresses: {len(data['network_summary']['unique_ips'])} IPs"],"tokenizedAddedLines":[6,1000377,1000378,1000379,1000380]},{"originalStartLineNumberOneIndexed":221,"originalEndLineNumberExclusiveOneIndexed":221,"modifiedStartLineNumberOneIndexed":282,"modifiedEndLineNumberExclusiveOneIndexed":283,"addedLines":["- OS Distribution: {json.dumps(data['tools'].get('p0f', {}).get('os_distribution', {}), indent=2)}"],"tokenizedAddedLines":[1000381]},{"originalStartLineNumberOneIndexed":279,"originalEndLineNumberExclusiveOneIndexed":281,"modifiedStartLineNumberOneIndexed":341,"modifiedEndLineNumberExclusiveOneIndexed":343,"addedLines":["    \"total_devices\": {data['network_summary']['total_unique_devices']},","    \"operating_systems\": {json.dumps(data['network_summary']['os_distribution'])},"],"tokenizedAddedLines":[1000382,1000383]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}