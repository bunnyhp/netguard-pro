{"fsPath":"\\home\\jarvis\\NetGuard\\README.md","fileUuid":"911a791c-b0ad-4fbc-9cd7-7cb7b2d10196","fileSizeBytes":14860,"numLines":595,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":596,"addedLines":["# NetGuard Pro - Network Security Monitoring System","","**Version:** 1.0  ","**Status:** Production Ready  ","**Last Updated:** 2025-10-10","","---","","## Overview","","NetGuard Pro is a comprehensive, professional-grade home network security monitoring system that provides complete visibility into network traffic, identifies security threats, and delivers actionable insights through an intuitive web dashboard.","","### Key Features","","- **Multi-Interface Monitoring**: Captures traffic across 3 network interfaces","- **Zero Packet Loss Architecture**: Optimized for high-performance capture","- **Real-Time Threat Detection**: 45,633+ Suricata IDS rules","- **10 Specialized Tools**: Each analyzing different aspects of network traffic","- **Professional Web Dashboard**: Bootstrap 5 + DataTables for advanced data visualization","- **Automated Data Processing**: Continuous capture, conversion, and storage pipeline","","---","","## System Architecture","","### Network Interfaces","","- **eno1** (192.168.1.161): Primary Ethernet - tcpdump, Suricata, httpry, iftop, nethogs","- **wlo1** (192.168.1.244): WiFi - tshark, p0f, argus, ngrep","- **wlx1cbfce6265ad**: USB WiFi Adapter - netsniff-ng (high-performance)","","### Data Flow","","```","Network Traffic","    ↓","Capture Tools (10 tools across 3 interfaces)","    ↓","JSON/Log Files","    ↓","Conversion Scripts (Python)","    ↓","SQLite Database (Timestamped Tables)","    ↓","Flask Web Server (Port 8080)","    ↓","Web Dashboard (Browser)","```","","---","","## Directory Structure","","```","/home/jarvis/NetGuard/","├── captures/              # All raw capture files","│   ├── tcpdump/          # PCAP files from tcpdump","│   ├── suricata/         # 11 Suricata event categories","│   ├── processed_json/   # Converted JSON files","│   ├── tshark/           # tshark captures","│   ├── p0f/              # p0f fingerprints","│   ├── argus/            # argus flow data","│   ├── ngrep/            # ngrep pattern matches","│   ├── netsniff/         # netsniff-ng captures","│   ├── httpry/           # HTTP logs","│   ├── iftop/            # Bandwidth data","│   └── nethogs/          # Process bandwidth","├── scripts/              # All Python processing scripts","│   ├── init_database.py                  # Database initialization","│   ├── start_tcpdump.sh                  # tcpdump launcher","│   ├── pcap_to_json.py                   # PCAP converter","│   ├── json_to_sqlite.py                 # JSON to DB converter","│   ├── suricata_collector.py             # Suricata log processor","│   ├── tshark_collector.py               # tshark collector","│   ├── p0f_collector.py                  # p0f collector","│   ├── argus_collector.py                # argus collector","│   ├── ngrep_collector.py                # ngrep collector","│   ├── netsniff_collector.py             # netsniff-ng collector","│   ├── httpry_collector.py               # httpry collector","│   ├── iftop_collector.py                # iftop collector","│   ├── nethogs_collector.py              # nethogs collector","│   ├── analysis_tools_collector.py       # Master orchestrator","│   └── optimize_interfaces.sh            # Interface optimization","├── web/                  # Flask web application","│   ├── app.py           # Main Flask app","│   └── templates/       # HTML templates (8 files)","│       ├── base.html","│       ├── index.html","│       ├── tcpdump.html","│       ├── tcpdump_table.html","│       ├── suricata.html","│       ├── suricata_category.html","│       ├── suricata_table.html","│       ├── analysis.html","│       └── analysis_tool.html","├── configs/              # Configuration files","│   └── suricata-custom.yaml","├── services/             # Systemd service files","│   ├── network-capture.service","│   ├── pcap-json-converter.service","│   ├── json-sqlite-converter.service","│   ├── suricata-collector.service","│   ├── analysis-tools-collector.service","│   └── network-dashboard.service","├── logs/                 # System logs","│   └── system/          # Service logs","├── network.db           # SQLite database","└── README.md            # This file","```","","---","","## Installation & Setup","","### Prerequisites","","All tools should already be installed. Verify with:","","```bash","# Check tool installations","which tcpdump suricata tshark p0f argus ngrep netsniff-ng httpry iftop nethogs","python3 --version","sqlite3 --version","```","","### Step 1: Initialize Database","","```bash","cd /home/jarvis/NetGuard","python3 scripts/init_database.py","```","","This creates the SQLite database with all necessary schemas.","","### Step 2: Optimize Network Interfaces","","```bash","cd /home/jarvis/NetGuard","chmod +x scripts/optimize_interfaces.sh","sudo scripts/optimize_interfaces.sh","```","","This optimizes interfaces for packet capture (disables offloading, increases buffers).","","### Step 3: Configure Suricata","","```bash","# Update Suricata rules","sudo suricata-update","","# Copy custom config (or merge with existing)","sudo cp configs/suricata-custom.yaml /etc/suricata/suricata.yaml","","# Or edit /etc/suricata/suricata.yaml manually with settings from configs/suricata-custom.yaml","```","","### Step 4: Install Systemd Services","","```bash","cd /home/jarvis/NetGuard","","# Copy service files to systemd directory","sudo cp services/*.service /etc/systemd/system/","","# Reload systemd","sudo systemctl daemon-reload","","# Enable services to start on boot","sudo systemctl enable network-capture.service","sudo systemctl enable pcap-json-converter.service","sudo systemctl enable json-sqlite-converter.service","sudo systemctl enable suricata-collector.service","sudo systemctl enable analysis-tools-collector.service","sudo systemctl enable network-dashboard.service","```","","### Step 5: Configure Sudo Access (for analysis tools)","","Some analysis tools require root privileges. Add to sudoers:","","```bash","sudo visudo","```","","Add these lines:","","```","jarvis ALL=(ALL) NOPASSWD: /usr/bin/tcpdump","jarvis ALL=(ALL) NOPASSWD: /usr/bin/p0f","jarvis ALL=(ALL) NOPASSWD: /usr/sbin/argus","jarvis ALL=(ALL) NOPASSWD: /usr/bin/ngrep","jarvis ALL=(ALL) NOPASSWD: /usr/bin/netsniff-ng","jarvis ALL=(ALL) NOPASSWD: /usr/sbin/httpry","jarvis ALL=(ALL) NOPASSWD: /usr/sbin/iftop","jarvis ALL=(ALL) NOPASSWD: /usr/sbin/nethogs","jarvis ALL=(ALL) NOPASSWD: /usr/bin/pkill","```","","### Step 6: Start Services","","```bash","# Start Suricata (system service)","sudo systemctl start suricata","sudo systemctl enable suricata","","# Start NetGuard Pro services","sudo systemctl start network-capture.service","sudo systemctl start pcap-json-converter.service","sudo systemctl start json-sqlite-converter.service","sudo systemctl start suricata-collector.service","sudo systemctl start analysis-tools-collector.service","sudo systemctl start network-dashboard.service","```","","### Step 7: Verify Services","","```bash","# Check all service statuses","sudo systemctl status network-capture.service","sudo systemctl status pcap-json-converter.service","sudo systemctl status json-sqlite-converter.service","sudo systemctl status suricata-collector.service","sudo systemctl status analysis-tools-collector.service","sudo systemctl status network-dashboard.service","```","","### Step 8: Access Web Dashboard","","Open your browser and navigate to:","","```","http://192.168.1.161:8080","```","","Or from the same machine:","","```","http://localhost:8080","```","","---","","## Service Management","","### Start Services","","```bash","sudo systemctl start network-capture.service","sudo systemctl start pcap-json-converter.service","sudo systemctl start json-sqlite-converter.service","sudo systemctl start suricata-collector.service","sudo systemctl start analysis-tools-collector.service","sudo systemctl start network-dashboard.service","```","","### Stop Services","","```bash","sudo systemctl stop network-capture.service","sudo systemctl stop pcap-json-converter.service","sudo systemctl stop json-sqlite-converter.service","sudo systemctl stop suricata-collector.service","sudo systemctl stop analysis-tools-collector.service","sudo systemctl stop network-dashboard.service","```","","### View Service Logs","","```bash","# Real-time log viewing","sudo journalctl -u network-capture.service -f","sudo journalctl -u analysis-tools-collector.service -f","sudo journalctl -u network-dashboard.service -f","","# View service log files","tail -f logs/system/tcpdump.log","tail -f logs/system/analysis-tools.log","tail -f logs/system/dashboard-service.log","```","","### Restart Services","","```bash","sudo systemctl restart network-capture.service","sudo systemctl restart analysis-tools-collector.service","sudo systemctl restart network-dashboard.service","```","","---","","## Tools & Components","","### 1. tcpdump (eno1)","- **Purpose**: Raw packet capture","- **Rotation**: 10 minutes","- **Output**: PCAP files → JSON → SQLite tables (`network_*`)","","### 2. Suricata (eno1)","- **Purpose**: IDS/IPS + Protocol analysis","- **Rules**: 45,633+ threat detection rules","- **Categories**: 11 (alerts, http, dns, tls, files, flow, ssh, smtp, ftp, anomaly, stats)","- **Output**: SQLite tables (`suricata_*_*`)","","### 3. tshark (wlo1)","- **Purpose**: Protocol dissection and analysis","- **Output**: SQLite tables (`tshark_*`)","","### 4. p0f (wlo1)","- **Purpose**: Passive OS fingerprinting","- **Output**: SQLite tables (`p0f_*`)","","### 5. argus (wlo1)","- **Purpose**: Network flow analysis","- **Output**: SQLite tables (`argus_*`)","","### 6. ngrep (wlo1)","- **Purpose**: Pattern matching (passwords, HTTP, etc.)","- **Output**: SQLite tables (`ngrep_*`)","","### 7. netsniff-ng (wlx1cbfce6265ad)","- **Purpose**: High-performance zero-copy capture","- **Output**: SQLite tables (`netsniff_*`)","","### 8. httpry (eno1)","- **Purpose**: HTTP traffic logging","- **Output**: SQLite tables (`httpry_*`)","","### 9. iftop (eno1)","- **Purpose**: Bandwidth monitoring per connection","- **Output**: SQLite tables (`iftop_*`)","","### 10. nethogs (eno1)","- **Purpose**: Per-process bandwidth usage","- **Output**: SQLite tables (`nethogs_*`)","","---","","## Database Management","","### View Database","","```bash","sqlite3 /home/jarvis/NetGuard/network.db","","# List all tables",".tables","","# View table schema",".schema network_20251010_120000","","# Query data","SELECT * FROM network_20251010_120000 LIMIT 10;","","# Exit",".exit","```","","### Optimize Database","","```bash","# Vacuum database (reclaim space and optimize)","sqlite3 /home/jarvis/NetGuard/network.db \"VACUUM;\"","```","","### Check Database Size","","```bash","du -h /home/jarvis/NetGuard/network.db","```","","### Manual Cleanup (Optional)","","```bash","# Remove old tables (example: older than 30 days)","sqlite3 /home/jarvis/NetGuard/network.db \"DROP TABLE network_20250901_120000;\"","```","","---","","## Troubleshooting","","### Services Not Starting","","```bash","# Check service status","sudo systemctl status network-capture.service","","# View detailed logs","sudo journalctl -u network-capture.service -n 50","","# Check script permissions","ls -la /home/jarvis/NetGuard/scripts/","","# Make scripts executable","chmod +x /home/jarvis/NetGuard/scripts/*.sh","chmod +x /home/jarvis/NetGuard/scripts/*.py","```","","### No Data in Dashboard","","1. **Check if services are running:**","   ```bash","   sudo systemctl status network-capture.service","   sudo systemctl status analysis-tools-collector.service","   ```","","2. **Check if data is being captured:**","   ```bash","   ls -lah /home/jarvis/NetGuard/captures/tcpdump/","   ls -lah /home/jarvis/NetGuard/captures/processed_json/","   ```","","3. **Check database:**","   ```bash","   sqlite3 /home/jarvis/NetGuard/network.db \".tables\"","   ```","","4. **Check logs:**","   ```bash","   tail -n 50 /home/jarvis/NetGuard/logs/system/tcpdump.log","   tail -n 50 /home/jarvis/NetGuard/logs/system/analysis-tools.log","   ```","","### Permission Errors","","```bash","# Fix ownership","sudo chown -R jarvis:jarvis /home/jarvis/NetGuard","","# Fix permissions","chmod 755 /home/jarvis/NetGuard/scripts/*.sh","chmod 755 /home/jarvis/NetGuard/scripts/*.py","chmod 644 /home/jarvis/NetGuard/services/*.service","```","","### High CPU Usage","","```bash","# Check which tools are consuming CPU","top -u jarvis","","# Consider adjusting collection intervals in scripts","# Or temporarily stop non-essential collectors","```","","### Disk Space Issues","","```bash","# Check disk usage","df -h /home","","# Check NetGuard directory size","du -sh /home/jarvis/NetGuard/captures/*","","# Clean old captures manually","rm -rf /home/jarvis/NetGuard/captures/tcpdump/*.pcap","```","","---","","## Performance Specifications","","### Capture Capacity","- **tcpdump**: Up to 1 Gbps with zero packet loss","- **Suricata**: 500 Mbps with full inspection","- **netsniff-ng**: Up to 10 Gbps (hardware dependent)","","### Storage Requirements (Estimated)","- **Daily Usage**:","  - tcpdump: ~10-50 GB/day (depends on traffic)","  - Suricata: ~1-5 GB/day","  - Analysis Tools: ~500 MB/day","  - Database: ~100-500 MB/day","","### System Resources","- **CPU Usage**: 20-40% during normal operation","- **RAM Usage**: 2-4 GB","- **Network**: Minimal impact on latency","","---","","## Security Considerations","","### Threat Detection Categories","","- Port Scanning Detection","- Malware C2 Communication","- Exploit Attempts (SQL injection, XSS, RCE, etc.)","- Data Exfiltration","- Brute Force Attacks","- Policy Violations","","### Data Privacy","","- All data is stored locally on your machine","- No external data transmission","- Sensitive data (passwords, credentials) captured by ngrep should be reviewed carefully","- Consider encrypting the database for additional security","","---","","## Maintenance","","### Regular Tasks","","1. **Weekly**: Check service status and logs","2. **Monthly**: Optimize database with VACUUM","3. **Quarterly**: Review and clean old data","4. **Annually**: Update Suricata rules","","### Update Suricata Rules","","```bash","sudo suricata-update","sudo systemctl restart suricata","```","","### Backup Database","","```bash","# Backup database","cp /home/jarvis/NetGuard/network.db /home/jarvis/NetGuard/network.db.backup","","# Or with timestamp","cp /home/jarvis/NetGuard/network.db \\","   /home/jarvis/NetGuard/network.db.backup.$(date +%Y%m%d)","```","","---","","## Advanced Configuration","","### Adjust Collection Intervals","","Edit the respective collector scripts in `/home/jarvis/NetGuard/scripts/`:","","- `COLLECT_INTERVAL` variable in each collector","- Default: 30 seconds for most tools","","### Customize Dashboard","","Edit Flask templates in `/home/jarvis/NetGuard/web/templates/`:","","- Modify styling in `base.html`","- Add custom views in `app.py`","- Adjust DataTables settings in each template","","### Add Custom Suricata Rules","","```bash","# Create custom rules file","sudo nano /etc/suricata/rules/local.rules","","# Add rules, then reload","sudo systemctl reload suricata","```","","---","","## Support & Resources","","### Logs Location","- Service logs: `/home/jarvis/NetGuard/logs/system/`","- Systemd logs: `journalctl -u <service-name>`","","### Documentation","- Suricata: https://suricata.io/documentation/","- tcpdump: https://www.tcpdump.org/manpages/tcpdump.1.html","- Flask: https://flask.palletsprojects.com/","","---","","## License","","This project is for personal/educational use. Please review licenses of individual components:","- tcpdump, Suricata, tshark, etc. have their own open-source licenses","","---","","## Changelog","","### Version 1.0 (2025-10-10)","- Initial production release","- 10 capture tools across 3 interfaces","- Complete web dashboard","- 6 systemd services","- Automated data pipeline","- Comprehensive documentation","","---","","**NetGuard Pro** - Professional Network Security Monitoring  ","*Developed for home network administrators and security enthusiasts*","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000001,1000005,1000001,1000006,1000001,1000007,1000001,1000008,1000001,1000009,1000010,1000011,1000012,1000013,1000014,1000001,1000005,1000001,1000015,1000001,1000016,1000001,1000017,1000018,1000019,1000001,1000020,1000001,1000021,1000022,1000023,1000024,1000023,1000025,1000023,1000026,1000023,1000027,1000023,1000028,1000023,1000029,1000021,1000001,1000005,1000001,1000030,1000001,1000021,1000031,1000032,1000033,1000034,1000035,1000036,1000037,1000038,1000039,1000040,1000041,1000042,1000043,1000044,1000045,1000046,1000047,1000048,1000049,1000050,1000051,1000052,1000053,1000054,1000055,1000056,1000057,1000058,1000059,1000060,1000061,1000062,1000063,1000064,1000065,1000066,1000067,1000068,1000069,1000070,1000071,1000072,1000073,1000074,1000075,1000076,1000077,1000078,1000079,1000080,1000081,1000082,1000083,1000084,1000021,1000001,1000005,1000001,1000085,1000001,1000086,1000001,1000087,1000001,1000088,1000089,1000090,1000091,1000092,1000021,1000001,1000093,1000001,1000088,1000094,1000095,1000021,1000001,1000096,1000001,1000097,1000001,1000088,1000094,1000098,1000099,1000021,1000001,1000100,1000001,1000101,1000001,1000088,1000102,1000103,1000001,1000104,1000105,1000001,1000106,1000021,1000001,1000107,1000001,1000088,1000094,1000001,1000108,1000109,1000001,1000110,1000111,1000001,1000112,1000113,1000114,1000115,1000116,1000117,1000118,1000021,1000001,1000119,1000001,1000120,1000001,1000088,1000121,1000021,1000001,1000122,1000001,1000021,1000123,1000124,1000125,1000126,1000127,1000128,1000129,1000130,1000131,1000021,1000001,1000132,1000001,1000088,1000133,1000134,1000135,1000001,1000136,1000137,1000138,1000139,1000140,1000141,1000142,1000021,1000001,1000143,1000001,1000088,1000144,1000145,1000146,1000147,1000148,1000149,1000150,1000021,1000001,1000151,1000001,1000152,1000001,1000021,1000153,1000021,1000001,1000154,1000001,1000021,1000155,1000021,1000001,1000005,1000001,1000156,1000001,1000157,1000001,1000088,1000137,1000138,1000139,1000140,1000141,1000142,1000021,1000001,1000158,1000001,1000088,1000159,1000160,1000161,1000162,1000163,1000164,1000021,1000001,1000165,1000001,1000088,1000166,1000167,1000168,1000169,1000001,1000170,1000171,1000172,1000173,1000021,1000001,1000174,1000001,1000088,1000175,1000176,1000177,1000021,1000001,1000005,1000001,1000178,1000001,1000179,1000180,1000181,1000182,1000001,1000183,1000184,1000185,1000186,1000187,1000001,1000188,1000189,1000190,1000001,1000191,1000192,1000193,1000001,1000194,1000195,1000196,1000001,1000197,1000198,1000199,1000001,1000200,1000201,1000202,1000001,1000203,1000204,1000205,1000001,1000206,1000207,1000208,1000001,1000209,1000210,1000211,1000001,1000005,1000001,1000212,1000001,1000213,1000001,1000088,1000214,1000001,1000215,1000216,1000001,1000217,1000218,1000001,1000219,1000220,1000001,1000221,1000222,1000021,1000001,1000223,1000001,1000088,1000224,1000225,1000021,1000001,1000226,1000001,1000088,1000227,1000021,1000001,1000228,1000001,1000088,1000229,1000230,1000021,1000001,1000005,1000001,1000231,1000001,1000232,1000001,1000088,1000233,1000145,1000001,1000234,1000235,1000001,1000236,1000237,1000001,1000238,1000239,1000240,1000021,1000001,1000241,1000001,1000242,1000243,1000244,1000245,1000246,1000001,1000247,1000243,1000248,1000249,1000246,1000001,1000250,1000243,1000251,1000246,1000001,1000252,1000243,1000253,1000254,1000246,1000001,1000255,1000001,1000088,1000256,1000257,1000001,1000258,1000259,1000260,1000261,1000021,1000001,1000262,1000001,1000088,1000263,1000264,1000001,1000265,1000266,1000021,1000001,1000267,1000001,1000088,1000268,1000269,1000001,1000270,1000271,1000001,1000272,1000273,1000021,1000001,1000005,1000001,1000274,1000001,1000275,1000276,1000277,1000278,1000001,1000279,1000280,1000281,1000282,1000283,1000284,1000001,1000285,1000286,1000287,1000288,1000001,1000005,1000001,1000289,1000001,1000290,1000001,1000291,1000292,1000293,1000294,1000295,1000296,1000001,1000297,1000001,1000298,1000299,1000300,1000301,1000001,1000005,1000001,1000302,1000001,1000303,1000001,1000304,1000305,1000306,1000307,1000001,1000308,1000001,1000088,1000103,1000309,1000021,1000001,1000310,1000001,1000088,1000311,1000312,1000001,1000313,1000314,1000315,1000021,1000001,1000005,1000001,1000316,1000001,1000317,1000001,1000318,1000001,1000319,1000320,1000001,1000321,1000001,1000322,1000001,1000323,1000324,1000325,1000001,1000326,1000001,1000088,1000327,1000328,1000001,1000329,1000330,1000021,1000001,1000005,1000001,1000331,1000001,1000332,1000333,1000334,1000001,1000335,1000336,1000337,1000338,1000001,1000005,1000001,1000339,1000001,1000340,1000341,1000001,1000005,1000001,1000342,1000001,1000343,1000344,1000345,1000346,1000347,1000348,1000349,1000001,1000005,1000001,1000350,1000351,1000001,1000001]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}