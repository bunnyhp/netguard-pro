{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\start_tcpdump.sh","fileUuid":"59c67e4a-a8c3-49ce-9ebc-e14e2d252f82","fileSizeBytes":1220,"numLines":45,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":46,"addedLines":["#!/bin/bash","#","# NetGuard Pro - tcpdump Capture Script","# Continuously captures network traffic on eno1 interface with 10-minute rotation","#","","# Configuration","INTERFACE=\"eno1\"","CAPTURE_DIR=\"/home/jarvis/NetGuard/captures/tcpdump\"","BUFFER_SIZE=8192  # 8MB buffer","SNAPLEN=65535     # Full packet capture","ROTATION_SECONDS=600  # 10 minutes","","# Create capture directory if it doesn't exist","mkdir -p \"$CAPTURE_DIR\"","","# Log file","LOG_FILE=\"/home/jarvis/NetGuard/logs/system/tcpdump.log\"","","# Function to log messages","log_message() {","    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"","}","","log_message \"Starting tcpdump capture on interface $INTERFACE\"","log_message \"Capture directory: $CAPTURE_DIR\"","log_message \"Rotation interval: ${ROTATION_SECONDS}s (10 minutes)\"","log_message \"Buffer size: ${BUFFER_SIZE} KB\"","","# Start tcpdump with rotation","# -i: interface","# -B: buffer size (KB)","# -s: snaplen (bytes to capture per packet)","# -w: output file","# -G: rotate file every N seconds","# -Z: drop privileges (run as specified user)","exec tcpdump -i \"$INTERFACE\" \\","    -B \"$BUFFER_SIZE\" \\","    -s \"$SNAPLEN\" \\","    -w \"$CAPTURE_DIR/capture_%Y%m%d_%H%M%S.pcap\" \\","    -G \"$ROTATION_SECONDS\" \\","    -Z jarvis \\","    2>&1 | tee -a \"$LOG_FILE\"","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000001,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000004,1000011,1000012,1000004,1000013,1000014,1000004,1000015,1000016,1000017,1000018,1000004,1000019,1000020,1000021,1000022,1000004,1000023,1000024,1000025,1000026,1000027,1000028,1000029,1000030,1000031,1000032,1000033,1000034,1000035,1000036,1000004,1000004]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}