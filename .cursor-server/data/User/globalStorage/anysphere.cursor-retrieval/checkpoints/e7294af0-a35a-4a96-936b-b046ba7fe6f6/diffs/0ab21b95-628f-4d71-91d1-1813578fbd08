{"fsPath":"\\home\\jarvis\\NetGuard\\web\\templates\\ai_dashboard.html","fileUuid":"0ab21b95-628f-4d71-91d1-1813578fbd08","fileSizeBytes":21497,"numLines":610,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":611,"addedLines":["<!DOCTYPE html>","<html lang=\"en\">","<head>","    <meta charset=\"UTF-8\">","    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">","    <title>AI Threat Detection - NetGuard Pro</title>","    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">","    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\">","    <style>","        body {","            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);","            min-height: 100vh;","            padding: 20px;","        }","        ","        .dashboard-container {","            max-width: 1400px;","            margin: 0 auto;","        }","        ","        .header-card {","            background: white;","            border-radius: 15px;","            padding: 30px;","            margin-bottom: 30px;","            box-shadow: 0 10px 30px rgba(0,0,0,0.1);","        }","        ","        .threat-level-badge {","            padding: 10px 20px;","            border-radius: 25px;","            font-weight: bold;","            font-size: 1.2rem;","        }","        ","        .threat-CRITICAL {","            background: #dc3545;","            color: white;","            animation: pulse 2s infinite;","        }","        ","        .threat-HIGH {","            background: #fd7e14;","            color: white;","        }","        ","        .threat-MEDIUM {","            background: #ffc107;","            color: #000;","        }","        ","        .threat-LOW {","            background: #28a745;","            color: white;","        }","        ","        @keyframes pulse {","            0%, 100% { opacity: 1; }","            50% { opacity: 0.7; }","        }","        ","        .stat-card {","            background: white;","            border-radius: 15px;","            padding: 25px;","            margin-bottom: 20px;","            box-shadow: 0 5px 15px rgba(0,0,0,0.08);","            transition: transform 0.3s ease;","        }","        ","        .stat-card:hover {","            transform: translateY(-5px);","            box-shadow: 0 10px 25px rgba(0,0,0,0.15);","        }","        ","        .stat-number {","            font-size: 2.5rem;","            font-weight: bold;","            color: #667eea;","        }","        ","        .stat-label {","            color: #6c757d;","            font-size: 0.9rem;","            text-transform: uppercase;","            letter-spacing: 1px;","        }","        ","        .alert-card {","            background: white;","            border-left: 5px solid;","            border-radius: 10px;","            padding: 20px;","            margin-bottom: 15px;","            box-shadow: 0 3px 10px rgba(0,0,0,0.05);","        }","        ","        .alert-CRITICAL {","            border-left-color: #dc3545;","        }","        ","        .alert-HIGH {","            border-left-color: #fd7e14;","        }","        ","        .alert-MEDIUM {","            border-left-color: #ffc107;","        }","        ","        .alert-LOW {","            border-left-color: #17a2b8;","        }","        ","        .threat-card {","            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);","            color: white;","            border-radius: 15px;","            padding: 25px;","            margin-bottom: 20px;","            box-shadow: 0 10px 30px rgba(0,0,0,0.2);","        }","        ","        .pattern-badge {","            background: rgba(255,255,255,0.2);","            padding: 8px 15px;","            border-radius: 20px;","            font-size: 0.85rem;","            margin: 5px;","            display: inline-block;","        }","        ","        .url-risk-high {","            background: #fff5f5;","            border-left: 4px solid #dc3545;","        }","        ","        .url-risk-medium {","            background: #fffbf0;","            border-left: 4px solid #ffc107;","        }","        ","        .url-risk-low {","            background: #f0fff4;","            border-left: 4px solid #28a745;","        }","        ","        .device-card {","            background: white;","            border-radius: 10px;","            padding: 15px;","            margin-bottom: 10px;","            border: 2px solid #e9ecef;","        }","        ","        .confidence-bar {","            height: 8px;","            border-radius: 4px;","            background: #e9ecef;","            overflow: hidden;","        }","        ","        .confidence-fill {","            height: 100%;","            background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #dc3545 100%);","            transition: width 0.3s ease;","        }","        ","        .section-card {","            background: white;","            border-radius: 15px;","            padding: 25px;","            margin-bottom: 20px;","            box-shadow: 0 5px 15px rgba(0,0,0,0.08);","        }","        ","        .section-title {","            font-size: 1.3rem;","            font-weight: bold;","            color: #333;","            margin-bottom: 20px;","            display: flex;","            align-items: center;","        }","        ","        .section-title i {","            margin-right: 10px;","            color: #667eea;","        }","        ","        .empty-state {","            text-align: center;","            padding: 40px;","            color: #6c757d;","        }","        ","        .empty-state i {","            font-size: 3rem;","            margin-bottom: 15px;","            opacity: 0.3;","        }","        ","        .health-score {","            width: 120px;","            height: 120px;","            border-radius: 50%;","            display: flex;","            align-items: center;","            justify-content: center;","            font-size: 2rem;","            font-weight: bold;","            margin: 0 auto;","        }","        ","        .health-good {","            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);","            color: white;","        }","        ","        .health-medium {","            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);","            color: white;","        }","        ","        .health-bad {","            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);","            color: white;","        }","        ","        .btn-resolve {","            background: #28a745;","            color: white;","            border: none;","            padding: 5px 15px;","            border-radius: 20px;","            font-size: 0.85rem;","        }","        ","        .btn-resolve:hover {","            background: #218838;","            color: white;","        }","        ","        .no-data-notice {","            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);","            color: white;","            padding: 30px;","            border-radius: 15px;","            text-align: center;","            margin: 20px 0;","        }","    </style>","</head>","<body>","    <div class=\"dashboard-container\">","        <!-- Header -->","        <div class=\"header-card\">","            <div class=\"row align-items-center\">","                <div class=\"col-md-8\">","                    <h1><i class=\"fas fa-brain\"></i> AI Threat Detection Dashboard</h1>","                    <p class=\"text-muted mb-0\">Real-time intelligent network security monitoring</p>","                </div>","                <div class=\"col-md-4 text-end\">","                    <a href=\"/\" class=\"btn btn-outline-primary me-2\">","                        <i class=\"fas fa-home\"></i> Home","                    </a>","                    <button class=\"btn btn-primary\" onclick=\"refreshDashboard()\">","                        <i class=\"fas fa-sync-alt\"></i> Refresh","                    </button>","                </div>","            </div>","        </div>","","        {% if not prediction %}","        <!-- No Data State -->","        <div class=\"no-data-notice\">","            <i class=\"fas fa-robot fa-3x mb-3\"></i>","            <h3>AI Analysis Service Not Active</h3>","            <p>The AI analysis service needs to be running to see threat predictions.</p>","            <p class=\"mb-0\"><small>Configure AI service at: <code>ai_config</code> table â†’ set <code>ai_enabled=1</code></small></p>","        </div>","        {% endif %}","","        <!-- Main Stats -->","        <div class=\"row\">","            <div class=\"col-md-3\">","                <div class=\"stat-card text-center\">","                    {% if prediction %}","                    <div class=\"stat-number\">{{ prediction.threats_detected }}</div>","                    <div class=\"stat-label\">Threats Detected</div>","                    {% else %}","                    <div class=\"stat-number\">-</div>","                    <div class=\"stat-label\">Threats Detected</div>","                    {% endif %}","                </div>","            </div>","            <div class=\"col-md-3\">","                <div class=\"stat-card text-center\">","                    <div class=\"stat-number\">{{ alerts|length }}</div>","                    <div class=\"stat-label\">Active Alerts</div>","                </div>","            </div>","            <div class=\"col-md-3\">","                <div class=\"stat-card text-center\">","                    <div class=\"stat-number\">{{ threat_patterns|length }}</div>","                    <div class=\"stat-label\">Threat Patterns</div>","                </div>","            </div>","            <div class=\"col-md-3\">","                <div class=\"stat-card text-center\">","                    <div class=\"stat-number\">{{ risky_urls|length }}</div>","                    <div class=\"stat-label\">Risky URLs</div>","                </div>","            </div>","        </div>","","        <!-- Threat Level & Health Score -->","        {% if prediction %}","        <div class=\"row\">","            <div class=\"col-md-6\">","                <div class=\"section-card text-center\">","                    <h4 class=\"mb-3\">Overall Threat Level</h4>","                    <span class=\"threat-level-badge threat-{{ prediction.threat_level }}\">","                        {{ prediction.threat_level or 'UNKNOWN' }}","                    </span>","                    <p class=\"text-muted mt-3 mb-0\">","                        <small>Last Analysis: {{ prediction.timestamp[:19] if prediction.timestamp else 'N/A' }}</small>","                    </p>","                </div>","            </div>","            <div class=\"col-md-6\">","                <div class=\"section-card text-center\">","                    <h4 class=\"mb-3\">Network Health Score</h4>","                    {% set health = prediction.network_health_score or 0 %}","                    <div class=\"health-score {% if health > 70 %}health-good{% elif health > 40 %}health-medium{% else %}health-bad{% endif %}\">","                        {{ health }}","                    </div>","                    <p class=\"text-muted mt-3 mb-0\">","                        <small>Higher is better (0-100)</small>","                    </p>","                </div>","            </div>","        </div>","        {% endif %}","","        <!-- Active Alerts -->","        <div class=\"section-card\">","            <div class=\"section-title\">","                <i class=\"fas fa-exclamation-triangle\"></i>","                Active Alerts ({{ alerts|length }})","            </div>","            ","            {% if alerts %}","            {% for alert in alerts %}","            <div class=\"alert-card alert-{{ alert.priority }}\">","                <div class=\"row align-items-center\">","                    <div class=\"col-md-8\">","                        <h5 class=\"mb-2\">","                            <span class=\"badge bg-{{ 'danger' if alert.priority == 'CRITICAL' else 'warning' if alert.priority == 'HIGH' else 'info' }}\">","                                {{ alert.priority }}","                            </span>","                            {{ alert.title }}","                        </h5>","                        <p class=\"mb-2\">{{ alert.message }}</p>","                        {% if alert.source_ip %}","                        <p class=\"mb-0\"><small><strong>Source:</strong> <code>{{ alert.source_ip }}</code></small></p>","                        {% endif %}","                        {% if alert.confidence %}","                        <div class=\"mt-2\">","                            <small class=\"text-muted\">Confidence: {{ (alert.confidence * 100)|round(1) }}%</small>","                            <div class=\"confidence-bar mt-1\">","                                <div class=\"confidence-fill\" style=\"width: {{ (alert.confidence * 100)|round(0) }}%\"></div>","                            </div>","                        </div>","                        {% endif %}","                    </div>","                    <div class=\"col-md-4 text-end\">","                        {% if alert.recommended_action %}","                        <p class=\"mb-2\"><small><strong>Action:</strong> {{ alert.recommended_action }}</small></p>","                        {% endif %}","                        <button class=\"btn btn-resolve\" onclick=\"resolveAlert('{{ alert.alert_id }}')\">","                            <i class=\"fas fa-check\"></i> Resolve","                        </button>","                    </div>","                </div>","            </div>","            {% endfor %}","            {% else %}","            <div class=\"empty-state\">","                <i class=\"fas fa-shield-alt\"></i>","                <p>No active alerts. Your network is secure!</p>","            </div>","            {% endif %}","        </div>","","        <!-- Threat Patterns -->","        {% if threat_patterns %}","        <div class=\"section-card\">","            <div class=\"section-title\">","                <i class=\"fas fa-chart-line\"></i>","                Detected Threat Patterns","            </div>","            ","            {% for pattern in threat_patterns %}","            <div class=\"threat-card\">","                <div class=\"row\">","                    <div class=\"col-md-8\">","                        <h5><i class=\"fas fa-bug\"></i> {{ pattern.pattern_type }}</h5>","                        <p class=\"mb-2\">{{ pattern.description }}</p>","                        {% if pattern.device_ip %}","                        <p class=\"mb-0\"><small>Device: <code>{{ pattern.device_ip }}</code></small></p>","                        {% endif %}","                    </div>","                    <div class=\"col-md-4 text-end\">","                        <div class=\"mb-2\">","                            <span class=\"pattern-badge\">","                                Confidence: {{ (pattern.confidence * 100)|round(0) }}%","                            </span>","                        </div>","                        <div>","                            <span class=\"pattern-badge\">","                                Severity: {{ pattern.severity or 'MEDIUM' }}","                            </span>","                        </div>","                    </div>","                </div>","            </div>","            {% endfor %}","        </div>","        {% endif %}","","        <div class=\"row\">","            <!-- Risky URLs -->","            <div class=\"col-md-6\">","                <div class=\"section-card\">","                    <div class=\"section-title\">","                        <i class=\"fas fa-globe\"></i>","                        High Risk URLs","                    </div>","                    ","                    {% if risky_urls %}","                    {% for url in risky_urls %}","                    <div class=\"device-card {% if url.risk_score > 0.7 %}url-risk-high{% elif url.risk_score > 0.4 %}url-risk-medium{% else %}url-risk-low{% endif %}\">","                        <div class=\"d-flex justify-content-between align-items-center\">","                            <div>","                                <strong>{{ url.domain }}</strong>","                                <br>","                                <small class=\"text-muted\">{{ url.category or 'Unknown' }}</small>","                            </div>","                            <div class=\"text-end\">","                                <span class=\"badge bg-danger\">{{ (url.risk_score * 100)|round(0) }}%</span>","                                {% if url.action == 'BLOCK' %}","                                <br><small class=\"text-danger\"><strong>BLOCKED</strong></small>","                                {% endif %}","                            </div>","                        </div>","                    </div>","                    {% endfor %}","                    {% else %}","                    <div class=\"empty-state\">","                        <i class=\"fas fa-check-circle\"></i>","                        <p>No high-risk URLs detected</p>","                    </div>","                    {% endif %}","                </div>","            </div>","","            <!-- Monitored Devices -->","            <div class=\"col-md-6\">","                <div class=\"section-card\">","                    <div class=\"section-title\">","                        <i class=\"fas fa-laptop\"></i>","                        Monitored Devices","                    </div>","                    ","                    {% if devices %}","                    {% for device in devices %}","                    <div class=\"device-card\">","                        <div class=\"d-flex justify-content-between align-items-center\">","                            <div>","                                <strong>{{ device.device_ip }}</strong>","                                <br>","                                <small class=\"text-muted\">{{ device.device_type or 'Unknown Type' }}</small>","                            </div>","                            <div class=\"text-end\">","                                {% if device.profile_confidence %}","                                <small class=\"text-success\">","                                    <i class=\"fas fa-check-circle\"></i> Profiled","                                </small>","                                {% else %}","                                <small class=\"text-warning\">","                                    <i class=\"fas fa-clock\"></i> Learning","                                </small>","                                {% endif %}","                            </div>","                        </div>","                    </div>","                    {% endfor %}","                    {% else %}","                    <div class=\"empty-state\">","                        <i class=\"fas fa-network-wired\"></i>","                        <p>No devices profiled yet</p>","                    </div>","                    {% endif %}","                </div>","            </div>","        </div>","","        <!-- Analysis History Chart -->","        {% if analysis_history %}","        <div class=\"section-card\">","            <div class=\"section-title\">","                <i class=\"fas fa-chart-bar\"></i>","                Analysis History (Last 24 Hours)","            </div>","            <canvas id=\"analysisChart\" height=\"100\"></canvas>","        </div>","        {% endif %}","    </div>","","    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>","    <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>","    <script>","        function refreshDashboard() {","            location.reload();","        }","","        function resolveAlert(alertId) {","            if (confirm('Mark this alert as resolved?')) {","                fetch(`/ai-dashboard/alert/${alertId}/resolve`, {","                    method: 'POST',","                    headers: {","                        'Content-Type': 'application/json'","                    }","                })","                .then(response => response.json())","                .then(data => {","                    if (data.success) {","                        location.reload();","                    }","                })","                .catch(error => console.error('Error:', error));","            }","        }","","        // Analysis History Chart","        {% if analysis_history %}","        const ctx = document.getElementById('analysisChart').getContext('2d');","        const chartData = {","            labels: [{% for item in analysis_history|reverse %}'{{ loop.index }}',{% endfor %}],","            datasets: [{","                label: 'Threats Found',","                data: [{% for item in analysis_history|reverse %}{{ item.threats_found or 0 }},{% endfor %}],","                borderColor: 'rgb(220, 53, 69)',","                backgroundColor: 'rgba(220, 53, 69, 0.1)',","                tension: 0.3","            }, {","                label: 'Packets Analyzed',","                data: [{% for item in analysis_history|reverse %}{{ item.packets_analyzed or 0 }},{% endfor %}],","                borderColor: 'rgb(102, 126, 234)',","                backgroundColor: 'rgba(102, 126, 234, 0.1)',","                tension: 0.3,","                yAxisID: 'y1'","            }]","        };","","        new Chart(ctx, {","            type: 'line',","            data: chartData,","            options: {","                responsive: true,","                interaction: {","                    mode: 'index',","                    intersect: false,","                },","                scales: {","                    y: {","                        type: 'linear',","                        display: true,","                        position: 'left',","                        title: {","                            display: true,","                            text: 'Threats'","                        }","                    },","                    y1: {","                        type: 'linear',","                        display: true,","                        position: 'right',","                        title: {","                            display: true,","                            text: 'Packets'","                        },","                        grid: {","                            drawOnChartArea: false,","                        },","                    },","                }","            }","        });","        {% endif %}","","        // Auto-refresh every 30 seconds","        setTimeout(() => {","            location.reload();","        }, 30000);","    </script>","</body>","</html>","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000013,1000014,1000015,1000016,1000017,1000013,1000014,1000018,1000019,1000020,1000021,1000022,1000023,1000013,1000014,1000024,1000025,1000026,1000027,1000028,1000013,1000014,1000029,1000030,1000031,1000032,1000013,1000014,1000033,1000034,1000031,1000013,1000014,1000035,1000036,1000037,1000013,1000014,1000038,1000039,1000031,1000013,1000014,1000040,1000041,1000042,1000013,1000014,1000043,1000019,1000020,1000044,1000045,1000046,1000047,1000013,1000014,1000048,1000049,1000050,1000013,1000014,1000051,1000052,1000027,1000053,1000013,1000014,1000054,1000055,1000056,1000057,1000058,1000013,1000014,1000059,1000019,1000060,1000061,1000012,1000062,1000063,1000013,1000014,1000064,1000065,1000013,1000014,1000066,1000067,1000013,1000014,1000068,1000069,1000013,1000014,1000070,1000071,1000013,1000014,1000072,1000010,1000031,1000020,1000044,1000045,1000073,1000013,1000014,1000074,1000075,1000076,1000077,1000078,1000079,1000080,1000013,1000014,1000081,1000082,1000083,1000013,1000014,1000084,1000085,1000086,1000013,1000014,1000087,1000088,1000089,1000013,1000014,1000090,1000019,1000061,1000091,1000092,1000093,1000013,1000014,1000094,1000095,1000096,1000097,1000098,1000013,1000014,1000099,1000100,1000101,1000102,1000013,1000014,1000103,1000019,1000020,1000044,1000045,1000046,1000013,1000014,1000104,1000105,1000027,1000106,1000045,1000107,1000108,1000013,1000014,1000109,1000110,1000053,1000013,1000014,1000111,1000112,1000113,1000055,1000013,1000014,1000114,1000115,1000062,1000116,1000013,1000014,1000117,1000118,1000119,1000120,1000107,1000108,1000121,1000122,1000027,1000017,1000013,1000014,1000123,1000124,1000031,1000013,1000014,1000125,1000126,1000031,1000013,1000014,1000127,1000128,1000031,1000013,1000014,1000129,1000039,1000031,1000130,1000131,1000077,1000078,1000013,1000014,1000132,1000133,1000031,1000013,1000014,1000134,1000135,1000031,1000021,1000020,1000112,1000136,1000013,1000137,1000138,1000139,1000140,1000141,1000142,1000143,1000144,1000145,1000146,1000147,1000148,1000149,1000150,1000151,1000152,1000153,1000154,1000147,1000155,1000156,1000157,1000158,1000159,1000160,1000161,1000162,1000163,1000164,1000156,1000165,1000157,1000166,1000167,1000168,1000169,1000170,1000171,1000172,1000173,1000174,1000172,1000175,1000147,1000155,1000168,1000169,1000176,1000177,1000147,1000155,1000168,1000169,1000178,1000179,1000147,1000155,1000168,1000169,1000180,1000181,1000147,1000155,1000156,1000157,1000182,1000183,1000167,1000184,1000185,1000186,1000187,1000188,1000189,1000190,1000191,1000192,1000147,1000155,1000184,1000185,1000193,1000194,1000195,1000196,1000197,1000190,1000198,1000192,1000147,1000155,1000156,1000165,1000157,1000199,1000200,1000201,1000202,1000203,1000155,1000204,1000205,1000206,1000207,1000208,1000209,1000210,1000211,1000212,1000213,1000214,1000215,1000216,1000217,1000218,1000219,1000220,1000221,1000222,1000223,1000224,1000225,1000226,1000219,1000197,1000227,1000228,1000229,1000219,1000230,1000231,1000232,1000197,1000147,1000155,1000233,1000234,1000235,1000236,1000237,1000155,1000238,1000156,1000157,1000239,1000240,1000200,1000201,1000241,1000242,1000155,1000204,1000243,1000244,1000245,1000209,1000246,1000247,1000248,1000249,1000219,1000197,1000227,1000250,1000251,1000252,1000213,1000226,1000253,1000251,1000254,1000213,1000226,1000197,1000147,1000155,1000233,1000156,1000165,1000157,1000167,1000255,1000184,1000256,1000257,1000258,1000259,1000197,1000260,1000261,1000262,1000263,1000264,1000265,1000266,1000267,1000268,1000225,1000269,1000270,1000271,1000272,1000273,1000225,1000226,1000197,1000274,1000173,1000275,1000276,1000277,1000197,1000175,1000147,1000155,1000157,1000278,1000184,1000256,1000257,1000279,1000280,1000197,1000260,1000281,1000282,1000283,1000264,1000265,1000284,1000267,1000285,1000225,1000269,1000286,1000287,1000288,1000289,1000290,1000291,1000292,1000289,1000273,1000225,1000226,1000197,1000274,1000173,1000275,1000293,1000294,1000197,1000175,1000147,1000155,1000156,1000157,1000295,1000296,1000200,1000201,1000297,1000298,1000155,1000299,1000156,1000165,1000300,1000157,1000301,1000302,1000303,1000304,1000305,1000013,1000157,1000306,1000307,1000308,1000309,1000310,1000311,1000312,1000313,1000314,1000315,1000316,1000317,1000312,1000313,1000318,1000319,1000013,1000157,1000320,1000296,1000321,1000322,1000323,1000324,1000325,1000326,1000327,1000328,1000329,1000330,1000331,1000332,1000333,1000334,1000335,1000336,1000337,1000338,1000157,1000339,1000340,1000341,1000342,1000343,1000344,1000345,1000346,1000347,1000348,1000349,1000350,1000351,1000352,1000353,1000354,1000355,1000356,1000357,1000358,1000350,1000351,1000359,1000353,1000354,1000360,1000361,1000362,1000363,1000361,1000357,1000364,1000319,1000365,1000165,1000157,1000366,1000367,1000305,1000368,1000369,1000370,1000371,1000157,1000157]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}