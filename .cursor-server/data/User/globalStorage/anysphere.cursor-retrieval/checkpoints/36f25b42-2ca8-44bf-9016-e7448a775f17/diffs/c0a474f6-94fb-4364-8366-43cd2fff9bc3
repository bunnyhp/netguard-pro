{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\ai_5min_aggregator.py","fileUuid":"c0a474f6-94fb-4364-8366-43cd2fff9bc3","fileSizeBytes":30973,"numLines":762,"diffChanges":[{"originalStartLineNumberOneIndexed":227,"originalEndLineNumberExclusiveOneIndexed":227,"modifiedStartLineNumberOneIndexed":227,"modifiedEndLineNumberExclusiveOneIndexed":234,"addedLines":["            try:","                # First check what columns exist in the table","                cursor.execute(f\"PRAGMA table_info({table})\")","                columns = [row[1] for row in cursor.fetchall()]","                ","                # Build query based on available columns","                if 'signature' in columns:"],"tokenizedAddedLines":[1000521,1000522,1000523,1000524,73,1000525,1000526]},{"originalStartLineNumberOneIndexed":236,"originalEndLineNumberExclusiveOneIndexed":236,"modifiedStartLineNumberOneIndexed":243,"modifiedEndLineNumberExclusiveOneIndexed":251,"addedLines":["                else:","                    # If no signature column, just get recent alerts","                    cursor.execute(f\"\"\"","                        SELECT * FROM {table} ","                        ORDER BY timestamp DESC ","                        LIMIT 50","                    \"\"\")","                "],"tokenizedAddedLines":[509,1000527,1000528,1000529,1000530,1000531,1000532,73]},{"originalStartLineNumberOneIndexed":241,"originalEndLineNumberExclusiveOneIndexed":241,"modifiedStartLineNumberOneIndexed":256,"modifiedEndLineNumberExclusiveOneIndexed":259,"addedLines":["            except Exception as e:","                logging.error(f\"Error querying Suricata alerts table {table}: {e}\")","                data['tools']['suricata'] = {'total_alerts': 0, 'alerts': []}"],"tokenizedAddedLines":[1000533,1000534,1000535]},{"originalStartLineNumberOneIndexed":247,"originalEndLineNumberExclusiveOneIndexed":247,"modifiedStartLineNumberOneIndexed":265,"modifiedEndLineNumberExclusiveOneIndexed":266,"addedLines":["            try:"],"tokenizedAddedLines":[1000521]},{"originalStartLineNumberOneIndexed":252,"originalEndLineNumberExclusiveOneIndexed":252,"modifiedStartLineNumberOneIndexed":271,"modifiedEndLineNumberExclusiveOneIndexed":278,"addedLines":["            except Exception as e:","                logging.error(f\"Error querying Suricata flows table {table}: {e}\")","                data['tools']['suricata']['total_flows'] = 0","                data['tools']['suricata']['flows'] = []","        else:","            data['tools']['suricata']['total_flows'] = 0","            data['tools']['suricata']['flows'] = []"],"tokenizedAddedLines":[1000533,1000536,1000537,1000538,160,1000539,1000540]},{"originalStartLineNumberOneIndexed":256,"originalEndLineNumberExclusiveOneIndexed":256,"modifiedStartLineNumberOneIndexed":282,"modifiedEndLineNumberExclusiveOneIndexed":283,"addedLines":["            try:"],"tokenizedAddedLines":[1000521]},{"originalStartLineNumberOneIndexed":260,"originalEndLineNumberExclusiveOneIndexed":260,"modifiedStartLineNumberOneIndexed":287,"modifiedEndLineNumberExclusiveOneIndexed":290,"addedLines":["            except Exception as e:","                logging.error(f\"Error querying Suricata HTTP table {table}: {e}\")","                data['tools']['suricata']['http_events'] = []"],"tokenizedAddedLines":[1000533,1000541,1000542]},{"originalStartLineNumberOneIndexed":266,"originalEndLineNumberExclusiveOneIndexed":266,"modifiedStartLineNumberOneIndexed":296,"modifiedEndLineNumberExclusiveOneIndexed":297,"addedLines":["            try:"],"tokenizedAddedLines":[1000521]},{"originalStartLineNumberOneIndexed":270,"originalEndLineNumberExclusiveOneIndexed":270,"modifiedStartLineNumberOneIndexed":301,"modifiedEndLineNumberExclusiveOneIndexed":304,"addedLines":["            except Exception as e:","                logging.error(f\"Error querying Suricata DNS table {table}: {e}\")","                data['tools']['suricata']['dns_events'] = []"],"tokenizedAddedLines":[1000533,1000543,1000544]},{"originalStartLineNumberOneIndexed":276,"originalEndLineNumberExclusiveOneIndexed":276,"modifiedStartLineNumberOneIndexed":310,"modifiedEndLineNumberExclusiveOneIndexed":311,"addedLines":["            try:"],"tokenizedAddedLines":[1000521]},{"originalStartLineNumberOneIndexed":280,"originalEndLineNumberExclusiveOneIndexed":280,"modifiedStartLineNumberOneIndexed":315,"modifiedEndLineNumberExclusiveOneIndexed":318,"addedLines":["            except Exception as e:","                logging.error(f\"Error querying Suricata TLS table {table}: {e}\")","                data['tools']['suricata']['tls_events'] = []"],"tokenizedAddedLines":[1000533,1000545,1000546]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}