{"fsPath":"\\home\\jarvis\\NetGuard\\fix_p0f.sh","fileUuid":"d04c8aea-c61a-4c95-97d2-806a81155708","fileSizeBytes":2149,"numLines":84,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":85,"addedLines":["#!/bin/bash","","echo \"==========================================\"","echo \"P0F TOOL DIAGNOSTIC & FIX\"","echo \"==========================================\"","echo \"\"","","# 1. Check if p0f is installed","echo \"[1/6] Checking if p0f is installed...\"","if ! command -v p0f &> /dev/null; then","    echo \"✗ p0f is NOT installed\"","    echo \"Installing p0f...\"","    sudo apt-get update","    sudo apt-get install -y p0f","else","    echo \"✓ p0f is installed at: $(which p0f)\"","fi","","echo \"\"","","# 2. Check capture directory","echo \"[2/6] Checking capture directory...\"","if [ ! -d \"/home/jarvis/NetGuard/captures/p0f\" ]; then","    echo \"Creating capture directory...\"","    mkdir -p /home/jarvis/NetGuard/captures/p0f","fi","chmod 755 /home/jarvis/NetGuard/captures/p0f","echo \"✓ Capture directory ready\"","","echo \"\"","","# 3. Kill any existing p0f processes","echo \"[3/6] Stopping any existing p0f processes...\"","sudo pkill -9 p0f 2>/dev/null","sleep 1","echo \"✓ Cleaned up old processes\"","","echo \"\"","","# 4. Check network interface","echo \"[4/6] Checking network interface wlo1...\"","if ip link show wlo1 &> /dev/null; then","    echo \"✓ wlo1 interface exists\"","    ip addr show wlo1 | grep \"inet \"","else","    echo \"✗ wlo1 interface not found\"","    echo \"Available interfaces:\"","    ip link show | grep \"^[0-9]\" | awk '{print $2}' | sed 's/://'","    exit 1","fi","","echo \"\"","","# 5. Start p0f tool","echo \"[5/6] Starting p0f tool on wlo1...\"","sudo p0f -i wlo1 -o /home/jarvis/NetGuard/captures/p0f/p0f.log -d &","sleep 3","","# 6. Verify p0f is running","echo \"[6/6] Verifying p0f is running...\"","if pgrep -x p0f > /dev/null; then","    echo \"✓ p0f tool is RUNNING\"","    ps aux | grep p0f | grep -v grep","    echo \"\"","    echo \"✓ Log file: /home/jarvis/NetGuard/captures/p0f/p0f.log\"","    echo \"\"","    echo \"Waiting 5 seconds for data capture...\"","    sleep 5","    if [ -f \"/home/jarvis/NetGuard/captures/p0f/p0f.log\" ]; then","        echo \"Recent p0f captures:\"","        tail -10 /home/jarvis/NetGuard/captures/p0f/p0f.log","    fi","else","    echo \"✗ p0f failed to start\"","    echo \"Checking error logs...\"","    dmesg | tail -20 | grep -i p0f","fi","","echo \"\"","echo \"==========================================\"","echo \"DONE\"","echo \"==========================================\"","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000002,1000004,1000001,1000005,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000013,1000014,1000001,1000004,1000001,1000015,1000016,1000017,1000018,1000019,1000014,1000020,1000021,1000001,1000004,1000001,1000022,1000023,1000024,1000025,1000026,1000001,1000004,1000001,1000027,1000028,1000029,1000030,1000031,1000012,1000032,1000033,1000034,1000035,1000014,1000001,1000004,1000001,1000036,1000037,1000038,1000039,1000001,1000040,1000041,1000042,1000043,1000044,1000045,1000046,1000045,1000047,1000048,1000049,1000050,1000051,1000052,1000012,1000053,1000054,1000055,1000014,1000001,1000004,1000002,1000056,1000002,1000001,1000001]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}