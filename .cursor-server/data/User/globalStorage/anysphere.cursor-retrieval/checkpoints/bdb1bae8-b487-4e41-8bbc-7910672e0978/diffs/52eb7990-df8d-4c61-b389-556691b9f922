{"fsPath":"\\home\\jarvis\\NetGuard\\web\\templates\\alerts.html","fileUuid":"52eb7990-df8d-4c61-b389-556691b9f922","fileSizeBytes":14698,"numLines":399,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":400,"addedLines":["{% extends \"base.html\" %}","","{% block title %}Security Alerts - NetGuard Pro{% endblock %}","","{% block content %}","<style>","    .alert-card {","        border-left: 4px solid;","        margin-bottom: 20px;","        transition: all 0.3s ease;","    }","    ","    .alert-card:hover {","        transform: translateY(-2px);","        box-shadow: 0 4px 12px rgba(0,0,0,0.3);","    }","    ","    .alert-card.critical {","        border-left-color: #f44336;","        background: linear-gradient(135deg, rgba(244, 67, 54, 0.1) 0%, rgba(0, 0, 0, 0) 100%);","    }","    ","    .alert-card.high {","        border-left-color: #ff9800;","        background: linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(0, 0, 0, 0) 100%);","    }","    ","    .alert-card.medium {","        border-left-color: #ffeb3b;","        background: linear-gradient(135deg, rgba(255, 235, 59, 0.1) 0%, rgba(0, 0, 0, 0) 100%);","    }","    ","    .alert-card.low {","        border-left-color: #4caf50;","        background: linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(0, 0, 0, 0) 100%);","    }","    ","    .severity-badge {","        padding: 4px 12px;","        border-radius: 4px;","        font-weight: 600;","        font-size: 0.8rem;","        text-transform: uppercase;","    }","    ","    .severity-badge.critical {","        background: #f44336;","        color: #fff;","    }","    ","    .severity-badge.high {","        background: #ff9800;","        color: #000;","    }","    ","    .severity-badge.medium {","        background: #ffeb3b;","        color: #000;","    }","    ","    .severity-badge.low {","        background: #4caf50;","        color: #fff;","    }","    ","    .alert-actions {","        display: flex;","        gap: 10px;","        margin-top: 15px;","    }","    ","    .btn-remediate {","        background: var(--primary-color);","        color: #000;","        border: none;","        padding: 8px 16px;","        border-radius: 6px;","        cursor: pointer;","        font-weight: 600;","        transition: all 0.3s ease;","    }","    ","    .btn-remediate:hover {","        background: #45b7d1;","        transform: scale(1.05);","    }","    ","    .btn-resolve {","        background: #4caf50;","        color: #fff;","    }","    ","    .btn-false-positive {","        background: #666;","        color: #fff;","    }","    ","    .remediation-steps {","        background: #0a0a0a;","        border-radius: 8px;","        padding: 15px;","        margin-top: 10px;","    }","    ","    .remediation-steps ol {","        margin: 10px 0 0 0;","        padding-left: 20px;","    }","    ","    .remediation-steps li {","        margin: 8px 0;","        color: #ddd;","    }","    ","    .threat-indicators {","        display: flex;","        flex-wrap: wrap;","        gap: 8px;","        margin-top: 10px;","    }","    ","    .threat-indicator {","        background: rgba(244, 67, 54, 0.2);","        border: 1px solid #f44336;","        padding: 4px 10px;","        border-radius: 4px;","        font-size: 0.85rem;","        color: #ff6b6b;","    }","</style>","","<div class=\"row mb-4\">","    <div class=\"col-12\">","        <div class=\"card\" style=\"border: 2px solid var(--primary-color);\">","            <div class=\"card-header\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff;\">","                <h4 class=\"mb-0\">","                    <i class=\"fas fa-exclamation-triangle\"></i> Security Alerts Dashboard","                </h4>","            </div>","            <div class=\"card-body\">","                <p class=\"mb-0\" style=\"color: var(--text-secondary);\">","                    Real-time security alerts with automated remediation actions. Monitor, investigate, and resolve threats quickly.","                </p>","            </div>","        </div>","    </div>","</div>","","<!-- Statistics -->","<div class=\"row mb-4\">","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-exclamation-circle\"></i> Active Alerts</div>","            <div class=\"stat-number\" style=\"color: #ff6b6b;\">{{ statistics.total_active }}</div>","        </div>","    </div>","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-fire\"></i> Critical</div>","            <div class=\"stat-number\" style=\"color: #f44336;\">{{ statistics.severity_counts.get('CRITICAL', 0) }}</div>","        </div>","    </div>","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-clock\"></i> Last 24 Hours</div>","            <div class=\"stat-number\" style=\"color: #00d4ff;\">{{ statistics.recent_24h }}</div>","        </div>","    </div>","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-check-circle\"></i> Resolved</div>","            <div class=\"stat-number\" style=\"color: #4caf50;\">{{ statistics.total_resolved }}</div>","        </div>","    </div>","</div>","","<!-- Severity Breakdown -->","<div class=\"row mb-4\">","    <div class=\"col-12\">","        <div class=\"card\">","            <div class=\"card-body\">","                <h5 class=\"mb-3\"><i class=\"fas fa-chart-bar\"></i> Alerts by Severity</h5>","                <div class=\"row text-center\">","                    <div class=\"col\">","                        <div style=\"font-size: 2rem; color: #f44336;\">{{ statistics.severity_counts.get('CRITICAL', 0) }}</div>","                        <div style=\"color: #888; font-size: 0.9rem;\">CRITICAL</div>","                    </div>","                    <div class=\"col\">","                        <div style=\"font-size: 2rem; color: #ff9800;\">{{ statistics.severity_counts.get('HIGH', 0) }}</div>","                        <div style=\"color: #888; font-size: 0.9rem;\">HIGH</div>","                    </div>","                    <div class=\"col\">","                        <div style=\"font-size: 2rem; color: #ffeb3b;\">{{ statistics.severity_counts.get('MEDIUM', 0) }}</div>","                        <div style=\"color: #888; font-size: 0.9rem;\">MEDIUM</div>","                    </div>","                    <div class=\"col\">","                        <div style=\"font-size: 2rem; color: #4caf50;\">{{ statistics.severity_counts.get('LOW', 0) }}</div>","                        <div style=\"color: #888; font-size: 0.9rem;\">LOW</div>","                    </div>","                </div>","            </div>","        </div>","    </div>","</div>","","<!-- Alerts List -->","<div class=\"row\">","    <div class=\"col-12\">","        {% if alerts %}","            {% for alert in alerts %}","            <div class=\"card alert-card {{ alert.severity|lower }}\" id=\"alert-{{ alert.alert_id }}\">","                <div class=\"card-body\">","                    <!-- Alert Header -->","                    <div class=\"d-flex justify-content-between align-items-start mb-3\">","                        <div>","                            <h5 class=\"mb-2\" style=\"color: #fff;\">","                                <i class=\"fas fa-shield-alt\"></i> {{ alert.title }}","                            </h5>","                            <div class=\"d-flex align-items-center gap-3\">","                                <span class=\"severity-badge {{ alert.severity|lower }}\">{{ alert.severity }}</span>","                                <span style=\"color: #888; font-size: 0.9rem;\">","                                    <i class=\"fas fa-clock\"></i> {{ alert.created_at }}","                                </span>","                                {% if alert.recurrence_count > 1 %}","                                <span style=\"color: #ff6b6b; font-size: 0.9rem;\">","                                    <i class=\"fas fa-sync-alt\"></i> Recurring ({{ alert.recurrence_count }}x)","                                </span>","                                {% endif %}","                            </div>","                        </div>","                        <div style=\"font-size: 2rem;\">","                            {% if alert.alert_type == 'port_scan' %}","                                üîç","                            {% elif alert.alert_type == 'iot_compromise' %}","                                üí°","                            {% elif alert.alert_type == 'malware' %}","                                ü¶†","                            {% elif alert.alert_type == 'unusual_traffic' %}","                                üìä","                            {% else %}","                                ‚ö†Ô∏è","                            {% endif %}","                        </div>","                    </div>","                    ","                    <!-- Alert Description -->","                    <p style=\"color: #ddd; margin-bottom: 15px;\">{{ alert.description }}</p>","                    ","                    <!-- Alert Details -->","                    <div class=\"row mb-3\">","                        {% if alert.source_ip %}","                        <div class=\"col-md-4\">","                            <div style=\"color: #888; font-size: 0.85rem;\">Source IP</div>","                            <div style=\"color: #fff; font-weight: 600; font-family: monospace;\">{{ alert.source_ip }}</div>","                        </div>","                        {% endif %}","                        {% if alert.dest_ip %}","                        <div class=\"col-md-4\">","                            <div style=\"color: #888; font-size: 0.85rem;\">Destination IP</div>","                            <div style=\"color: #fff; font-weight: 600; font-family: monospace;\">{{ alert.dest_ip }}</div>","                        </div>","                        {% endif %}","                        <div class=\"col-md-4\">","                            <div style=\"color: #888; font-size: 0.85rem;\">Alert Type</div>","                            <div style=\"color: #fff; font-weight: 600;\">{{ alert.alert_type.replace('_', ' ').title() }}</div>","                        </div>","                    </div>","                    ","                    <!-- Threat Indicators -->","                    {% if alert.threat_indicators %}","                    <div class=\"mb-3\">","                        <div style=\"color: #888; font-size: 0.85rem; margin-bottom: 8px;\">","                            <i class=\"fas fa-flag\"></i> Threat Indicators","                        </div>","                        <div class=\"threat-indicators\">","                            {% for indicator in alert.threat_indicators %}","                            <span class=\"threat-indicator\">{{ indicator }}</span>","                            {% endfor %}","                        </div>","                    </div>","                    {% endif %}","                    ","                    <!-- Remediation Steps -->","                    {% if alert.remediation_steps %}","                    <div class=\"remediation-steps\">","                        <div style=\"color: #00d4ff; font-weight: 600; margin-bottom: 10px;\">","                            <i class=\"fas fa-tools\"></i> Recommended Actions","                        </div>","                        <ol>","                            {% for step in alert.remediation_steps %}","                            <li>{{ step }}</li>","                            {% endfor %}","                        </ol>","                    </div>","                    {% endif %}","                    ","                    <!-- Actions -->","                    <div class=\"alert-actions\">","                        {% if alert.auto_remediation_available %}","                        <button class=\"btn btn-remediate btn-resolve\" onclick=\"autoRemediate('{{ alert.alert_id }}')\">","                            <i class=\"fas fa-magic\"></i> Auto-Remediate","                        </button>","                        {% endif %}","                        <button class=\"btn btn-remediate btn-resolve\" onclick=\"resolveAlert('{{ alert.alert_id }}')\">","                            <i class=\"fas fa-check\"></i> Mark Resolved","                        </button>","                        <button class=\"btn btn-remediate btn-false-positive\" onclick=\"markFalsePositive('{{ alert.alert_id }}')\">","                            <i class=\"fas fa-times\"></i> False Positive","                        </button>","                    </div>","                </div>","            </div>","            {% endfor %}","        {% else %}","            <div class=\"card\">","                <div class=\"card-body text-center\" style=\"padding: 60px 20px;\">","                    <i class=\"fas fa-shield-alt\" style=\"font-size: 4rem; color: #4caf50; margin-bottom: 20px;\"></i>","                    <h4 style=\"color: #4caf50; margin-bottom: 10px;\">All Clear!</h4>","                    <p style=\"color: #888;\">No active security alerts at this time.</p>","                    <p style=\"color: #666; font-size: 0.9rem;\">Your network is secure and all threats are resolved.</p>","                </div>","            </div>","        {% endif %}","    </div>","</div>","","<script>","function autoRemediate(alertId) {","    if (!confirm('Execute automatic remediation for this alert? This will run system commands to mitigate the threat.')) {","        return;","    }","    ","    fetch(`/alerts/${alertId}/auto-remediate`, {","        method: 'POST',","        headers: {'Content-Type': 'application/json'}","    })","    .then(response => response.json())","    .then(data => {","        if (data.success) {","            alert('‚úì Remediation executed successfully!\\n\\n' + data.output);","            document.getElementById('alert-' + alertId).style.opacity = '0.5';","            setTimeout(() => location.reload(), 1000);","        } else {","            alert('‚úó Remediation failed: ' + data.message);","        }","    })","    .catch(error => {","        alert('Error: ' + error);","    });","}","","function resolveAlert(alertId) {","    if (!confirm('Mark this alert as resolved?')) {","        return;","    }","    ","    fetch(`/alerts/${alertId}/resolve`, {","        method: 'POST',","        headers: {'Content-Type': 'application/json'},","        body: JSON.stringify({notes: 'Resolved via dashboard'})","    })","    .then(response => response.json())","    .then(data => {","        if (data.success) {","            document.getElementById('alert-' + alertId).style.opacity = '0.5';","            setTimeout(() => location.reload(), 500);","        } else {","            alert('Error: ' + data.message);","        }","    });","}","","function markFalsePositive(alertId) {","    if (!confirm('Mark this alert as a false positive? This will help improve detection accuracy.')) {","        return;","    }","    ","    fetch(`/alerts/${alertId}/false-positive`, {","        method: 'POST',","        headers: {'Content-Type': 'application/json'}","    })","    .then(response => response.json())","    .then(data => {","        if (data.success) {","            document.getElementById('alert-' + alertId).style.opacity = '0.3';","            setTimeout(() => location.reload(), 500);","        } else {","            alert('Error: ' + data.message);","        }","    });","}","","// Auto-refresh every 2 minutes","setTimeout(() => location.reload(), 120000);","</script>","","{% endblock %}","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000001,1000003,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000013,1000009,1000010,1000014,1000015,1000016,1000009,1000010,1000017,1000018,1000019,1000009,1000010,1000020,1000021,1000022,1000009,1000010,1000023,1000024,1000025,1000009,1000010,1000026,1000027,1000028,1000029,1000030,1000031,1000009,1000010,1000032,1000033,1000034,1000009,1000010,1000035,1000036,1000037,1000009,1000010,1000038,1000039,1000037,1000009,1000010,1000040,1000041,1000034,1000009,1000010,1000042,1000043,1000044,1000045,1000009,1000010,1000046,1000047,1000037,1000048,1000049,1000050,1000051,1000029,1000008,1000009,1000010,1000052,1000053,1000054,1000009,1000010,1000055,1000041,1000034,1000009,1000010,1000056,1000057,1000034,1000009,1000010,1000058,1000059,1000060,1000061,1000062,1000009,1000010,1000063,1000064,1000065,1000009,1000010,1000066,1000067,1000068,1000009,1000010,1000069,1000043,1000070,1000071,1000062,1000009,1000010,1000072,1000073,1000074,1000075,1000028,1000076,1000077,1000009,1000078,1000001,1000079,1000080,1000081,1000082,1000083,1000084,1000085,1000086,1000087,1000088,1000089,1000090,1000086,1000091,1000092,1000093,1000001,1000094,1000079,1000095,1000096,1000097,1000098,1000091,1000092,1000095,1000096,1000099,1000100,1000091,1000092,1000095,1000096,1000101,1000102,1000091,1000092,1000095,1000096,1000103,1000104,1000091,1000092,1000093,1000001,1000105,1000079,1000080,1000106,1000087,1000107,1000108,1000109,1000110,1000111,1000112,1000109,1000113,1000114,1000112,1000109,1000115,1000116,1000112,1000109,1000117,1000118,1000112,1000119,1000086,1000091,1000092,1000093,1000001,1000120,1000121,1000080,1000122,1000123,1000124,1000125,1000126,1000127,1000128,1000129,1000130,1000131,1000132,1000133,1000134,1000135,1000136,1000137,1000138,1000139,1000136,1000140,1000141,1000142,1000143,1000144,1000145,1000146,1000147,1000148,1000149,1000150,1000151,1000152,1000153,1000154,1000142,1000112,1000155,1000156,1000157,1000155,1000158,1000159,1000160,1000161,1000162,1000163,1000142,1000164,1000165,1000161,1000166,1000167,1000142,1000164,1000161,1000168,1000169,1000142,1000112,1000155,1000170,1000171,1000172,1000173,1000174,1000142,1000175,1000176,1000177,1000178,1000142,1000112,1000179,1000155,1000180,1000181,1000182,1000183,1000184,1000142,1000185,1000186,1000187,1000178,1000188,1000112,1000179,1000155,1000189,1000190,1000191,1000192,1000193,1000194,1000164,1000195,1000196,1000194,1000197,1000198,1000194,1000112,1000119,1000086,1000199,1000200,1000201,1000202,1000203,1000204,1000205,1000206,1000119,1000086,1000207,1000092,1000093,1000001,1000208,1000209,1000210,1000211,1000009,1000010,1000212,1000213,1000214,1000215,1000216,1000217,1000218,1000219,1000220,1000221,1000222,1000223,1000224,1000215,1000225,1000226,1000227,1000228,1000001,1000229,1000230,1000211,1000009,1000010,1000231,1000213,1000232,1000233,1000215,1000216,1000217,1000218,1000220,1000234,1000222,1000235,1000224,1000227,1000228,1000001,1000236,1000237,1000211,1000009,1000010,1000238,1000213,1000214,1000215,1000216,1000217,1000218,1000239,1000234,1000222,1000235,1000224,1000227,1000228,1000001,1000240,1000241,1000242,1000001,1000243,1000001,1000001]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}