{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\tcpdump_collector.py","fileUuid":"655a9d28-a432-4749-9200-1abd965809d3","fileSizeBytes":21211,"numLines":597,"diffChanges":[{"originalStartLineNumberOneIndexed":28,"originalEndLineNumberExclusiveOneIndexed":30,"modifiedStartLineNumberOneIndexed":28,"modifiedEndLineNumberExclusiveOneIndexed":30,"addedLines":["RING_BUFFER_SIZE = 10  # Number of files in rotation","FILE_SIZE_MB = 5  # Size of each capture file (5MB for faster rotation)"],"tokenizedAddedLines":[1000449,1000450]},{"originalStartLineNumberOneIndexed":49,"originalEndLineNumberExclusiveOneIndexed":51,"modifiedStartLineNumberOneIndexed":49,"modifiedEndLineNumberExclusiveOneIndexed":51,"addedLines":["def save_position(pcap_file, processed=True, file_size=0):","    \"\"\"Track processed PCAP files with size\"\"\""],"tokenizedAddedLines":[1000451,1000452]},{"originalStartLineNumberOneIndexed":55,"originalEndLineNumberExclusiveOneIndexed":56,"modifiedStartLineNumberOneIndexed":55,"modifiedEndLineNumberExclusiveOneIndexed":57,"addedLines":["            'timestamp': datetime.now().isoformat(),","            'size': file_size"],"tokenizedAddedLines":[262,1000453]},{"originalStartLineNumberOneIndexed":451,"originalEndLineNumberExclusiveOneIndexed":451,"modifiedStartLineNumberOneIndexed":452,"modifiedEndLineNumberExclusiveOneIndexed":453,"addedLines":["            current_size = os.path.getsize(pcap_path)"],"tokenizedAddedLines":[1000454]},{"originalStartLineNumberOneIndexed":452,"originalEndLineNumberExclusiveOneIndexed":453,"modifiedStartLineNumberOneIndexed":454,"modifiedEndLineNumberExclusiveOneIndexed":455,"addedLines":["            # Skip if already processed and size hasn't changed (not growing)"],"tokenizedAddedLines":[1000455]},{"originalStartLineNumberOneIndexed":454,"originalEndLineNumberExclusiveOneIndexed":454,"modifiedStartLineNumberOneIndexed":456,"modifiedEndLineNumberExclusiveOneIndexed":459,"addedLines":["                last_size = positions[pcap_path].get('size', 0)","                # If file has grown by more than 10KB, reprocess it","                if current_size - last_size < 10240:"],"tokenizedAddedLines":[1000456,1000457,1000458]},{"originalStartLineNumberOneIndexed":456,"originalEndLineNumberExclusiveOneIndexed":457,"modifiedStartLineNumberOneIndexed":461,"modifiedEndLineNumberExclusiveOneIndexed":463,"addedLines":["            # Check if file is still being actively written","            # Allow processing if file size is stable or file is old enough"],"tokenizedAddedLines":[1000459,1000460]},{"originalStartLineNumberOneIndexed":458,"originalEndLineNumberExclusiveOneIndexed":458,"modifiedStartLineNumberOneIndexed":464,"modifiedEndLineNumberExclusiveOneIndexed":468,"addedLines":["                file_age = time.time() - os.path.getmtime(pcap_path)","                ","                # If file is older than 10 seconds, process it even if growing","                if file_age < 10:"],"tokenizedAddedLines":[1000461,371,1000462,1000463]},{"originalStartLineNumberOneIndexed":459,"originalEndLineNumberExclusiveOneIndexed":460,"modifiedStartLineNumberOneIndexed":469,"modifiedEndLineNumberExclusiveOneIndexed":470,"addedLines":["                    time.sleep(1)"],"tokenizedAddedLines":[1000464]},{"originalStartLineNumberOneIndexed":463,"originalEndLineNumberExclusiveOneIndexed":464,"modifiedStartLineNumberOneIndexed":473,"modifiedEndLineNumberExclusiveOneIndexed":474,"addedLines":["                        logging.debug(f\"Skipping {pcap_path} - actively being written\")"],"tokenizedAddedLines":[1000465]},{"originalStartLineNumberOneIndexed":491,"originalEndLineNumberExclusiveOneIndexed":493,"modifiedStartLineNumberOneIndexed":501,"modifiedEndLineNumberExclusiveOneIndexed":503,"addedLines":["            # Mark as processed with current file size","            save_position(pcap_path, processed=True, file_size=current_size)"],"tokenizedAddedLines":[1000466,1000467]},{"originalStartLineNumberOneIndexed":562,"originalEndLineNumberExclusiveOneIndexed":563,"modifiedStartLineNumberOneIndexed":572,"modifiedEndLineNumberExclusiveOneIndexed":573,"addedLines":["            time.sleep(30)  # Analyze every 30 seconds"],"tokenizedAddedLines":[1000468]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}