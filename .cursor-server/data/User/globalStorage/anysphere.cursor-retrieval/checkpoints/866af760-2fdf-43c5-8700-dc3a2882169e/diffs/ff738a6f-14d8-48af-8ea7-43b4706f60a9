{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\ai_5min_aggregator.py","fileUuid":"ff738a6f-14d8-48af-8ea7-43b4706f60a9","fileSizeBytes":28637,"numLines":716,"diffChanges":[{"originalStartLineNumberOneIndexed":275,"originalEndLineNumberExclusiveOneIndexed":276,"modifiedStartLineNumberOneIndexed":275,"modifiedEndLineNumberExclusiveOneIndexed":295,"addedLines":["        # Get REAL device data from device tracker","        cursor.execute(\"\"\"","            SELECT COUNT(*) as total,","                   COUNT(CASE WHEN device_type='IoT' THEN 1 END) as iot,","                   COUNT(CASE WHEN device_type='Mobile' THEN 1 END) as mobile,","                   COUNT(CASE WHEN device_type='Computer' THEN 1 END) as computer,","                   COUNT(CASE WHEN device_type='Network' THEN 1 END) as network","            FROM devices","        \"\"\")","        device_stats = cursor.fetchone()","        ","        cursor.execute(\"\"\"","            SELECT ip_address, hostname, device_type, device_category, vendor","            FROM devices","            ORDER BY last_seen DESC","            LIMIT 20","        \"\"\")","        tracked_devices = [dict(row) for row in cursor.fetchall()]","        ","        # Add network summary with ACTUAL tracked device count"],"tokenizedAddedLines":[1000489,391,1000490,1000491,1000492,1000493,1000494,1000495,406,1000496,53,391,1000497,1000495,1000498,1000499,406,1000500,53,1000501]},{"originalStartLineNumberOneIndexed":277,"originalEndLineNumberExclusiveOneIndexed":279,"modifiedStartLineNumberOneIndexed":296,"modifiedEndLineNumberExclusiveOneIndexed":302,"addedLines":["            'total_tracked_devices': device_stats['total'] if device_stats else 0,","            'iot_devices': device_stats['iot'] if device_stats else 0,","            'mobile_devices': device_stats['mobile'] if device_stats else 0,","            'computers': device_stats['computer'] if device_stats else 0,","            'network_devices': device_stats['network'] if device_stats else 0,","            'tracked_devices': tracked_devices,"],"tokenizedAddedLines":[1000502,1000503,1000504,1000505,1000506,1000507]},{"originalStartLineNumberOneIndexed":390,"originalEndLineNumberExclusiveOneIndexed":391,"modifiedStartLineNumberOneIndexed":413,"modifiedEndLineNumberExclusiveOneIndexed":419,"addedLines":["- Total Tracked Devices: {data['network_summary']['total_tracked_devices']} devices","  - IoT Devices: {data['network_summary']['iot_devices']}","  - Mobile Devices: {data['network_summary']['mobile_devices']}","  - Computers: {data['network_summary']['computers']}","  - Network Equipment: {data['network_summary']['network_devices']}","- Device Details: {json.dumps(data['network_summary']['tracked_devices'], indent=2, default=str)}"],"tokenizedAddedLines":[1000508,1000509,1000510,1000511,1000512,1000513]},{"originalStartLineNumberOneIndexed":392,"originalEndLineNumberExclusiveOneIndexed":393,"modifiedStartLineNumberOneIndexed":420,"modifiedEndLineNumberExclusiveOneIndexed":420},{"originalStartLineNumberOneIndexed":478,"originalEndLineNumberExclusiveOneIndexed":479,"modifiedStartLineNumberOneIndexed":505,"modifiedEndLineNumberExclusiveOneIndexed":509,"addedLines":["    \"total_devices\": {data['network_summary']['total_tracked_devices']},","    \"iot_devices\": {data['network_summary']['iot_devices']},","    \"mobile_devices\": {data['network_summary']['mobile_devices']},","    \"computers\": {data['network_summary']['computers']},"],"tokenizedAddedLines":[1000514,1000515,1000516,1000517]},{"originalStartLineNumberOneIndexed":480,"originalEndLineNumberExclusiveOneIndexed":481,"modifiedStartLineNumberOneIndexed":510,"modifiedEndLineNumberExclusiveOneIndexed":512,"addedLines":["    \"suspicious_devices\": [\"ip: reason for suspicion\"],","    \"device_breakdown\": [\"brief summary of each device type\"]"],"tokenizedAddedLines":[1000518,1000519]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}