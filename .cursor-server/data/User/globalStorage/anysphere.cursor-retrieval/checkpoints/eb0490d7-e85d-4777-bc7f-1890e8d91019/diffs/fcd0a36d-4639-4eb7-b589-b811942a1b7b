{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\p0f_collector.py","fileUuid":"fcd0a36d-4639-4eb7-b589-b811942a1b7b","fileSizeBytes":11829,"numLines":351,"diffChanges":[{"originalStartLineNumberOneIndexed":181,"originalEndLineNumberExclusiveOneIndexed":183,"modifiedStartLineNumberOneIndexed":181,"modifiedEndLineNumberExclusiveOneIndexed":184,"addedLines":["        # Parse entries: Group by connection (cli+srv+timestamp)","        # p0f creates multiple entries per connection with different mod types","        connection_data = {}"],"tokenizedAddedLines":[1000250,1000251,1000252]},{"originalStartLineNumberOneIndexed":189,"originalEndLineNumberExclusiveOneIndexed":192,"modifiedStartLineNumberOneIndexed":190,"modifiedEndLineNumberExclusiveOneIndexed":190},{"originalStartLineNumberOneIndexed":194,"originalEndLineNumberExclusiveOneIndexed":196,"modifiedStartLineNumberOneIndexed":192,"modifiedEndLineNumberExclusiveOneIndexed":193,"addedLines":["            timestamp = timestamp_match.group(1) if timestamp_match else ''"],"tokenizedAddedLines":[1000253]},{"originalStartLineNumberOneIndexed":199,"originalEndLineNumberExclusiveOneIndexed":202,"modifiedStartLineNumberOneIndexed":196,"modifiedEndLineNumberExclusiveOneIndexed":201,"addedLines":["            if not cli_match:","                continue","            ","            src_ip = cli_match.group(1)","            src_port = int(cli_match.group(2))"],"tokenizedAddedLines":[1000254,154,96,1000255,1000256]},{"originalStartLineNumberOneIndexed":205,"originalEndLineNumberExclusiveOneIndexed":210,"modifiedStartLineNumberOneIndexed":204,"modifiedEndLineNumberExclusiveOneIndexed":229,"addedLines":["            if not srv_match:","                continue","            ","            dest_ip = srv_match.group(1)","            dest_port = int(srv_match.group(2))","            ","            # Create connection key","            conn_key = f\"{src_ip}:{src_port}->{dest_ip}:{dest_port}@{timestamp}\"","            ","            # Initialize connection data if not exists","            if conn_key not in connection_data:","                connection_data[conn_key] = {","                    'timestamp': datetime.now().isoformat(),","                    'src_ip': src_ip,","                    'src_port': src_port,","                    'dest_ip': dest_ip,","                    'dest_port': dest_port,","                }","            ","            # Extract subject (cli or srv) to know which side we're analyzing","            subj_match = re.search(r'subj=(cli|srv)', line)","            subject = subj_match.group(1) if subj_match else 'cli'","            ","            # Extract OS info: os=NAME (only for mod=syn or mod=syn+ack)","            if 'mod=syn|' in line or 'mod=syn+ack|' in line:"],"tokenizedAddedLines":[1000257,154,96,1000258,1000259,96,1000260,1000261,96,1000262,1000263,1000264,1000265,1000266,1000267,1000268,1000269,1000270,96,1000271,1000272,1000273,96,1000274,1000275]},{"originalStartLineNumberOneIndexed":214,"originalEndLineNumberExclusiveOneIndexed":215,"modifiedStartLineNumberOneIndexed":233,"modifiedEndLineNumberExclusiveOneIndexed":239,"addedLines":["                        # Parse OS name and version","                        os_parts = os_info.split()","                        if subject == 'cli':","                            connection_data[conn_key]['os_name'] = ' '.join(os_parts[:3]) if len(os_parts) >= 3 else os_info","                            connection_data[conn_key]['os_flavor'] = os_parts[0] if os_parts else ''","                            connection_data[conn_key]['os_version'] = ' '.join(os_parts[1:]) if len(os_parts) > 1 else ''"],"tokenizedAddedLines":[1000276,1000277,1000278,1000279,1000280,1000281]},{"originalStartLineNumberOneIndexed":219,"originalEndLineNumberExclusiveOneIndexed":220,"modifiedStartLineNumberOneIndexed":243,"modifiedEndLineNumberExclusiveOneIndexed":244,"addedLines":["                connection_data[conn_key]['distance'] = int(dist_match.group(1))"],"tokenizedAddedLines":[1000282]},{"originalStartLineNumberOneIndexed":221,"originalEndLineNumberExclusiveOneIndexed":222,"modifiedStartLineNumberOneIndexed":245,"modifiedEndLineNumberExclusiveOneIndexed":247,"addedLines":["            # Extract link type: link=TYPE (from mod=mtu lines)","            if 'mod=mtu|' in line:"],"tokenizedAddedLines":[1000283,1000284]},{"originalStartLineNumberOneIndexed":224,"originalEndLineNumberExclusiveOneIndexed":228,"modifiedStartLineNumberOneIndexed":249,"modifiedEndLineNumberExclusiveOneIndexed":264,"addedLines":["                    connection_data[conn_key]['link_type'] = link_match.group(1).strip()","            ","            # Extract HTTP app info (from mod=http lines)","            if 'mod=http' in line:","                app_match = re.search(r'app=([^|]+)', line)","                if app_match:","                    app_info = app_match.group(1).strip()","                    if app_info and app_info != '???':","                        if subject == 'srv':","                            connection_data[conn_key]['http_name'] = app_info","                        elif subject == 'cli':","                            connection_data[conn_key]['http_flavor'] = app_info","        ","        # Convert to list of entries","        entries = list(connection_data.values())"],"tokenizedAddedLines":[1000285,96,1000286,1000287,1000288,1000289,1000290,1000291,1000292,1000293,1000294,1000295,76,1000296,1000297]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}