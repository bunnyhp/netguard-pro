{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"eadbb324-c93c-4e53-973d-51e44378db92","fileSizeBytes":73386,"numLines":1904,"diffChanges":[{"originalStartLineNumberOneIndexed":1170,"originalEndLineNumberExclusiveOneIndexed":1170,"modifiedStartLineNumberOneIndexed":1170,"modifiedEndLineNumberExclusiveOneIndexed":1231,"addedLines":["","@app.route('/api/attack-monitoring')","def attack_monitoring():","    \"\"\"Get attack monitoring data for IoT devices\"\"\"","    conn = get_db_connection()","    cursor = conn.cursor()","    ","    # Get attack statistics from various tables","    cursor.execute(\"\"\"","        SELECT COUNT(*) FROM security_alerts ","        WHERE alert_type IN ('attack', 'intrusion', 'exploit')","        AND timestamp > datetime('now', '-7 days')","    \"\"\")","    total_attacks = cursor.fetchone()[0]","    ","    cursor.execute(\"\"\"","        SELECT COUNT(*) FROM security_alerts ","        WHERE alert_type IN ('attack', 'intrusion', 'exploit')","        AND status = 'blocked'","        AND timestamp > datetime('now', '-1 day')","    \"\"\")","    blocked_today = cursor.fetchone()[0]","    ","    cursor.execute(\"\"\"","        SELECT COUNT(*) FROM security_alerts ","        WHERE alert_type IN ('attack', 'intrusion', 'exploit')","        AND status = 'prevented'","        AND timestamp > datetime('now', '-7 days')","    \"\"\")","    prevented_attacks = cursor.fetchone()[0]","    ","    # Get recent attacks for timeline","    cursor.execute(\"\"\"","        SELECT alert_type, device_ip, timestamp, description, status","        FROM security_alerts ","        WHERE alert_type IN ('attack', 'intrusion', 'exploit')","        ORDER BY timestamp DESC","        LIMIT 10","    \"\"\")","    ","    recent_attacks = []","    for row in cursor.fetchall():","        attack_info = dict(row)","        recent_attacks.append({","            'type': attack_info['alert_type'].replace('_', ' ').title(),","            'device_ip': attack_info['device_ip'],","            'timestamp': attack_info['timestamp'],","            'description': attack_info['description'],","            'status': attack_info['status']","        })","    ","    conn.close()","    ","    return jsonify({","        'total_attacks': total_attacks,","        'blocked_today': blocked_today,","        'prevented_attacks': prevented_attacks,","        'attack_types': 12,  # Mock data for different attack types","        'recent_attacks': recent_attacks","    })",""],"tokenizedAddedLines":[5,1001196,1001197,1001198,22,23,342,1001199,568,1001200,1001201,1001202,571,1001203,342,568,1001200,1001201,1001204,1001205,571,1001206,342,568,1001200,1001201,1001207,1001202,571,1001208,342,1001209,568,1001210,1001211,1001201,645,737,571,342,1001212,697,1001213,1001214,1001215,1001216,1001217,1001218,1001219,362,342,26,342,762,1001220,1001221,1001222,1001223,1001224,769,5]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}