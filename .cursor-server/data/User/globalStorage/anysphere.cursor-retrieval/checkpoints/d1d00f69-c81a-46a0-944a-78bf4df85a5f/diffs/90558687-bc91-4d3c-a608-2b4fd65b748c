{"fsPath":"\\home\\jarvis\\NetGuard\\ANALYZE_ALERT_SYSTEM.py","fileUuid":"90558687-bc91-4d3c-a608-2b4fd65b748c","fileSizeBytes":8635,"numLines":235,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":236,"addedLines":["#!/usr/bin/env python3","\"\"\"","Analyze Enhanced Alert System data and performance","\"\"\"","","import sqlite3","import json","from datetime import datetime, timedelta","","DB_PATH = \"/home/jarvis/NetGuard/network.db\"","","def analyze_alert_system():","    \"\"\"Analyze the Enhanced Alert System data and performance\"\"\"","    ","    print(\"Enhanced Alert System Analysis\")","    print(\"=\" * 50)","    ","    try:","        conn = sqlite3.connect(DB_PATH)","        conn.row_factory = sqlite3.Row","        cursor = conn.cursor()","        ","        # Check if alert tables exist","        cursor.execute(\"\"\"","            SELECT name FROM sqlite_master ","            WHERE type='table' AND name IN ('security_alerts', 'alert_history', 'alert_rules')","        \"\"\")","        ","        tables = [row['name'] for row in cursor.fetchall()]","        ","        if not tables:","            print(\"‚ùå Alert system tables not found!\")","            print(\"The Enhanced Alert System hasn't been initialized yet.\")","            return","        ","        print(f\"‚úì Found alert tables: {', '.join(tables)}\")","        print()","        ","        # 1. Total alerts generated","        cursor.execute(\"SELECT COUNT(*) as total FROM security_alerts\")","        total_alerts = cursor.fetchone()['total']","        print(f\"üìä Total Alerts Generated: {total_alerts}\")","        ","        if total_alerts == 0:","            print(\"‚ö†Ô∏è  No alerts have been generated yet.\")","            print(\"This could mean:\")","            print(\"   - The system is running cleanly (no threats detected)\")","            print(\"   - The alert system hasn't been running long enough\")","            print(\"   - No suspicious activity has occurred\")","            return","        ","        # 2. Alerts by severity","        print(\"\\nüéØ Alerts by Severity:\")","        cursor.execute(\"\"\"","            SELECT severity, COUNT(*) as count","            FROM security_alerts","            GROUP BY severity","            ORDER BY ","                CASE severity","                    WHEN 'CRITICAL' THEN 1","                    WHEN 'HIGH' THEN 2","                    WHEN 'MEDIUM' THEN 3","                    WHEN 'LOW' THEN 4","                    ELSE 5","                END","        \"\"\")","        ","        for row in cursor.fetchall():","            severity = row['severity']","            count = row['count']","            emoji = {'CRITICAL': 'üî¥', 'HIGH': 'üü†', 'MEDIUM': 'üü°', 'LOW': 'üü¢', 'INFO': 'üîµ'}.get(severity, '‚ö™')","            print(f\"   {emoji} {severity}: {count}\")","        ","        # 3. Alerts by type","        print(\"\\nüìã Alerts by Type:\")","        cursor.execute(\"\"\"","            SELECT alert_type, COUNT(*) as count","            FROM security_alerts","            GROUP BY alert_type","            ORDER BY count DESC","        \"\"\")","        ","        for row in cursor.fetchall():","            print(f\"   ‚Ä¢ {row['alert_type']}: {row['count']}\")","        ","        # 4. Alerts by status","        print(\"\\nüìà Alerts by Status:\")","        cursor.execute(\"\"\"","            SELECT status, COUNT(*) as count","            FROM security_alerts","            GROUP BY status","        \"\"\")","        ","        for row in cursor.fetchall():","            status = row['status']","            count = row['count']","            emoji = {'active': 'üî¥', 'resolved': '‚úÖ', 'false_positive': '‚ùå'}.get(status, '‚ùì')","            print(f\"   {emoji} {status}: {count}\")","        ","        # 5. Recent activity (last 24 hours)","        cursor.execute(\"\"\"","            SELECT COUNT(*) as count","            FROM security_alerts","            WHERE created_at > datetime('now', '-24 hours')","        \"\"\")","        recent_24h = cursor.fetchone()['count']","        print(f\"\\n‚è∞ Recent Activity (24h): {recent_24h} alerts\")","        ","        # 6. Top source IPs","        print(\"\\nüéØ Top Source IPs (by alert count):\")","        cursor.execute(\"\"\"","            SELECT source_ip, COUNT(*) as count","            FROM security_alerts","            WHERE source_ip IS NOT NULL","            GROUP BY source_ip","            ORDER BY count DESC","            LIMIT 5","        \"\"\")","        ","        for row in cursor.fetchall():","            print(f\"   ‚Ä¢ {row['source_ip']}: {row['count']} alerts\")","        ","        # 7. Alert history activity","        if 'alert_history' in tables:","            cursor.execute(\"SELECT COUNT(*) as total FROM alert_history\")","            history_count = cursor.fetchone()['total']","            print(f\"\\nüìù Alert History Entries: {history_count}\")","            ","            cursor.execute(\"\"\"","                SELECT action, COUNT(*) as count","                FROM alert_history","                GROUP BY action","                ORDER BY count DESC","            \"\"\")","            ","            print(\"   Recent actions:\")","            for row in cursor.fetchall():","                print(f\"   ‚Ä¢ {row['action']}: {row['count']}\")","        ","        # 8. Auto-remediation stats","        if 'alert_history' in tables:","            cursor.execute(\"\"\"","                SELECT ","                    SUM(CASE WHEN action = 'auto_remediation' THEN 1 ELSE 0 END) as successful,","                    SUM(CASE WHEN action = 'auto_remediation_failed' THEN 1 ELSE 0 END) as failed","                FROM alert_history","                WHERE action IN ('auto_remediation', 'auto_remediation_failed')","            \"\"\")","            ","            result = cursor.fetchone()","            successful = result['successful'] or 0","            failed = result['failed'] or 0","            total_remediation = successful + failed","            ","            if total_remediation > 0:","                success_rate = (successful / total_remediation) * 100","                print(f\"\\nü§ñ Auto-Remediation Stats:\")","                print(f\"   ‚Ä¢ Successful: {successful}\")","                print(f\"   ‚Ä¢ Failed: {failed}\")","                print(f\"   ‚Ä¢ Success Rate: {success_rate:.1f}%\")","        ","        # 9. Sample recent alerts","        print(\"\\nüîç Recent Alerts (last 5):\")","        cursor.execute(\"\"\"","            SELECT alert_id, severity, alert_type, title, created_at","            FROM security_alerts","            ORDER BY created_at DESC","            LIMIT 5","        \"\"\")","        ","        for row in cursor.fetchall():","            severity = row['severity']","            emoji = {'CRITICAL': 'üî¥', 'HIGH': 'üü†', 'MEDIUM': 'üü°', 'LOW': 'üü¢'}.get(severity, '‚ö™')","            print(f\"   {emoji} {row['title']} ({severity})\")","            print(f\"      ID: {row['alert_id']}\")","            print(f\"      Time: {row['created_at']}\")","            print()","        ","        conn.close()","        ","    except Exception as e:","        print(f\"‚ùå Error analyzing alert system: {e}\")","","def show_alert_system_value():","    \"\"\"Show the value and purpose of the Enhanced Alert System\"\"\"","    ","    print(\"\\n\" + \"=\" * 60)","    print(\"ENHANCED ALERT SYSTEM - VALUE & PURPOSE\")","    print(\"=\" * 60)","    ","    print(\"\\nüéØ WHAT IT DOES:\")","    print(\"   ‚Ä¢ Monitors network traffic for security threats\")","    print(\"   ‚Ä¢ Detects port scanning, brute force attacks, malware\")","    print(\"   ‚Ä¢ Identifies compromised IoT devices\")","    print(\"   ‚Ä¢ Tracks unusual network behavior\")","    print(\"   ‚Ä¢ Provides automatic remediation capabilities\")","    ","    print(\"\\nüõ°Ô∏è SECURITY FEATURES:\")","    print(\"   ‚Ä¢ Real-time threat detection\")","    print(\"   ‚Ä¢ Severity-based alerting (CRITICAL, HIGH, MEDIUM, LOW)\")","    print(\"   ‚Ä¢ Automatic threat remediation\")","    print(\"   ‚Ä¢ False positive detection\")","    print(\"   ‚Ä¢ Alert history and audit trail\")","    ","    print(\"\\nüìä MONITORING CAPABILITIES:\")","    print(\"   ‚Ä¢ Port scan detection (20+ ports in 5 minutes)\")","    print(\"   ‚Ä¢ Brute force attack detection (5+ failed attempts)\")","    print(\"   ‚Ä¢ Unusual outbound traffic (1GB+ in 1 hour)\")","    print(\"   ‚Ä¢ IoT device compromise detection\")","    print(\"   ‚Ä¢ Malware C2 communication detection\")","    print(\"   ‚Ä¢ DNS tunneling detection\")","    ","    print(\"\\nü§ñ AUTOMATIC ACTIONS:\")","    print(\"   ‚Ä¢ Block malicious IPs with iptables\")","    print(\"   ‚Ä¢ Isolate compromised devices\")","    print(\"   ‚Ä¢ Generate remediation recommendations\")","    print(\"   ‚Ä¢ Log all security events\")","    ","    print(\"\\nüí° IS IT WORTH IT?\")","    print(\"   ‚úÖ YES - Provides enterprise-level security monitoring\")","    print(\"   ‚úÖ YES - Automatically detects and responds to threats\")","    print(\"   ‚úÖ YES - Helps protect your IoT devices\")","    print(\"   ‚úÖ YES - Gives you visibility into network security\")","    print(\"   ‚úÖ YES - Minimal resource usage\")","    ","    print(\"\\n‚ö° RESOURCE USAGE:\")","    print(\"   ‚Ä¢ CPU: Very low (runs every 5 minutes)\")","    print(\"   ‚Ä¢ Memory: ~50MB\")","    print(\"   ‚Ä¢ Storage: Minimal (just alert data)\")","    print(\"   ‚Ä¢ Network: None (only monitors existing data)\")","","if __name__ == \"__main__\":","    analyze_alert_system()","    show_alert_system_value()",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000001,1000003,1000004,1000005,1000006,1000003,1000007,1000003,1000008,1000009,1000010,1000011,1000012,1000010,1000013,1000014,1000015,1000016,1000017,1000018,1000019,1000020,1000021,1000022,1000017,1000023,1000017,1000024,1000025,1000026,1000027,1000017,1000028,1000029,1000017,1000030,1000031,1000032,1000033,1000017,1000034,1000035,1000036,1000037,1000038,1000039,1000027,1000017,1000040,1000041,1000019,1000042,1000043,1000044,1000045,1000046,1000047,1000048,1000049,1000050,1000051,1000052,1000022,1000017,1000053,1000054,1000055,1000056,1000057,1000017,1000058,1000059,1000019,1000060,1000043,1000061,1000062,1000022,1000017,1000053,1000063,1000017,1000064,1000065,1000019,1000066,1000043,1000067,1000022,1000017,1000053,1000068,1000055,1000069,1000070,1000017,1000071,1000019,1000072,1000043,1000073,1000022,1000074,1000075,1000017,1000076,1000077,1000019,1000078,1000043,1000079,1000080,1000062,1000081,1000022,1000017,1000053,1000082,1000017,1000083,1000084,1000085,1000086,1000087,1000088,1000089,1000090,1000091,1000092,1000093,1000094,1000088,1000095,1000096,1000097,1000017,1000098,1000084,1000089,1000099,1000100,1000101,1000091,1000102,1000094,1000088,1000103,1000104,1000105,1000106,1000088,1000107,1000108,1000109,1000110,1000111,1000112,1000017,1000113,1000114,1000019,1000115,1000043,1000116,1000081,1000022,1000017,1000053,1000054,1000117,1000118,1000119,1000120,1000121,1000017,1000122,1000017,1000123,1000124,1000003,1000125,1000126,1000010,1000127,1000128,1000129,1000010,1000130,1000131,1000132,1000133,1000134,1000135,1000010,1000136,1000137,1000138,1000139,1000140,1000141,1000010,1000142,1000143,1000144,1000145,1000146,1000147,1000148,1000010,1000149,1000150,1000151,1000152,1000153,1000010,1000154,1000155,1000156,1000157,1000158,1000159,1000010,1000160,1000161,1000162,1000163,1000164,1000003,1000165,1000166,1000167,1000003]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}