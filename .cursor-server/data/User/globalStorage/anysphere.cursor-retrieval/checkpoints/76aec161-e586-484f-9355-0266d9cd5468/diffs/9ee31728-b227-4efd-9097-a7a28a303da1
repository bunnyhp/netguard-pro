{"fsPath":"\\home\\jarvis\\NetGuard\\web\\templates\\iot_devices.html","fileUuid":"9ee31728-b227-4efd-9097-a7a28a303da1","fileSizeBytes":40500,"numLines":970,"diffChanges":[{"originalStartLineNumberOneIndexed":3,"originalEndLineNumberExclusiveOneIndexed":4,"modifiedStartLineNumberOneIndexed":3,"modifiedEndLineNumberExclusiveOneIndexed":4,"addedLines":["{% block title %}IoT Security Monitor - GuardianPi{% endblock %}"],"tokenizedAddedLines":[1000210]},{"originalStartLineNumberOneIndexed":11,"originalEndLineNumberExclusiveOneIndexed":12,"modifiedStartLineNumberOneIndexed":11,"modifiedEndLineNumberExclusiveOneIndexed":12,"addedLines":["                    <i class=\"fas fa-shield-alt\"></i> IoT Security Intelligence Center"],"tokenizedAddedLines":[1000211]},{"originalStartLineNumberOneIndexed":16,"originalEndLineNumberExclusiveOneIndexed":17,"modifiedStartLineNumberOneIndexed":16,"modifiedEndLineNumberExclusiveOneIndexed":17,"addedLines":["                    Advanced security monitoring for connected devices. Real-time threat detection, behavioral analysis, and communication pattern monitoring."],"tokenizedAddedLines":[1000212]},{"originalStartLineNumberOneIndexed":23,"originalEndLineNumberExclusiveOneIndexed":24,"modifiedStartLineNumberOneIndexed":23,"modifiedEndLineNumberExclusiveOneIndexed":24,"addedLines":["<!-- Security Overview Statistics -->"],"tokenizedAddedLines":[1000213]},{"originalStartLineNumberOneIndexed":25,"originalEndLineNumberExclusiveOneIndexed":26,"modifiedStartLineNumberOneIndexed":25,"modifiedEndLineNumberExclusiveOneIndexed":26,"addedLines":["    <div class=\"col-md-2\">"],"tokenizedAddedLines":[1000214]},{"originalStartLineNumberOneIndexed":27,"originalEndLineNumberExclusiveOneIndexed":28,"modifiedStartLineNumberOneIndexed":27,"modifiedEndLineNumberExclusiveOneIndexed":28,"addedLines":["            <div class=\"stat-label\"><i class=\"fas fa-microchip\"></i> Total Devices</div>"],"tokenizedAddedLines":[1000215]},{"originalStartLineNumberOneIndexed":31,"originalEndLineNumberExclusiveOneIndexed":32,"modifiedStartLineNumberOneIndexed":31,"modifiedEndLineNumberExclusiveOneIndexed":32,"addedLines":["    <div class=\"col-md-2\">"],"tokenizedAddedLines":[1000214]},{"originalStartLineNumberOneIndexed":33,"originalEndLineNumberExclusiveOneIndexed":35,"modifiedStartLineNumberOneIndexed":33,"modifiedEndLineNumberExclusiveOneIndexed":35,"addedLines":["            <div class=\"stat-label\"><i class=\"fas fa-shield-alt\" style=\"color: #4caf50;\"></i> Secure</div>","            <div class=\"stat-number\" style=\"color: #4caf50;\">{{ devices|selectattr('vulnerabilities.count', 'equalto', 0)|list|length }}</div>"],"tokenizedAddedLines":[1000216,1000217]},{"originalStartLineNumberOneIndexed":37,"originalEndLineNumberExclusiveOneIndexed":38,"modifiedStartLineNumberOneIndexed":37,"modifiedEndLineNumberExclusiveOneIndexed":38,"addedLines":["    <div class=\"col-md-2\">"],"tokenizedAddedLines":[1000214]},{"originalStartLineNumberOneIndexed":39,"originalEndLineNumberExclusiveOneIndexed":40,"modifiedStartLineNumberOneIndexed":39,"modifiedEndLineNumberExclusiveOneIndexed":40,"addedLines":["            <div class=\"stat-label\"><i class=\"fas fa-exclamation-triangle\" style=\"color: #ff9800;\"></i> Vulnerable</div>"],"tokenizedAddedLines":[1000218]},{"originalStartLineNumberOneIndexed":43,"originalEndLineNumberExclusiveOneIndexed":44,"modifiedStartLineNumberOneIndexed":43,"modifiedEndLineNumberExclusiveOneIndexed":56,"addedLines":["    <div class=\"col-md-2\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-eye\" style=\"color: #2196f3;\"></i> Monitoring</div>","            <div class=\"stat-number\" style=\"color: #2196f3;\" id=\"monitoring-count\">{{ devices|length }}</div>","        </div>","    </div>","    <div class=\"col-md-2\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-globe\" style=\"color: #9c27b0;\"></i> Domains Tracked</div>","            <div class=\"stat-number\" style=\"color: #9c27b0;\" id=\"domains-count\">0</div>","        </div>","    </div>","    <div class=\"col-md-2\">"],"tokenizedAddedLines":[1000214,22,1000219,1000220,17,18,1000214,22,1000221,1000222,17,18,1000214]},{"originalStartLineNumberOneIndexed":45,"originalEndLineNumberExclusiveOneIndexed":47,"modifiedStartLineNumberOneIndexed":57,"modifiedEndLineNumberExclusiveOneIndexed":132,"addedLines":["            <div class=\"stat-label\"><i class=\"fas fa-bell\" style=\"color: #f44336;\"></i> Active Alerts</div>","            <div class=\"stat-number\" style=\"color: #f44336;\" id=\"alerts-count\">0</div>","        </div>","    </div>","</div>","","<!-- Real-time Security Monitoring Panel -->","<div class=\"row mb-4\">","    <div class=\"col-md-6\">","        <div class=\"card h-100\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-radar\"></i> Real-time Communication Monitoring","                </h5>","            </div>","            <div class=\"card-body\">","                <div id=\"communication-monitor\">","                    <div class=\"text-center py-3\">","                        <div class=\"spinner-border text-primary\" role=\"status\">","                            <span class=\"visually-hidden\">Loading...</span>","                        </div>","                        <p class=\"mt-2 mb-0\" style=\"color: var(--text-secondary);\">Monitoring device communications...</p>","                    </div>","                </div>","            </div>","        </div>","    </div>","    <div class=\"col-md-6\">","        <div class=\"card h-100\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-chart-line\"></i> Behavioral Analysis","                </h5>","            </div>","            <div class=\"card-body\">","                <canvas id=\"behaviorChart\" width=\"400\" height=\"200\"></canvas>","            </div>","        </div>","    </div>","</div>","","<!-- Domain Communication Tracking -->","<div class=\"row mb-4\">","    <div class=\"col-12\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-network-wired\"></i> Domain Communication Patterns","                    <span class=\"badge bg-warning ms-2\" id=\"new-domain-badge\" style=\"display: none;\">New Domain Detected</span>","                </h5>","            </div>","            <div class=\"card-body\">","                <div class=\"table-responsive\">","                    <table class=\"table table-dark table-hover\">","                        <thead>","                            <tr>","                                <th>Device</th>","                                <th>Domain</th>","                                <th>Frequency</th>","                                <th>First Seen</th>","                                <th>Last Seen</th>","                                <th>Risk Level</th>","                                <th>Actions</th>","                            </tr>","                        </thead>","                        <tbody id=\"domain-communications\">","                            <tr>","                                <td colspan=\"7\" class=\"text-center py-4\" style=\"color: var(--text-secondary);\">","                                    <i class=\"fas fa-search\"></i> Analyzing communication patterns...","                                </td>","                            </tr>","                        </tbody>","                    </table>","                </div>","            </div>"],"tokenizedAddedLines":[1000223,1000224,17,18,19,2,1000225,5,1000226,1000227,1000228,1000229,1000230,125,12,13,1000231,1000232,1000233,1000234,54,1000235,55,60,12,17,18,1000226,1000227,1000228,1000229,1000236,125,12,13,1000237,12,17,18,19,2,1000238,5,6,110,1000228,1000229,1000239,1000240,125,12,13,1000241,1000242,1000243,1000244,1000245,1000246,1000247,1000248,1000249,1000250,1000251,1000252,1000253,1000254,1000244,1000255,1000256,1000257,1000252,1000258,1000259,60,12]},{"originalStartLineNumberOneIndexed":52,"originalEndLineNumberExclusiveOneIndexed":53,"modifiedStartLineNumberOneIndexed":137,"modifiedEndLineNumberExclusiveOneIndexed":217,"addedLines":["<!-- Advanced Security Features Panel -->","<div class=\"row mb-4\">","    <div class=\"col-md-4\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h6 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-fingerprint\"></i> Device Fingerprinting","                </h6>","            </div>","            <div class=\"card-body\">","                <div id=\"fingerprint-stats\">","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">OS Detection:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"os-detection-count\">0</span>","                    </div>","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Port Scanning:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"port-scan-count\">0</span>","                    </div>","                    <div class=\"d-flex justify-content-between\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Behavioral Analysis:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"behavior-analysis-count\">0</span>","                    </div>","                </div>","            </div>","        </div>","    </div>","    <div class=\"col-md-4\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h6 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-shield-virus\"></i> Threat Detection","                </h6>","            </div>","            <div class=\"card-body\">","                <div id=\"threat-stats\">","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Malware Scans:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"malware-scan-count\">0</span>","                    </div>","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Anomaly Detection:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"anomaly-count\">0</span>","                    </div>","                    <div class=\"d-flex justify-content-between\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Intrusion Attempts:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"intrusion-count\">0</span>","                    </div>","                </div>","            </div>","        </div>","    </div>","    <div class=\"col-md-4\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h6 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-clock\"></i> Real-time Monitoring","                </h6>","            </div>","            <div class=\"card-body\">","                <div id=\"realtime-stats\">","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Active Connections:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"active-connections\">0</span>","                    </div>","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Data Rate:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"data-rate\">0 KB/s</span>","                    </div>","                    <div class=\"d-flex justify-content-between\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Packet Rate:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\" id=\"packet-rate\">0 pps</span>","                    </div>","                </div>","            </div>","        </div>","    </div>","</div>","","<!-- IoT Devices Grid with Enhanced Security -->"],"tokenizedAddedLines":[1000260,5,1000261,110,1000228,1000262,1000263,1000264,12,13,1000265,63,1000266,1000267,55,63,1000268,1000269,55,70,1000270,1000271,55,60,12,17,18,1000261,110,1000228,1000262,1000272,1000264,12,13,1000273,63,1000274,1000275,55,63,1000276,1000277,55,70,1000278,1000279,55,60,12,17,18,1000261,110,1000228,1000262,1000280,1000264,12,13,1000281,63,1000282,1000283,55,63,1000284,1000285,55,70,1000286,1000287,55,60,12,17,18,19,2,1000288]},{"originalStartLineNumberOneIndexed":56,"originalEndLineNumberExclusiveOneIndexed":57,"modifiedStartLineNumberOneIndexed":220,"modifiedEndLineNumberExclusiveOneIndexed":221,"addedLines":["        <div class=\"card h-100 device-card\" style=\"border-left: 4px solid {% if device.vulnerabilities.count == 0 %}#4caf50{% elif device.vulnerabilities.max_severity >= 3 %}#f44336{% else %}#ff9800{% endif %};\" data-device-ip=\"{{ device.ip_address }}\">"],"tokenizedAddedLines":[1000289]},{"originalStartLineNumberOneIndexed":58,"originalEndLineNumberExclusiveOneIndexed":59,"modifiedStartLineNumberOneIndexed":222,"modifiedEndLineNumberExclusiveOneIndexed":223,"addedLines":["                <!-- Device Header with Security Status -->"],"tokenizedAddedLines":[1000290]},{"originalStartLineNumberOneIndexed":72,"originalEndLineNumberExclusiveOneIndexed":72,"modifiedStartLineNumberOneIndexed":236,"modifiedEndLineNumberExclusiveOneIndexed":239,"addedLines":["                            <span class=\"badge bg-{% if device.vulnerabilities.count == 0 %}success{% elif device.vulnerabilities.max_severity >= 3 %}danger{% else %}warning{% endif %} ms-2\" style=\"font-size: 0.6rem;\">","                                {% if device.vulnerabilities.count == 0 %}SECURE{% elif device.vulnerabilities.max_severity >= 3 %}HIGH RISK{% else %}MEDIUM{% endif %}","                            </span>"],"tokenizedAddedLines":[1000291,1000292,1000293]},{"originalStartLineNumberOneIndexed":74,"originalEndLineNumberExclusiveOneIndexed":75,"modifiedStartLineNumberOneIndexed":241,"modifiedEndLineNumberExclusiveOneIndexed":242,"addedLines":["                            {{ device.device_category }} â€¢ <span id=\"device-status-{{ loop.index }}\" style=\"color: #4caf50;\">Online</span>"],"tokenizedAddedLines":[1000294]},{"originalStartLineNumberOneIndexed":81,"originalEndLineNumberExclusiveOneIndexed":82,"modifiedStartLineNumberOneIndexed":248,"modifiedEndLineNumberExclusiveOneIndexed":249,"addedLines":["                        <div style=\"font-size: 0.75rem; color: var(--text-secondary);\">Security Score</div>"],"tokenizedAddedLines":[1000295]},{"originalStartLineNumberOneIndexed":126,"originalEndLineNumberExclusiveOneIndexed":127,"modifiedStartLineNumberOneIndexed":293,"modifiedEndLineNumberExclusiveOneIndexed":294,"addedLines":["                <!-- Enhanced Activity Stats with Security Metrics -->"],"tokenizedAddedLines":[1000296]},{"originalStartLineNumberOneIndexed":129,"originalEndLineNumberExclusiveOneIndexed":130,"modifiedStartLineNumberOneIndexed":296,"modifiedEndLineNumberExclusiveOneIndexed":297,"addedLines":["                        <div class=\"col-4\">"],"tokenizedAddedLines":[1000297]},{"originalStartLineNumberOneIndexed":131,"originalEndLineNumberExclusiveOneIndexed":132,"modifiedStartLineNumberOneIndexed":298,"modifiedEndLineNumberExclusiveOneIndexed":299,"addedLines":["                            <div style=\"color: #fff; font-weight: 600; font-size: 0.85rem;\">{{ device.total_packets|default(0) }}</div>"],"tokenizedAddedLines":[1000298]},{"originalStartLineNumberOneIndexed":133,"originalEndLineNumberExclusiveOneIndexed":134,"modifiedStartLineNumberOneIndexed":300,"modifiedEndLineNumberExclusiveOneIndexed":301,"addedLines":["                        <div class=\"col-4\">"],"tokenizedAddedLines":[1000297]},{"originalStartLineNumberOneIndexed":135,"originalEndLineNumberExclusiveOneIndexed":136,"modifiedStartLineNumberOneIndexed":302,"modifiedEndLineNumberExclusiveOneIndexed":303,"addedLines":["                            <div style=\"color: #fff; font-weight: 600; font-size: 0.85rem;\">"],"tokenizedAddedLines":[1000299]},{"originalStartLineNumberOneIndexed":147,"originalEndLineNumberExclusiveOneIndexed":147,"modifiedStartLineNumberOneIndexed":314,"modifiedEndLineNumberExclusiveOneIndexed":333,"addedLines":["                        <div class=\"col-4\">","                            <div style=\"color: var(--text-secondary); font-size: 0.75rem;\">Connections</div>","                            <div style=\"color: #fff; font-weight: 600; font-size: 0.85rem;\" id=\"connections-{{ loop.index }}\">0</div>","                        </div>","                    </div>","                    ","                    <!-- Security Actions -->","                    <div class=\"mt-3 pt-3\" style=\"border-top: 1px solid var(--border-color);\">","                        <div class=\"d-flex gap-2\">","                            <button class=\"btn btn-sm btn-outline-primary flex-fill\" onclick=\"showDeviceDetails('{{ device.ip_address }}')\" style=\"font-size: 0.75rem;\">","                                <i class=\"fas fa-info-circle\"></i> Details","                            </button>","                            <button class=\"btn btn-sm btn-outline-warning flex-fill\" onclick=\"scanDevice('{{ device.ip_address }}')\" style=\"font-size: 0.75rem;\">","                                <i class=\"fas fa-search\"></i> Scan","                            </button>","                            <button class=\"btn btn-sm btn-outline-danger flex-fill\" onclick=\"blockDevice('{{ device.ip_address }}')\" style=\"font-size: 0.75rem;\">","                                <i class=\"fas fa-ban\"></i> Block","                            </button>","                        </div>"],"tokenizedAddedLines":[1000297,1000300,1000301,54,55,1000302,1000303,1000304,1000305,1000306,1000307,1000308,1000309,1000310,1000308,1000311,1000312,1000308,54]},{"originalStartLineNumberOneIndexed":161,"originalEndLineNumberExclusiveOneIndexed":162,"modifiedStartLineNumberOneIndexed":347,"modifiedEndLineNumberExclusiveOneIndexed":348,"addedLines":["                <h3 class=\"mt-3\" style=\"color: #fff;\">No Connected Devices Found</h3>"],"tokenizedAddedLines":[1000313]},{"originalStartLineNumberOneIndexed":163,"originalEndLineNumberExclusiveOneIndexed":165,"modifiedStartLineNumberOneIndexed":349,"modifiedEndLineNumberExclusiveOneIndexed":351,"addedLines":["                    The device tracker hasn't identified any connected devices yet.<br>","                    Devices will appear here automatically as they're discovered on your network."],"tokenizedAddedLines":[1000314,1000315]},{"originalStartLineNumberOneIndexed":171,"originalEndLineNumberExclusiveOneIndexed":171,"modifiedStartLineNumberOneIndexed":357,"modifiedEndLineNumberExclusiveOneIndexed":429,"addedLines":["","<!-- Advanced Security Monitoring Section -->","<div class=\"row mb-4\">","    <div class=\"col-md-6\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-exclamation-triangle\"></i> Security Alerts","                </h5>","            </div>","            <div class=\"card-body\">","                <div id=\"security-alerts\">","                    <div class=\"alert alert-info mb-2\">","                        <i class=\"fas fa-info-circle\"></i> Monitoring for suspicious activities...","                    </div>","                </div>","            </div>","        </div>","    </div>","    <div class=\"col-md-6\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-history\"></i> Communication History","                </h5>","            </div>","            <div class=\"card-body\">","                <canvas id=\"communicationChart\" width=\"400\" height=\"200\"></canvas>","            </div>","        </div>","    </div>","</div>","","<!-- Network Traffic Analysis -->","<div class=\"row mb-4\">","    <div class=\"col-12\">","        <div class=\"card\">","            <div class=\"card-header\" style=\"background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"mb-0\" style=\"color: #fff;\">","                    <i class=\"fas fa-chart-area\"></i> Network Traffic Analysis","                </h5>","            </div>","            <div class=\"card-body\">","                <div class=\"row\">","                    <div class=\"col-md-8\">","                        <canvas id=\"trafficChart\" width=\"600\" height=\"300\"></canvas>","                    </div>","                    <div class=\"col-md-4\">","                        <div class=\"traffic-stats\">","                            <div class=\"d-flex justify-content-between mb-2\">","                                <span style=\"color: var(--text-secondary);\">Total Traffic:</span>","                                <span style=\"color: #fff;\" id=\"total-traffic\">0 MB</span>","                            </div>","                            <div class=\"d-flex justify-content-between mb-2\">","                                <span style=\"color: var(--text-secondary);\">Peak Rate:</span>","                                <span style=\"color: #fff;\" id=\"peak-rate\">0 Mbps</span>","                            </div>","                            <div class=\"d-flex justify-content-between mb-2\">","                                <span style=\"color: var(--text-secondary);\">Suspicious:</span>","                                <span style=\"color: #f44336;\" id=\"suspicious-traffic\">0</span>","                            </div>","                            <div class=\"d-flex justify-content-between\">","                                <span style=\"color: var(--text-secondary);\">Encrypted:</span>","                                <span style=\"color: #4caf50;\" id=\"encrypted-traffic\">0%</span>","                            </div>","                        </div>","                    </div>","                </div>","            </div>","        </div>","    </div>","</div>"],"tokenizedAddedLines":[2,1000316,5,1000226,110,1000228,1000229,1000317,125,12,13,1000318,1000319,1000320,55,60,12,17,18,1000226,110,1000228,1000229,1000321,125,12,13,1000322,12,17,18,19,2,1000323,5,6,110,1000228,1000229,1000324,125,12,13,1000325,1000326,1000327,55,1000328,1000329,1000330,1000331,1000332,106,1000330,1000333,1000334,106,1000330,1000335,1000336,106,1000337,1000338,1000339,106,54,55,60,12,17,18,19]},{"originalStartLineNumberOneIndexed":193,"originalEndLineNumberExclusiveOneIndexed":193,"modifiedStartLineNumberOneIndexed":451,"modifiedEndLineNumberExclusiveOneIndexed":452,"addedLines":["<script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>"],"tokenizedAddedLines":[1000340]},{"originalStartLineNumberOneIndexed":194,"originalEndLineNumberExclusiveOneIndexed":194,"modifiedStartLineNumberOneIndexed":453,"modifiedEndLineNumberExclusiveOneIndexed":748,"addedLines":["// Global variables for charts","let behaviorChart, communicationChart, trafficChart;","","// Initialize the page","document.addEventListener('DOMContentLoaded', function() {","    initializeCharts();","    startRealTimeMonitoring();","    loadDomainCommunications();","    loadSecurityStats();","    updateTrafficStats();","});","","function initializeCharts() {","    // Behavioral Analysis Chart","    const behaviorCtx = document.getElementById('behaviorChart').getContext('2d');","    behaviorChart = new Chart(behaviorCtx, {","        type: 'line',","        data: {","            labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],","            datasets: [{","                label: 'Normal Activity',","                data: [12, 19, 3, 5, 2, 3],","                borderColor: '#4caf50',","                backgroundColor: 'rgba(76, 175, 80, 0.1)',","                tension: 0.4","            }, {","                label: 'Anomalous Activity',","                data: [0, 2, 1, 0, 1, 0],","                borderColor: '#f44336',","                backgroundColor: 'rgba(244, 67, 54, 0.1)',","                tension: 0.4","            }]","        },","        options: {","            responsive: true,","            maintainAspectRatio: false,","            plugins: {","                legend: {","                    labels: { color: '#fff' }","                }","            },","            scales: {","                x: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.1)' }},","                y: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.1)' }}","            }","        }","    });","","    // Communication History Chart","    const communicationCtx = document.getElementById('communicationChart').getContext('2d');","    communicationChart = new Chart(communicationCtx, {","        type: 'doughnut',","        data: {","            labels: ['HTTPS', 'HTTP', 'DNS', 'Other'],","            datasets: [{","                data: [65, 20, 10, 5],","                backgroundColor: ['#4caf50', '#ff9800', '#2196f3', '#9e9e9e'],","                borderWidth: 2,","                borderColor: '#1a1a1a'","            }]","        },","        options: {","            responsive: true,","            maintainAspectRatio: false,","            plugins: {","                legend: {","                    labels: { color: '#fff' }","                }","            }","        }","    });","","    // Traffic Analysis Chart","    const trafficCtx = document.getElementById('trafficChart').getContext('2d');","    trafficChart = new Chart(trafficCtx, {","        type: 'bar',","        data: {","            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],","            datasets: [{","                label: 'Normal Traffic',","                data: [12, 19, 3, 5, 2, 3, 8],","                backgroundColor: '#4caf50'","            }, {","                label: 'Suspicious Traffic',","                data: [1, 2, 0, 1, 0, 1, 0],","                backgroundColor: '#f44336'","            }]","        },","        options: {","            responsive: true,","            maintainAspectRatio: false,","            plugins: {","                legend: {","                    labels: { color: '#fff' }","                }","            },","            scales: {","                x: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.1)' }},","                y: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.1)' }}","            }","        }","    });","}","","function startRealTimeMonitoring() {","    // Update real-time stats every 5 seconds","    setInterval(() => {","        updateRealTimeStats();","        updateDeviceStatus();","        checkNewDomains();","    }, 5000);","    ","    // Update communication monitoring every 2 seconds","    setInterval(() => {","        updateCommunicationMonitor();","    }, 2000);","}","","function updateRealTimeStats() {","    // Simulate real-time data updates","    document.getElementById('active-connections').textContent = Math.floor(Math.random() * 50) + 10;","    document.getElementById('data-rate').textContent = (Math.random() * 1000 + 100).toFixed(1) + ' KB/s';","    document.getElementById('packet-rate').textContent = Math.floor(Math.random() * 500 + 50) + ' pps';","}","","function updateDeviceStatus() {","    // Update device connection counts","    document.querySelectorAll('[id^=\"connections-\"]').forEach(el => {","        el.textContent = Math.floor(Math.random() * 20) + 1;","    });","}","","function loadDomainCommunications() {","    fetch('/api/domain-communications')","        .then(response => response.json())","        .then(data => {","            updateDomainTable(data);","            document.getElementById('domains-count').textContent = data.length;","        })","        .catch(error => {","            console.error('Error loading domain communications:', error);","            // Show sample data for demonstration","            showSampleDomainData();","        });","}","","function showSampleDomainData() {","    const sampleData = [","        {","            device: 'Smart TV (192.168.1.100)',","            domain: 'netflix.com',","            frequency: 'High',","            firstSeen: '2024-01-15',","            lastSeen: '2024-01-20 14:30',","            riskLevel: 'Low'","        },","        {","            device: 'Smart Speaker (192.168.1.101)',","            domain: 'amazon.com',","            frequency: 'Very High',","            firstSeen: '2024-01-10',","            lastSeen: '2024-01-20 14:35',","            riskLevel: 'Low'","        },","        {","            device: 'Security Camera (192.168.1.102)',","            domain: 'cloud-cam-provider.com',","            frequency: 'Medium',","            firstSeen: '2024-01-18',","            lastSeen: '2024-01-20 14:25',","            riskLevel: 'Medium'","        }","    ];","    ","    updateDomainTable(sampleData);","    document.getElementById('domains-count').textContent = sampleData.length;","}","","function updateDomainTable(data) {","    const tbody = document.getElementById('domain-communications');","    ","    if (data.length === 0) {","        tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4\" style=\"color: var(--text-secondary);\"><i class=\"fas fa-search\"></i> No domain communications detected yet</td></tr>';","        return;","    }","    ","    let html = '';","    data.forEach(item => {","        const riskColor = {","            'Low': '#4caf50',","            'Medium': '#ff9800',","            'High': '#f44336'","        }[item.riskLevel] || '#9e9e9e';","        ","        html += `","            <tr>","                <td style=\"color: #fff;\">${item.device}</td>","                <td style=\"color: #fff; font-family: monospace;\">${item.domain}</td>","                <td><span class=\"badge bg-${item.frequency === 'Very High' ? 'danger' : item.frequency === 'High' ? 'warning' : 'info'}\">${item.frequency}</span></td>","                <td style=\"color: var(--text-secondary);\">${item.firstSeen}</td>","                <td style=\"color: var(--text-secondary);\">${item.lastSeen}</td>","                <td><span class=\"badge\" style=\"background: ${riskColor};\">${item.riskLevel}</span></td>","                <td>","                    <button class=\"btn btn-sm btn-outline-warning\" onclick=\"analyzeDomain('${item.domain}')\">","                        <i class=\"fas fa-search\"></i>","                    </button>","                    <button class=\"btn btn-sm btn-outline-danger ms-1\" onclick=\"blockDomain('${item.domain}')\">","                        <i class=\"fas fa-ban\"></i>","                    </button>","                </td>","            </tr>","        `;","    });","    ","    tbody.innerHTML = html;","}","","function checkNewDomains() {","    // Simulate new domain detection","    if (Math.random() < 0.1) { // 10% chance","        document.getElementById('new-domain-badge').style.display = 'inline-block';","        setTimeout(() => {","            document.getElementById('new-domain-badge').style.display = 'none';","        }, 5000);","    }","}","","function updateCommunicationMonitor() {","    const monitor = document.getElementById('communication-monitor');","    const activities = [","        'Smart TV communicating with netflix.com',","        'Security camera uploading to cloud',","        'Smart speaker checking for updates',","        'Thermostat syncing with weather API',","        'Smart bulb responding to app command'","    ];","    ","    const randomActivity = activities[Math.floor(Math.random() * activities.length)];","    const timestamp = new Date().toLocaleTimeString();","    ","    monitor.innerHTML = `","        <div class=\"communication-item mb-2\" style=\"border-left: 3px solid #4caf50; padding-left: 10px;\">","            <div style=\"color: #fff; font-size: 0.9rem;\">${randomActivity}</div>","            <div style=\"color: var(--text-secondary); font-size: 0.75rem;\">${timestamp}</div>","        </div>","    `;","}","","function loadSecurityStats() {","    // Update security statistics","    document.getElementById('os-detection-count').textContent = Math.floor(Math.random() * 10) + 5;","    document.getElementById('port-scan-count').textContent = Math.floor(Math.random() * 20) + 10;","    document.getElementById('behavior-analysis-count').textContent = Math.floor(Math.random() * 15) + 8;","    document.getElementById('malware-scan-count').textContent = Math.floor(Math.random() * 5) + 1;","    document.getElementById('anomaly-count').textContent = Math.floor(Math.random() * 3);","    document.getElementById('intrusion-count').textContent = Math.floor(Math.random() * 2);","}","","function updateTrafficStats() {","    document.getElementById('total-traffic').textContent = (Math.random() * 1000 + 500).toFixed(1) + ' MB';","    document.getElementById('peak-rate').textContent = (Math.random() * 100 + 50).toFixed(1) + ' Mbps';","    document.getElementById('suspicious-traffic').textContent = Math.floor(Math.random() * 5);","    document.getElementById('encrypted-traffic').textContent = Math.floor(Math.random() * 30 + 70) + '%';","}","","// Device action functions","function showDeviceDetails(deviceIp) {","    alert(`Showing detailed information for device: ${deviceIp}`);","    // Implementation for device details modal","}","","function scanDevice(deviceIp) {","    alert(`Initiating security scan for device: ${deviceIp}`);","    // Implementation for device scanning","}","","function blockDevice(deviceIp) {","    if (confirm(`Are you sure you want to block device ${deviceIp}?`)) {","        alert(`Device ${deviceIp} has been blocked from network access`);","        // Implementation for device blocking","    }","}","","function analyzeDomain(domain) {","    alert(`Analyzing domain: ${domain}`);","    // Implementation for domain analysis","}","","function blockDomain(domain) {","    if (confirm(`Are you sure you want to block domain ${domain}?`)) {","        alert(`Domain ${domain} has been blocked`);","        // Implementation for domain blocking","    }","}",""],"tokenizedAddedLines":[1000341,1000342,2,1000343,1000344,1000345,1000346,1000347,1000348,1000349,1000350,2,1000351,1000352,1000353,1000354,1000355,1000356,1000357,1000358,1000359,1000360,1000361,1000362,1000363,1000364,1000365,1000366,1000367,1000368,1000363,1000369,1000370,1000371,1000372,1000373,1000374,1000375,1000376,1000377,1000378,1000379,1000380,1000381,148,1000382,1000383,2,1000384,1000385,1000386,1000387,1000356,1000388,1000358,1000389,1000390,1000391,1000392,1000369,1000370,1000371,1000372,1000373,1000374,1000375,1000376,1000377,148,1000382,1000383,2,1000393,1000394,1000395,1000396,1000356,1000397,1000358,1000398,1000399,1000400,1000364,1000401,1000402,1000403,1000369,1000370,1000371,1000372,1000373,1000374,1000375,1000376,1000377,1000378,1000379,1000380,1000381,148,1000382,1000383,186,2,1000404,1000405,1000406,1000407,1000408,1000409,1000410,135,1000411,1000406,1000412,1000413,186,2,1000414,1000415,1000416,1000417,1000418,186,2,1000419,1000420,1000421,1000422,1000383,186,2,1000423,1000424,143,1000425,1000426,1000427,181,182,1000428,1000429,1000430,185,186,2,1000431,1000432,1000433,1000434,1000435,1000436,1000437,1000438,1000439,1000370,1000433,1000440,1000441,1000442,1000443,1000444,1000439,1000370,1000433,1000445,1000446,1000447,1000448,1000449,1000450,1000382,1000451,135,1000452,1000453,186,2,1000454,1000455,135,1000456,1000457,1000458,1000459,135,1000460,1000461,1000462,1000463,1000464,1000465,1000466,1000467,1000468,1000469,1000470,1000471,1000472,1000473,1000474,1000475,1000476,1000477,1000478,1000479,1000480,1000481,1000479,1000482,1000483,1000484,1000383,135,1000485,186,2,1000486,1000487,1000488,1000489,1000490,1000491,1000492,1000459,186,2,1000493,1000494,1000495,1000496,1000497,1000498,1000499,1000500,1000451,135,1000501,1000502,135,1000503,1000504,1000505,1000506,17,140,186,2,1000507,1000508,1000509,1000510,1000511,1000512,1000513,1000514,186,2,1000515,1000516,1000517,1000518,1000519,186,2,1000520,1000521,1000522,1000523,186,2,1000524,1000525,1000526,186,2,1000527,1000528,1000529,1000530,1000459,186,2,1000531,1000532,1000533,186,2,1000534,1000535,1000536,1000537,1000459,186,2]},{"originalStartLineNumberOneIndexed":268,"originalEndLineNumberExclusiveOneIndexed":270,"modifiedStartLineNumberOneIndexed":822,"modifiedEndLineNumberExclusiveOneIndexed":824,"addedLines":["    padding: 15px;","    transition: transform 0.2s, box-shadow 0.2s;"],"tokenizedAddedLines":[1000538,1000539]},{"originalStartLineNumberOneIndexed":274,"originalEndLineNumberExclusiveOneIndexed":274,"modifiedStartLineNumberOneIndexed":828,"modifiedEndLineNumberExclusiveOneIndexed":829,"addedLines":["    box-shadow: 0 4px 12px rgba(0, 212, 255, 0.15);"],"tokenizedAddedLines":[1000540]},{"originalStartLineNumberOneIndexed":277,"originalEndLineNumberExclusiveOneIndexed":278,"modifiedStartLineNumberOneIndexed":832,"modifiedEndLineNumberExclusiveOneIndexed":833,"addedLines":["    font-size: 0.75rem;"],"tokenizedAddedLines":[1000541]},{"originalStartLineNumberOneIndexed":281,"originalEndLineNumberExclusiveOneIndexed":282,"modifiedStartLineNumberOneIndexed":836,"modifiedEndLineNumberExclusiveOneIndexed":837,"addedLines":["    margin-bottom: 8px;"],"tokenizedAddedLines":[1000542]},{"originalStartLineNumberOneIndexed":285,"originalEndLineNumberExclusiveOneIndexed":286,"modifiedStartLineNumberOneIndexed":840,"modifiedEndLineNumberExclusiveOneIndexed":841,"addedLines":["    font-size: 1.5rem;"],"tokenizedAddedLines":[1000543]},{"originalStartLineNumberOneIndexed":289,"originalEndLineNumberExclusiveOneIndexed":289,"modifiedStartLineNumberOneIndexed":844,"modifiedEndLineNumberExclusiveOneIndexed":967,"addedLines":["",".device-card {","    transition: transform 0.2s, box-shadow 0.2s;","}","",".device-card:hover {","    transform: translateY(-3px);","    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);","}","",".communication-item {","    animation: slideIn 0.3s ease-out;","}","","@keyframes slideIn {","    from {","        opacity: 0;","        transform: translateX(-20px);","    }","    to {","        opacity: 1;","        transform: translateX(0);","    }","}","",".traffic-stats {","    background: rgba(255, 255, 255, 0.02);","    border-radius: 8px;","    padding: 15px;","    border: 1px solid var(--border-color);","}","","#new-domain-badge {","    animation: pulse 1s infinite;","}","","@keyframes pulse {","    0% { opacity: 1; }","    50% { opacity: 0.7; }","    100% { opacity: 1; }","}","",".btn-outline-primary, .btn-outline-warning, .btn-outline-danger {","    transition: all 0.2s;","}","",".btn-outline-primary:hover {","    background-color: var(--primary-color);","    border-color: var(--primary-color);","    transform: scale(1.05);","}","",".btn-outline-warning:hover {","    background-color: #ff9800;","    border-color: #ff9800;","    transform: scale(1.05);","}","",".btn-outline-danger:hover {","    background-color: #f44336;","    border-color: #f44336;","    transform: scale(1.05);","}","",".card-header {","    border-bottom: 1px solid var(--border-color) !important;","}","",".table-dark {","    --bs-table-bg: var(--bg-primary);","    --bs-table-color: #fff;","}","",".table-dark th {","    border-color: var(--border-color);","    background-color: var(--bg-secondary);","}","",".table-dark td {","    border-color: var(--border-color);","}","",".table-hover tbody tr:hover {","    background-color: rgba(255, 255, 255, 0.05);","}","",".alert {","    border: none;","    border-radius: 6px;","}","",".alert-info {","    background-color: rgba(33, 150, 243, 0.1);","    color: #2196f3;","    border-left: 3px solid #2196f3;","}","",".alert-success {","    background-color: rgba(76, 175, 80, 0.1);","    color: #4caf50;","    border-left: 3px solid #4caf50;","}","",".alert-warning {","    background-color: rgba(255, 152, 0, 0.1);","    color: #ff9800;","    border-left: 3px solid #ff9800;","}","",".alert-danger {","    background-color: rgba(244, 67, 54, 0.1);","    color: #f44336;","    border-left: 3px solid #f44336;","}","",".badge {","    font-size: 0.7rem;","    padding: 4px 8px;","}","",".spinner-border {","    color: var(--primary-color) !important;","}"],"tokenizedAddedLines":[2,1000544,1000539,186,2,1000545,1000546,1000547,186,2,1000548,1000549,186,2,1000550,1000551,1000552,1000553,1000459,1000554,1000555,1000556,1000459,186,2,1000557,1000558,194,1000538,193,186,2,1000559,1000560,186,2,1000561,1000562,1000563,1000564,186,2,1000565,1000566,186,2,1000567,1000568,1000569,1000570,186,2,1000571,1000572,1000573,1000570,186,2,1000574,1000575,1000576,1000570,186,2,1000577,1000578,186,2,1000579,1000580,1000581,186,2,1000582,1000583,1000584,186,2,1000585,1000583,186,2,1000586,1000587,186,2,1000588,1000589,1000590,186,2,1000591,1000592,1000593,1000594,186,2,1000595,1000596,1000597,1000598,186,2,1000599,1000600,1000601,1000602,186,2,1000603,1000604,1000605,1000606,186,2,1000607,1000608,1000609,186,2,1000610,1000611,186]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}