{"fsPath":"\\home\\jarvis\\NetGuard\\check_p0f_database.py","fileUuid":"7a87b256-45a6-450a-9476-204442032cba","fileSizeBytes":2107,"numLines":66,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":67,"addedLines":["#!/usr/bin/env python3","import sqlite3","import os","","DB_PATH = \"/home/jarvis/NetGuard/network.db\"","","print(\"=\"*60)","print(\"P0F DATABASE CHECK\")","print(\"=\"*60)","","if not os.path.exists(DB_PATH):","    print(f\"ERROR: Database not found at {DB_PATH}\")","    exit(1)","","conn = sqlite3.connect(DB_PATH)","cursor = conn.cursor()","","# Get all p0f tables","cursor.execute(\"SELECT name FROM sqlite_master WHERE type='table' AND name LIKE 'p0f_%' ORDER BY name DESC\")","tables = cursor.fetchall()","","print(f\"\\nFound {len(tables)} p0f tables:\")","print(\"-\" * 60)","","if len(tables) == 0:","    print(\"✗ NO P0F TABLES FOUND IN DATABASE\")","    print(\"\\nThis means p0f_collector.py is NOT inserting data.\")","    print(\"\\nPossible reasons:\")","    print(\"1. p0f log file is empty (no traffic captured)\")","    print(\"2. p0f_collector.py is not running properly\")","    print(\"3. p0f_collector.py has errors parsing the log\")","else:","    for table in tables[:10]:  # Show last 10 tables","        table_name = table[0]","        cursor.execute(f\"SELECT COUNT(*) FROM {table_name}\")","        count = cursor.fetchone()[0]","        ","        # Get sample data","        if count > 0:","            cursor.execute(f\"SELECT * FROM {table_name} LIMIT 1\")","            sample = cursor.fetchone()","            print(f\"\\n✓ {table_name}: {count} records\")","            if sample:","                cursor.execute(f\"PRAGMA table_info({table_name})\")","                columns = [col[1] for col in cursor.fetchall()]","                print(f\"  Columns: {', '.join(columns)}\")","                print(f\"  Sample: {dict(zip(columns, sample))}\")","        else:","            print(f\"\\n✗ {table_name}: EMPTY (0 records)\")","","conn.close()","","print(\"\\n\" + \"=\"*60)","print(\"SUMMARY\")","print(\"=\"*60)","print(f\"Total p0f tables: {len(tables)}\")","if len(tables) > 0:","    cursor = sqlite3.connect(DB_PATH).cursor()","    cursor.execute(f\"SELECT SUM(cnt) FROM (SELECT COUNT(*) as cnt FROM {tables[0][0]} UNION ALL SELECT 0)\")","    total_records = sum([cursor.execute(f\"SELECT COUNT(*) FROM {t[0]}\").fetchone()[0] for t in tables])","    print(f\"Total records: {total_records}\")","else:","    print(\"Total records: 0\")","print(\"=\"*60)","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000003,1000005,1000006,1000005,1000003,1000007,1000008,1000009,1000003,1000010,1000011,1000003,1000012,1000013,1000014,1000003,1000015,1000016,1000003,1000017,1000018,1000019,1000020,1000021,1000022,1000023,1000024,1000025,1000026,1000027,1000028,1000029,1000030,1000031,1000032,1000033,1000034,1000035,1000036,1000037,1000038,1000039,1000040,1000041,1000003,1000042,1000003,1000043,1000044,1000005,1000045,1000046,1000047,1000048,1000049,1000050,1000024,1000051,1000005,1000003,1000003]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}