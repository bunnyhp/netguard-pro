{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\netsniff_collector.py","fileUuid":"04901b8d-2dd0-46d9-8dc0-735a6d7e70a6","fileSizeBytes":10876,"numLines":319,"diffChanges":[{"originalStartLineNumberOneIndexed":17,"originalEndLineNumberExclusiveOneIndexed":18,"modifiedStartLineNumberOneIndexed":17,"modifiedEndLineNumberExclusiveOneIndexed":18,"addedLines":["INTERFACE = \"wlo1\""],"tokenizedAddedLines":[1000227]},{"originalStartLineNumberOneIndexed":88,"originalEndLineNumberExclusiveOneIndexed":88,"modifiedStartLineNumberOneIndexed":88,"modifiedEndLineNumberExclusiveOneIndexed":92,"addedLines":["        # Create a specific output file (not directory)","        timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")","        output_file = os.path.join(CAPTURE_DIR, f\"capture_{timestamp}.pcap\")","        "],"tokenizedAddedLines":[1000228,1000229,1000230,66]},{"originalStartLineNumberOneIndexed":91,"originalEndLineNumberExclusiveOneIndexed":94,"modifiedStartLineNumberOneIndexed":95,"modifiedEndLineNumberExclusiveOneIndexed":97,"addedLines":["            '-o', output_file,","            '--silent'"],"tokenizedAddedLines":[1000231,1000232]},{"originalStartLineNumberOneIndexed":107,"originalEndLineNumberExclusiveOneIndexed":107,"modifiedStartLineNumberOneIndexed":110,"modifiedEndLineNumberExclusiveOneIndexed":113,"addedLines":["            timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")","            output_file = os.path.join(CAPTURE_DIR, f\"capture_{timestamp}.pcap\")","            "],"tokenizedAddedLines":[1000233,1000234,92]},{"originalStartLineNumberOneIndexed":110,"originalEndLineNumberExclusiveOneIndexed":113,"modifiedStartLineNumberOneIndexed":116,"modifiedEndLineNumberExclusiveOneIndexed":118,"addedLines":["                '-o', output_file,","                '--silent'"],"tokenizedAddedLines":[1000235,1000236]},{"originalStartLineNumberOneIndexed":278,"originalEndLineNumberExclusiveOneIndexed":283,"modifiedStartLineNumberOneIndexed":283,"modifiedEndLineNumberExclusiveOneIndexed":283},{"originalStartLineNumberOneIndexed":285,"originalEndLineNumberExclusiveOneIndexed":285,"modifiedStartLineNumberOneIndexed":285,"modifiedEndLineNumberExclusiveOneIndexed":304,"addedLines":["            # Start netsniff-ng for this capture period","            if not start_netsniff():","                logging.warning(\"Failed to start netsniff-ng. Retrying in next cycle.\")","            else:","                # Let it capture for COLLECT_INTERVAL seconds","                time.sleep(COLLECT_INTERVAL)","                ","                # Stop netsniff-ng","                if netsniff_process:","                    netsniff_process.terminate()","                    try:","                        netsniff_process.wait(timeout=5)","                    except:","                        netsniff_process.kill()","                ","                # Wait a bit for file to be fully written","                time.sleep(2)","                ","                # Process captured data"],"tokenizedAddedLines":[1000237,1000238,1000239,99,1000240,1000241,142,1000242,1000243,1000244,1000245,1000246,1000247,1000248,142,1000249,1000250,142,1000251]},{"originalStartLineNumberOneIndexed":286,"originalEndLineNumberExclusiveOneIndexed":287,"modifiedStartLineNumberOneIndexed":305,"modifiedEndLineNumberExclusiveOneIndexed":306,"addedLines":["                "],"tokenizedAddedLines":[142]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}