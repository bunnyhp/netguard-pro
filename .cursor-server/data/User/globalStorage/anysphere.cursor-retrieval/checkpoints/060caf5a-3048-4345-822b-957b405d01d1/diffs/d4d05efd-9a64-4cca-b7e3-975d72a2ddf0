{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"d4d05efd-9a64-4cca-b7e3-975d72a2ddf0","fileSizeBytes":37674,"numLines":973,"diffChanges":[{"originalStartLineNumberOneIndexed":805,"originalEndLineNumberExclusiveOneIndexed":805,"modifiedStartLineNumberOneIndexed":805,"modifiedEndLineNumberExclusiveOneIndexed":849,"addedLines":["","@app.route('/network-topology')","def network_topology():","    \"\"\"Network Topology Visualization\"\"\"","    conn = get_db_connection()","    cursor = conn.cursor()","    ","    # Get all devices","    cursor.execute(\"\"\"","        SELECT ip_address, hostname, device_type, device_category, ","               vendor, mac_address, security_score, last_seen","        FROM devices","        ORDER BY last_seen DESC","    \"\"\")","    devices = [dict(row) for row in cursor.fetchall()]","    ","    # Get recent connections (for topology links)","    connections = []","    try:","        cursor.execute(\"\"\"","            SELECT name FROM sqlite_master ","            WHERE type='table' AND (name LIKE 'tcpdump_%' OR name LIKE 'tshark_%')","            AND name NOT LIKE '%_template'","            ORDER BY name DESC LIMIT 1","        \"\"\")","        table_result = cursor.fetchone()","        ","        if table_result:","            table_name = table_result['name']","            cursor.execute(f\"\"\"","                SELECT DISTINCT src_ip, dest_ip, COUNT(*) as count","                FROM {table_name}","                WHERE src_ip LIKE '192.168.%' AND dest_ip LIKE '192.168.%'","                GROUP BY src_ip, dest_ip","                LIMIT 100","            \"\"\")","            connections = [dict(row) for row in cursor.fetchall()]","    except Exception as e:","        print(f\"Error getting connections: {e}\")","    ","    conn.close()","    ","    return render_template('network_topology.html', devices=devices, connections=connections)",""],"tokenizedAddedLines":[5,1000622,1000623,1000624,22,23,179,1000625,381,1000626,1000627,1000628,502,384,503,179,1000629,1000630,34,1000631,1000632,1000633,1000634,1000635,1000636,1000637,47,1000638,1000639,477,1000640,1000641,1000642,1000643,1000644,418,1000645,53,1000646,179,26,179,1000647,5]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}