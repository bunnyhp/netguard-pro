{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\ai_5min_aggregator.py","fileUuid":"49f4ad71-f44c-40fd-b4ac-fc496c00ea4c","fileSizeBytes":22807,"numLines":580,"diffChanges":[{"originalStartLineNumberOneIndexed":197,"originalEndLineNumberExclusiveOneIndexed":198,"modifiedStartLineNumberOneIndexed":197,"modifiedEndLineNumberExclusiveOneIndexed":198,"addedLines":["                'sample_packets': [dict(row) for row in rows[:10]]"],"tokenizedAddedLines":[125]},{"originalStartLineNumberOneIndexed":208,"originalEndLineNumberExclusiveOneIndexed":209,"modifiedStartLineNumberOneIndexed":208,"modifiedEndLineNumberExclusiveOneIndexed":209,"addedLines":["                'top_connections': [dict(row) for row in rows[:10]]"],"tokenizedAddedLines":[1000380]},{"originalStartLineNumberOneIndexed":245,"originalEndLineNumberExclusiveOneIndexed":245,"modifiedStartLineNumberOneIndexed":245,"modifiedEndLineNumberExclusiveOneIndexed":275,"addedLines":["        # Get HTTP events","        table = get_latest_table(conn, 'suricata_http')","        if table:","            cursor = conn.cursor()","            cursor.execute(f\"SELECT * FROM {table} ORDER BY timestamp DESC LIMIT 20\")","            http_events = cursor.fetchall()","            data['tools']['suricata']['http_events'] = [dict(row) for row in http_events[:5]]","        else:","            data['tools']['suricata']['http_events'] = []","        ","        # Get DNS events","        table = get_latest_table(conn, 'suricata_dns')","        if table:","            cursor = conn.cursor()","            cursor.execute(f\"SELECT * FROM {table} ORDER BY timestamp DESC LIMIT 20\")","            dns_events = cursor.fetchall()","            data['tools']['suricata']['dns_events'] = [dict(row) for row in dns_events[:5]]","        else:","            data['tools']['suricata']['dns_events'] = []","        ","        # Get TLS events","        table = get_latest_table(conn, 'suricata_tls')","        if table:","            cursor = conn.cursor()","            cursor.execute(f\"SELECT * FROM {table} ORDER BY timestamp DESC LIMIT 20\")","            tls_events = cursor.fetchall()","            data['tools']['suricata']['tls_events'] = [dict(row) for row in tls_events[:5]]","        else:","            data['tools']['suricata']['tls_events'] = []","        "],"tokenizedAddedLines":[1000381,1000382,63,64,1000383,1000384,1000385,153,1000386,53,1000387,1000388,63,64,1000383,1000389,1000390,153,1000391,53,1000392,1000393,63,64,1000383,1000394,1000395,153,1000396,53]},{"originalStartLineNumberOneIndexed":287,"originalEndLineNumberExclusiveOneIndexed":287,"modifiedStartLineNumberOneIndexed":317,"modifiedEndLineNumberExclusiveOneIndexed":318,"addedLines":["- Sample Packets: {json.dumps(data['tools'].get('tshark', {}).get('sample_packets', [])[:3], indent=2, default=str)}"],"tokenizedAddedLines":[1000397]},{"originalStartLineNumberOneIndexed":290,"originalEndLineNumberExclusiveOneIndexed":290,"modifiedStartLineNumberOneIndexed":321,"modifiedEndLineNumberExclusiveOneIndexed":322,"addedLines":["- Sample Connections: {json.dumps(data['tools'].get('ngrep', {}).get('tcp_connections', [])[:5], indent=2, default=str)}"],"tokenizedAddedLines":[1000398]},{"originalStartLineNumberOneIndexed":295,"originalEndLineNumberExclusiveOneIndexed":295,"modifiedStartLineNumberOneIndexed":327,"modifiedEndLineNumberExclusiveOneIndexed":328,"addedLines":["- Sample Requests: {json.dumps(data['tools'].get('httpry', {}).get('sample_requests', [])[:3], indent=2, default=str)}"],"tokenizedAddedLines":[1000399]},{"originalStartLineNumberOneIndexed":298,"originalEndLineNumberExclusiveOneIndexed":298,"modifiedStartLineNumberOneIndexed":331,"modifiedEndLineNumberExclusiveOneIndexed":332,"addedLines":["- Sample Packets with Full Details: {json.dumps(data['tools'].get('tcpdump', {}).get('sample_packets', [])[:5], indent=2, default=str)}"],"tokenizedAddedLines":[1000400]},{"originalStartLineNumberOneIndexed":301,"originalEndLineNumberExclusiveOneIndexed":301,"modifiedStartLineNumberOneIndexed":335,"modifiedEndLineNumberExclusiveOneIndexed":336,"addedLines":["- Sample Flows: {json.dumps(data['tools'].get('argus', {}).get('flows', [])[:5], indent=2, default=str)}"],"tokenizedAddedLines":[1000401]},{"originalStartLineNumberOneIndexed":304,"originalEndLineNumberExclusiveOneIndexed":304,"modifiedStartLineNumberOneIndexed":339,"modifiedEndLineNumberExclusiveOneIndexed":340,"addedLines":["- Sample Packets: {json.dumps(data['tools'].get('netsniff', {}).get('sample_packets', [])[:5], indent=2, default=str)}"],"tokenizedAddedLines":[1000402]},{"originalStartLineNumberOneIndexed":307,"originalEndLineNumberExclusiveOneIndexed":307,"modifiedStartLineNumberOneIndexed":343,"modifiedEndLineNumberExclusiveOneIndexed":344,"addedLines":["- Top Bandwidth Users: {json.dumps(data['tools'].get('iftop', {}).get('top_connections', [])[:5], indent=2, default=str)}"],"tokenizedAddedLines":[1000403]},{"originalStartLineNumberOneIndexed":310,"originalEndLineNumberExclusiveOneIndexed":310,"modifiedStartLineNumberOneIndexed":347,"modifiedEndLineNumberExclusiveOneIndexed":348,"addedLines":["- Top Bandwidth Consumers: {json.dumps(data['tools'].get('nethogs', {}).get('top_bandwidth_users', [])[:10], indent=2, default=str)}"],"tokenizedAddedLines":[1000404]},{"originalStartLineNumberOneIndexed":313,"originalEndLineNumberExclusiveOneIndexed":313,"modifiedStartLineNumberOneIndexed":351,"modifiedEndLineNumberExclusiveOneIndexed":352,"addedLines":["- Alert Details: {json.dumps(data['tools'].get('suricata', {}).get('alerts', [])[:5], indent=2, default=str)}"],"tokenizedAddedLines":[1000405]},{"originalStartLineNumberOneIndexed":314,"originalEndLineNumberExclusiveOneIndexed":314,"modifiedStartLineNumberOneIndexed":353,"modifiedEndLineNumberExclusiveOneIndexed":356,"addedLines":["- HTTP Events: {json.dumps(data['tools'].get('suricata', {}).get('http_events', [])[:3], indent=2, default=str)}","- DNS Events: {json.dumps(data['tools'].get('suricata', {}).get('dns_events', [])[:3], indent=2, default=str)}","- TLS Events: {json.dumps(data['tools'].get('suricata', {}).get('tls_events', [])[:3], indent=2, default=str)}"],"tokenizedAddedLines":[1000406,1000407,1000408]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}