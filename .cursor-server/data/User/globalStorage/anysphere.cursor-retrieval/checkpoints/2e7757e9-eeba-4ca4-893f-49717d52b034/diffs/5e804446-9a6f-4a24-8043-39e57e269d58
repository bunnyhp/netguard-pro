{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"5e804446-9a6f-4a24-8043-39e57e269d58","fileSizeBytes":28411,"numLines":716,"diffChanges":[{"originalStartLineNumberOneIndexed":571,"originalEndLineNumberExclusiveOneIndexed":571,"modifiedStartLineNumberOneIndexed":571,"modifiedEndLineNumberExclusiveOneIndexed":578,"addedLines":["    chart_data = {","        'health_history': [],","        'threat_timeline': [],","        'protocol_distribution': {},","        'device_activity': []","    }","    "],"tokenizedAddedLines":[1000437,1000438,1000439,1000440,1000441,191,179]},{"originalStartLineNumberOneIndexed":581,"originalEndLineNumberExclusiveOneIndexed":581,"modifiedStartLineNumberOneIndexed":588,"modifiedEndLineNumberExclusiveOneIndexed":594,"addedLines":["        ","        # Get protocol distribution from network insights","        if analysis_data and analysis_data.get('network_insights'):","            protocols = analysis_data['network_insights'].get('most_active_protocols', [])","            for proto in protocols:","                chart_data['protocol_distribution'][proto] = 1"],"tokenizedAddedLines":[47,1000442,1000443,1000444,1000445,1000446]},{"originalStartLineNumberOneIndexed":591,"originalEndLineNumberExclusiveOneIndexed":591,"modifiedStartLineNumberOneIndexed":604,"modifiedEndLineNumberExclusiveOneIndexed":650,"addedLines":["    # Build chart data from history","    for item in reversed(analysis_history):","        chart_data['health_history'].append({","            'time': item['timestamp'].split(' ')[1][:5] if ' ' in item['timestamp'] else item['timestamp'][:5],","            'score': item['network_health_score']","        })","        chart_data['threat_timeline'].append({","            'time': item['timestamp'].split(' ')[1][:5] if ' ' in item['timestamp'] else item['timestamp'][:5],","            'level': item['threat_level']","        })","    ","    # Get tool statistics","    tool_stats = {}","    try:","        cursor = conn.cursor()","        for tool in ['tshark', 'tcpdump', 'ngrep', 'httpry', 'argus', 'netsniff', 'iftop', 'nethogs']:","            cursor.execute(f\"\"\"","                SELECT name FROM sqlite_master ","                WHERE type='table' AND name LIKE '{tool}_%' ","                AND name NOT LIKE '%_template'","                ORDER BY name DESC LIMIT 1","            \"\"\")","            table = cursor.fetchone()","            if table:","                cursor.execute(f\"SELECT COUNT(*) as count FROM {table['name']}\")","                count_row = cursor.fetchone()","                tool_stats[tool] = count_row['count'] if count_row else 0","        ","        # Suricata events","        suricata_total = 0","        for event_type in ['alerts', 'flow', 'http', 'dns', 'tls']:","            cursor.execute(f\"\"\"","                SELECT name FROM sqlite_master ","                WHERE type='table' AND name LIKE 'suricata_{event_type}_%' ","                AND name NOT LIKE '%_template'","                ORDER BY name DESC LIMIT 1","            \"\"\")","            table = cursor.fetchone()","            if table:","                cursor.execute(f\"SELECT COUNT(*) as count FROM {table['name']}\")","                count_row = cursor.fetchone()","                suricata_total += count_row['count'] if count_row else 0","        tool_stats['suricata'] = suricata_total","    except Exception as e:","        print(f\"Error getting tool stats: {e}\")","    "],"tokenizedAddedLines":[1000447,1000448,1000449,1000450,1000451,212,1000452,1000450,1000453,212,179,1000454,1000455,34,36,1000456,1000457,1000458,1000459,1000460,1000461,1000462,1000463,1000464,1000465,1000466,1000467,47,1000468,1000469,1000470,1000457,1000458,1000471,1000460,1000461,1000462,1000463,1000464,1000465,1000466,1000472,1000473,53,1000474,179]},{"originalStartLineNumberOneIndexed":595,"originalEndLineNumberExclusiveOneIndexed":596,"modifiedStartLineNumberOneIndexed":654,"modifiedEndLineNumberExclusiveOneIndexed":657,"addedLines":["                         history=analysis_history,","                         chart_data=json.dumps(chart_data),","                         tool_stats=tool_stats)"],"tokenizedAddedLines":[1000475,1000476,1000477]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}