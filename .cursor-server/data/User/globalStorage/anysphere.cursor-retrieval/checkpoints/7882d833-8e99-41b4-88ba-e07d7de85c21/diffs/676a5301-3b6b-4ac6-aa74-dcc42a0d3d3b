{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"676a5301-3b6b-4ac6-aa74-dcc42a0d3d3b","fileSizeBytes":25825,"numLines":655,"diffChanges":[{"originalStartLineNumberOneIndexed":558,"originalEndLineNumberExclusiveOneIndexed":559,"modifiedStartLineNumberOneIndexed":558,"modifiedEndLineNumberExclusiveOneIndexed":559,"addedLines":["    \"\"\"AI-powered threat detection dashboard - 5-minute intervals\"\"\""],"tokenizedAddedLines":[1000459]},{"originalStartLineNumberOneIndexed":562,"originalEndLineNumberExclusiveOneIndexed":563,"modifiedStartLineNumberOneIndexed":562,"modifiedEndLineNumberExclusiveOneIndexed":563,"addedLines":["    # Get latest AI analysis"],"tokenizedAddedLines":[1000460]},{"originalStartLineNumberOneIndexed":564,"originalEndLineNumberExclusiveOneIndexed":587,"modifiedStartLineNumberOneIndexed":564,"modifiedEndLineNumberExclusiveOneIndexed":583,"addedLines":["        SELECT * FROM ai_analysis ","        ORDER BY timestamp DESC LIMIT 1","    \"\"\")","    latest_analysis = cursor.fetchone()","    ","    # Parse JSON fields if analysis exists","    analysis_data = None","    if latest_analysis:","        analysis_data = dict(latest_analysis)","        try:","            analysis_data['threats_detected'] = json.loads(analysis_data.get('threats_detected', '[]'))","            analysis_data['network_insights'] = json.loads(analysis_data.get('network_insights', '{}'))","            analysis_data['device_analysis'] = json.loads(analysis_data.get('device_analysis', '{}'))","            analysis_data['http_analysis'] = json.loads(analysis_data.get('http_analysis', '{}'))","            analysis_data['recommendations'] = json.loads(analysis_data.get('recommendations', '[]'))","        except:","            pass","    ","    # Get analysis history (last 12 = 1 hour at 5-min intervals)"],"tokenizedAddedLines":[1000461,1000462,382,1000463,179,1000464,1000465,1000466,1000467,203,1000468,1000469,1000470,1000471,1000472,206,1000473,179,1000474]},{"originalStartLineNumberOneIndexed":588,"originalEndLineNumberExclusiveOneIndexed":609,"modifiedStartLineNumberOneIndexed":584,"modifiedEndLineNumberExclusiveOneIndexed":588,"addedLines":["        SELECT id, timestamp, threat_level, network_health_score, summary ","        FROM ai_analysis ","        ORDER BY timestamp DESC","        LIMIT 12"],"tokenizedAddedLines":[1000475,1000476,1000477,1000478]},{"originalStartLineNumberOneIndexed":611,"originalEndLineNumberExclusiveOneIndexed":619,"modifiedStartLineNumberOneIndexed":590,"modifiedEndLineNumberExclusiveOneIndexed":590},{"originalStartLineNumberOneIndexed":623,"originalEndLineNumberExclusiveOneIndexed":629,"modifiedStartLineNumberOneIndexed":594,"modifiedEndLineNumberExclusiveOneIndexed":596,"addedLines":["                         analysis=analysis_data,","                         history=analysis_history)"],"tokenizedAddedLines":[1000479,1000480]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}