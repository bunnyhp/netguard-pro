{"fsPath":"\\home\\jarvis\\NetGuard\\diagnose_p0f.py","fileUuid":"b163d611-c5d1-42aa-9dbf-27ef37fa921b","fileSizeBytes":2824,"numLines":93,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":94,"addedLines":["#!/usr/bin/env python3","import subprocess","import os","","print(\"=\"*60)","print(\"P0F DIAGNOSTIC\")","print(\"=\"*60)","","# 1. Check if p0f is installed","try:","    result = subprocess.run(['which', 'p0f'], capture_output=True, text=True)","    if result.returncode == 0:","        print(f\"✓ p0f installed at: {result.stdout.strip()}\")","    else:","        print(\"✗ p0f NOT installed\")","        print(\"  Run: sudo apt-get install p0f\")","except Exception as e:","    print(f\"✗ Error checking p0f: {e}\")","","# 2. Check network interfaces","print(\"\\nAvailable network interfaces:\")","try:","    result = subprocess.run(['ip', 'link', 'show'], capture_output=True, text=True)","    for line in result.stdout.split('\\n'):","        if ':' in line and not line.startswith(' '):","            print(f\"  {line}\")","except:","    pass","","# 3. Check if p0f process is running","print(\"\\nRunning p0f processes:\")","try:","    result = subprocess.run(['pgrep', '-a', 'p0f'], capture_output=True, text=True)","    if result.returncode == 0:","        print(result.stdout)","    else:","        print(\"  ✗ No p0f process running\")","except:","    pass","","# 4. Check p0f log file","print(\"\\np0f log file:\")","log_path = \"/home/jarvis/NetGuard/captures/p0f/p0f.log\"","if os.path.exists(log_path):","    size = os.path.getsize(log_path)","    print(f\"  Exists: {log_path}\")","    print(f\"  Size: {size} bytes\")","    if size > 0:","        with open(log_path, 'r') as f:","            print(\"  Last 5 lines:\")","            lines = f.readlines()","            for line in lines[-5:]:","                print(f\"    {line.strip()}\")","    else:","        print(\"  ✗ File is EMPTY (p0f not capturing)\")","else:","    print(f\"  ✗ Does not exist: {log_path}\")","","# 5. Check p0f collector status","print(\"\\np0f collector service:\")","try:","    result = subprocess.run(['systemctl', 'is-active', 'p0f-collector'], capture_output=True, text=True)","    status = result.stdout.strip()","    print(f\"  Status: {status}\")","except:","    pass","","# 6. Test p0f manually","print(\"\\nTesting p0f on wlo1 (5 second capture)...\")","print(\"  Command: sudo timeout 5 p0f -i wlo1\")","try:","    result = subprocess.run(['sudo', 'timeout', '5', 'p0f', '-i', 'wlo1'], ","                          capture_output=True, text=True)","    if result.stdout:","        print(\"  ✓ p0f CAN capture on wlo1\")","        print(f\"  Sample output:\\n{result.stdout[:500]}\")","    else:","        print(\"  ✗ No output from p0f\")","    if result.stderr:","        print(f\"  Errors: {result.stderr}\")","except Exception as e:","    print(f\"  ✗ Error: {e}\")","","print(\"\\n\" + \"=\"*60)","print(\"RECOMMENDATIONS:\")","print(\"=\"*60)","print(\"1. If p0f not installed: sudo apt-get install p0f\")","print(\"2. If wlo1 doesn't exist: Check 'ip link show' and use correct interface\")","print(\"3. Restart service: sudo systemctl restart p0f-collector\")","print(\"4. Check logs: tail -f /home/jarvis/NetGuard/logs/system/p0f-service-error.log\")","print(\"=\"*60)","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000005,1000004,1000003,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000013,1000014,1000015,1000003,1000016,1000017,1000007,1000018,1000019,1000020,1000021,1000022,1000023,1000003,1000024,1000025,1000007,1000026,1000009,1000027,1000011,1000028,1000022,1000023,1000003,1000029,1000030,1000031,1000032,1000033,1000034,1000035,1000036,1000037,1000038,1000039,1000040,1000041,1000011,1000042,1000043,1000044,1000003,1000045,1000046,1000007,1000047,1000048,1000049,1000022,1000023,1000003,1000050,1000051,1000052,1000007,1000053,1000054,1000055,1000056,1000057,1000011,1000058,1000059,1000060,1000014,1000061,1000003,1000062,1000063,1000004,1000064,1000065,1000066,1000067,1000004,1000003,1000003]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}