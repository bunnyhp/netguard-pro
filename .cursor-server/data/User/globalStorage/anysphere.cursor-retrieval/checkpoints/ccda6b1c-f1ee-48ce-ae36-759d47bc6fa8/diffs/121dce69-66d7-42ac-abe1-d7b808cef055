{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\device_tracker.py","fileUuid":"121dce69-66d7-42ac-abe1-d7b808cef055","fileSizeBytes":16024,"numLines":431,"diffChanges":[{"originalStartLineNumberOneIndexed":206,"originalEndLineNumberExclusiveOneIndexed":207,"modifiedStartLineNumberOneIndexed":206,"modifiedEndLineNumberExclusiveOneIndexed":207,"addedLines":["        # IoT Devices - Smart Home"],"tokenizedAddedLines":[1000303]},{"originalStartLineNumberOneIndexed":210,"originalEndLineNumberExclusiveOneIndexed":210,"modifiedStartLineNumberOneIndexed":210,"modifiedEndLineNumberExclusiveOneIndexed":211,"addedLines":["        # IoT - Cameras"],"tokenizedAddedLines":[1000304]},{"originalStartLineNumberOneIndexed":213,"originalEndLineNumberExclusiveOneIndexed":213,"modifiedStartLineNumberOneIndexed":214,"modifiedEndLineNumberExclusiveOneIndexed":215,"addedLines":["        # IoT - Thermostats/Climate Control"],"tokenizedAddedLines":[1000305]},{"originalStartLineNumberOneIndexed":216,"originalEndLineNumberExclusiveOneIndexed":216,"modifiedStartLineNumberOneIndexed":218,"modifiedEndLineNumberExclusiveOneIndexed":219,"addedLines":["        # IoT - Smart TVs and streaming devices"],"tokenizedAddedLines":[1000306]},{"originalStartLineNumberOneIndexed":222,"originalEndLineNumberExclusiveOneIndexed":222,"modifiedStartLineNumberOneIndexed":225,"modifiedEndLineNumberExclusiveOneIndexed":226,"addedLines":["        # IoT - Printers"],"tokenizedAddedLines":[1000307]},{"originalStartLineNumberOneIndexed":225,"originalEndLineNumberExclusiveOneIndexed":225,"modifiedStartLineNumberOneIndexed":229,"modifiedEndLineNumberExclusiveOneIndexed":230,"addedLines":["        # IoT - Smart Lights"],"tokenizedAddedLines":[1000308]},{"originalStartLineNumberOneIndexed":228,"originalEndLineNumberExclusiveOneIndexed":229,"modifiedStartLineNumberOneIndexed":233,"modifiedEndLineNumberExclusiveOneIndexed":238,"addedLines":["        # IoT - Tablets (many Lenovo/Samsung tabs are IoT-like)","        if any(x in hostname_lower for x in ['tab-', 'tablet', 'lenovo-tab', 'samsung-tab', 'kindle-fire']):","            return \"IoT\", \"Tablet Device\"","        ","        # Network Equipment (Router is the gateway)"],"tokenizedAddedLines":[1000309,1000310,1000311,127,1000312]},{"originalStartLineNumberOneIndexed":232,"originalEndLineNumberExclusiveOneIndexed":233,"modifiedStartLineNumberOneIndexed":241,"modifiedEndLineNumberExclusiveOneIndexed":242,"addedLines":["        if any(x in hostname_lower for x in ['router', 'gateway', 'modem', 'switch', 'ap', 'access-point', 'sbe1v1k']):"],"tokenizedAddedLines":[1000313]},{"originalStartLineNumberOneIndexed":247,"originalEndLineNumberExclusiveOneIndexed":248,"modifiedStartLineNumberOneIndexed":256,"modifiedEndLineNumberExclusiveOneIndexed":257,"addedLines":["        # Mobile Devices (iPhones/iPads)"],"tokenizedAddedLines":[1000314]},{"originalStartLineNumberOneIndexed":255,"originalEndLineNumberExclusiveOneIndexed":258,"modifiedStartLineNumberOneIndexed":264,"modifiedEndLineNumberExclusiveOneIndexed":267,"addedLines":["        # Raspberry Pi (treat as IoT since it's likely running sensors/automation)","        if 'raspberry pi' in vendor_lower or any(x in hostname_lower for x in ['raspberrypi', 'raspberry', 'pi.lan', 'pi-']):","            return \"IoT\", \"Raspberry Pi\""],"tokenizedAddedLines":[1000315,1000316,1000317]},{"originalStartLineNumberOneIndexed":288,"originalEndLineNumberExclusiveOneIndexed":291,"modifiedStartLineNumberOneIndexed":297,"modifiedEndLineNumberExclusiveOneIndexed":299,"addedLines":["            # Check if device exists by IP","            cursor.execute(\"SELECT * FROM devices WHERE ip_address = ?\", (ip_address,))"],"tokenizedAddedLines":[1000318,275]},{"originalStartLineNumberOneIndexed":297,"originalEndLineNumberExclusiveOneIndexed":298,"modifiedStartLineNumberOneIndexed":305,"modifiedEndLineNumberExclusiveOneIndexed":311,"addedLines":["                    SET mac_address = COALESCE(?, mac_address),","                        hostname = COALESCE(?, hostname),","                        vendor = ?,","                        device_type = ?,","                        device_category = ?,","                        last_seen = ?,"],"tokenizedAddedLines":[1000319,1000320,1000321,1000322,1000323,1000324]},{"originalStartLineNumberOneIndexed":300,"originalEndLineNumberExclusiveOneIndexed":302,"modifiedStartLineNumberOneIndexed":313,"modifiedEndLineNumberExclusiveOneIndexed":316,"addedLines":["                    WHERE ip_address = ?","                \"\"\", (mac_address, hostname, vendor, device_type, device_category, ","                      now, traffic_bytes, ip_address))"],"tokenizedAddedLines":[1000325,1000326,1000327]},{"originalStartLineNumberOneIndexed":303,"originalEndLineNumberExclusiveOneIndexed":304,"modifiedStartLineNumberOneIndexed":317,"modifiedEndLineNumberExclusiveOneIndexed":318,"addedLines":["                # Insert new device (with or without MAC)"],"tokenizedAddedLines":[1000328]},{"originalStartLineNumberOneIndexed":313,"originalEndLineNumberExclusiveOneIndexed":314,"modifiedStartLineNumberOneIndexed":327,"modifiedEndLineNumberExclusiveOneIndexed":328,"addedLines":["                logging.info(f\"âœ“ New device discovered: {ip_address} {f'({vendor})' if vendor != 'Unknown' else ''} - {device_category}\")"],"tokenizedAddedLines":[1000329]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}