{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"58c4328f-107d-44aa-90bc-e9f420f04706","fileSizeBytes":49100,"numLines":1292,"diffChanges":[{"originalStartLineNumberOneIndexed":249,"originalEndLineNumberExclusiveOneIndexed":249,"modifiedStartLineNumberOneIndexed":249,"modifiedEndLineNumberExclusiveOneIndexed":250,"addedLines":["    try:"],"tokenizedAddedLines":[34]},{"originalStartLineNumberOneIndexed":256,"originalEndLineNumberExclusiveOneIndexed":256,"modifiedStartLineNumberOneIndexed":257,"modifiedEndLineNumberExclusiveOneIndexed":262,"addedLines":["        total_devices = 0","        device_types = {}","        recent_devices = []","        ","        try:"],"tokenizedAddedLines":[1000805,1000806,1000807,47,270]},{"originalStartLineNumberOneIndexed":262,"originalEndLineNumberExclusiveOneIndexed":262,"modifiedStartLineNumberOneIndexed":268,"modifiedEndLineNumberExclusiveOneIndexed":269,"addedLines":["                WHERE device_type IS NOT NULL"],"tokenizedAddedLines":[1000808]},{"originalStartLineNumberOneIndexed":273,"originalEndLineNumberExclusiveOneIndexed":273,"modifiedStartLineNumberOneIndexed":280,"modifiedEndLineNumberExclusiveOneIndexed":282,"addedLines":["        except Exception as e:","            print(f\"Device data error: {e}\")"],"tokenizedAddedLines":[521,1000809]},{"originalStartLineNumberOneIndexed":278,"originalEndLineNumberExclusiveOneIndexed":278,"modifiedStartLineNumberOneIndexed":287,"modifiedEndLineNumberExclusiveOneIndexed":288,"addedLines":["        try:"],"tokenizedAddedLines":[270]},{"originalStartLineNumberOneIndexed":285,"originalEndLineNumberExclusiveOneIndexed":286,"modifiedStartLineNumberOneIndexed":295,"modifiedEndLineNumberExclusiveOneIndexed":296,"addedLines":["                cursor.execute(f\"SELECT protocol, COUNT(*) as count FROM {latest_tcpdump} WHERE protocol IS NOT NULL GROUP BY protocol\")"],"tokenizedAddedLines":[1000810]},{"originalStartLineNumberOneIndexed":287,"originalEndLineNumberExclusiveOneIndexed":287,"modifiedStartLineNumberOneIndexed":297,"modifiedEndLineNumberExclusiveOneIndexed":299,"addedLines":["        except Exception as e:","            print(f\"Traffic data error: {e}\")"],"tokenizedAddedLines":[521,1000811]},{"originalStartLineNumberOneIndexed":289,"originalEndLineNumberExclusiveOneIndexed":289,"modifiedStartLineNumberOneIndexed":301,"modifiedEndLineNumberExclusiveOneIndexed":303,"addedLines":["        iot_vulns = 0","        try:"],"tokenizedAddedLines":[1000812,270]},{"originalStartLineNumberOneIndexed":291,"originalEndLineNumberExclusiveOneIndexed":291,"modifiedStartLineNumberOneIndexed":305,"modifiedEndLineNumberExclusiveOneIndexed":307,"addedLines":["        except Exception as e:","            print(f\"IoT vulnerabilities error: {e}\")"],"tokenizedAddedLines":[521,1000813]},{"originalStartLineNumberOneIndexed":293,"originalEndLineNumberExclusiveOneIndexed":293,"modifiedStartLineNumberOneIndexed":309,"modifiedEndLineNumberExclusiveOneIndexed":311,"addedLines":["        ai_data = {'threat_level': 'UNKNOWN', 'health_score': 0, 'last_analysis': 'Never'}","        try:"],"tokenizedAddedLines":[219,270]},{"originalStartLineNumberOneIndexed":306,"originalEndLineNumberExclusiveOneIndexed":308,"modifiedStartLineNumberOneIndexed":324,"modifiedEndLineNumberExclusiveOneIndexed":326,"addedLines":["        except Exception as e:","            print(f\"AI analysis error: {e}\")"],"tokenizedAddedLines":[521,1000814]},{"originalStartLineNumberOneIndexed":311,"originalEndLineNumberExclusiveOneIndexed":321,"modifiedStartLineNumberOneIndexed":329,"modifiedEndLineNumberExclusiveOneIndexed":339,"addedLines":["            'p0f': len([t for t in all_tables if t.startswith('p0f_') and not t.endswith('_template')]),","            'tshark': len([t for t in all_tables if t.startswith('tshark_') and not t.endswith('_template')]),","            'tcpdump': len([t for t in all_tables if t.startswith('tcpdump_') and not t.endswith('_template')]),","            'suricata': len([t for t in all_tables if t.startswith('suricata_') and not t.endswith('_template')]),","            'ngrep': len([t for t in all_tables if t.startswith('ngrep_') and not t.endswith('_template')]),","            'httpry': len([t for t in all_tables if t.startswith('httpry_') and not t.endswith('_template')]),","            'argus': len([t for t in all_tables if t.startswith('argus_') and not t.endswith('_template')]),","            'netsniff': len([t for t in all_tables if t.startswith('netsniff_') and not t.endswith('_template')]),","            'iftop': len([t for t in all_tables if t.startswith('iftop_') and not t.endswith('_template')]),","            'nethogs': len([t for t in all_tables if t.startswith('nethogs_') and not t.endswith('_template')])"],"tokenizedAddedLines":[1000815,1000816,1000817,1000818,1000819,1000820,1000821,1000822,1000823,1000824]},{"originalStartLineNumberOneIndexed":327,"originalEndLineNumberExclusiveOneIndexed":327,"modifiedStartLineNumberOneIndexed":345,"modifiedEndLineNumberExclusiveOneIndexed":347,"addedLines":["        try:","            tcpdump_tables = [t for t in all_tables if t.startswith('tcpdump_') and not t.endswith('_template')]"],"tokenizedAddedLines":[270,1000825]},{"originalStartLineNumberOneIndexed":328,"originalEndLineNumberExclusiveOneIndexed":328,"modifiedStartLineNumberOneIndexed":348,"modifiedEndLineNumberExclusiveOneIndexed":349,"addedLines":["                latest_tcpdump = sorted(tcpdump_tables)[-1]"],"tokenizedAddedLines":[1000826]},{"originalStartLineNumberOneIndexed":337,"originalEndLineNumberExclusiveOneIndexed":337,"modifiedStartLineNumberOneIndexed":358,"modifiedEndLineNumberExclusiveOneIndexed":360,"addedLines":["        except Exception as e:","            print(f\"Top talkers error: {e}\")"],"tokenizedAddedLines":[521,1000827]},{"originalStartLineNumberOneIndexed":357,"originalEndLineNumberExclusiveOneIndexed":357,"modifiedStartLineNumberOneIndexed":380,"modifiedEndLineNumberExclusiveOneIndexed":400,"addedLines":["    ","    except Exception as e:","        print(f\"Critical error in index route: {e}\")","        import traceback","        traceback.print_exc()","        # Return a safe default","        return render_template('index.html', data={","            'total_devices': 0,","            'device_types': {},","            'recent_devices': [],","            'total_packets': 0,","            'protocol_distribution': {},","            'iot_vulnerabilities': 0,","            'ai_analysis': {'threat_level': 'UNKNOWN', 'health_score': 0, 'last_analysis': 'Never'},","            'active_services': 0,","            'total_services': 10,","            'services': {},","            'top_talkers': [],","            'last_updated': datetime.now().strftime('%Y-%m-%d %H:%M:%S')","        })"],"tokenizedAddedLines":[178,53,1000828,1000829,1000830,1000831,1000832,1000833,1000834,1000835,60,1000836,1000837,1000838,1000839,1000840,1000841,1000842,1000843,279]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}