{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"6a6e5ac6-44dc-4a78-96f2-732ca1da68c4","fileSizeBytes":94984,"numLines":2417,"diffChanges":[{"originalStartLineNumberOneIndexed":1044,"originalEndLineNumberExclusiveOneIndexed":1044,"modifiedStartLineNumberOneIndexed":1044,"modifiedEndLineNumberExclusiveOneIndexed":1076,"addedLines":["        # Get domain patterns data for the template","        domain_patterns = []","        try:","            cursor.execute(\"\"\"","                SELECT dp.device_ip, d.hostname, dp.domain, dp.frequency, ","                       dp.first_seen, dp.last_seen, dp.risk_level","                FROM iot_domain_patterns dp","                LEFT JOIN devices d ON dp.device_ip = d.ip_address","                ORDER BY dp.frequency DESC, dp.risk_level ASC","                LIMIT 20","            \"\"\")","            ","            for row in cursor.fetchall():","                device_info = dict(row)","                device_name = f\"{device_info['hostname'] or device_info['device_ip'] or 'Unknown Device'}\"","                ","                # Map risk levels to text","                risk_levels = {0: 'Safe', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'}","                risk_text = risk_levels.get(device_info['risk_level'], 'Unknown')","                ","                domain_patterns.append({","                    'device': device_name,","                    'domain': device_info['domain'],","                    'frequency': device_info['frequency'],","                    'firstSeen': device_info['first_seen'].split(' ')[0] if device_info['first_seen'] else 'Unknown',","                    'lastSeen': device_info['last_seen'],","                    'riskLevel': risk_text","                })","        except Exception as e:","            print(f\"Error getting domain patterns: {e}\")","            domain_patterns = []","        "],"tokenizedAddedLines":[1001478,1001479,184,188,1001480,1001481,743,744,745,746,193,187,747,748,1001482,82,750,751,752,82,1001483,754,755,756,757,758,759,760,199,1001484,1001485,47]},{"originalStartLineNumberOneIndexed":1045,"originalEndLineNumberExclusiveOneIndexed":1046,"modifiedStartLineNumberOneIndexed":1077,"modifiedEndLineNumberExclusiveOneIndexed":1078,"addedLines":["        return render_template('iot_devices.html', devices=devices, domain_patterns=domain_patterns)"],"tokenizedAddedLines":[1001486]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}