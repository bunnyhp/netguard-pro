{"fsPath":"\\home\\jarvis\\NetGuard\\web\\templates\\analysis_tool.html","fileUuid":"f2963f95-9b1d-4e89-bcb4-ee56a7798f71","fileSizeBytes":16528,"numLines":432,"diffChanges":[{"originalStartLineNumberOneIndexed":19,"originalEndLineNumberExclusiveOneIndexed":19,"modifiedStartLineNumberOneIndexed":19,"modifiedEndLineNumberExclusiveOneIndexed":205,"addedLines":["","<!-- Enhanced Statistics Dashboard (tshark only) -->","{% if stats %}","<div class=\"row mb-4\">","    <!-- Total Packets -->","    <div class=\"col-md-3 mb-3\">","        <div class=\"card bg-gradient\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\">","            <div class=\"card-body text-white\">","                <h6 class=\"text-white-50\">Total Packets</h6>","                <h2 class=\"mb-0\">{{ \"{:,}\".format(stats.total_packets) }}</h2>","            </div>","        </div>","    </div>","    ","    <!-- Protocol Count -->","    <div class=\"col-md-3 mb-3\">","        <div class=\"card bg-gradient\" style=\"background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\">","            <div class=\"card-body text-white\">","                <h6 class=\"text-white-50\">Protocols Detected</h6>","                <h2 class=\"mb-0\">{{ stats.protocols|length }}</h2>","            </div>","        </div>","    </div>","    ","    <!-- Unique IPs -->","    <div class=\"col-md-3 mb-3\">","        <div class=\"card bg-gradient\" style=\"background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\">","            <div class=\"card-body text-white\">","                <h6 class=\"text-white-50\">Unique Source IPs</h6>","                <h2 class=\"mb-0\">{{ stats.top_sources|length }}</h2>","            </div>","        </div>","    </div>","    ","    <!-- Suspicious Activity -->","    <div class=\"col-md-3 mb-3\">","        <div class=\"card bg-gradient\" style=\"background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\">","            <div class=\"card-body text-white\">","                <h6 class=\"text-white-50\">Suspicious Patterns</h6>","                <h2 class=\"mb-0\">{{ stats.suspicious_activity|length }}</h2>","            </div>","        </div>","    </div>","</div>","","<!-- Charts Row -->","<div class=\"row mb-4\">","    <!-- Protocol Distribution Chart -->","    <div class=\"col-md-6 mb-3\">","        <div class=\"card\">","            <div class=\"card-header\">","                <h5 class=\"mb-0\">üìä Protocol Distribution</h5>","            </div>","            <div class=\"card-body\">","                <canvas id=\"protocolChart\" height=\"200\"></canvas>","            </div>","        </div>","    </div>","    ","    <!-- Packet Size Distribution -->","    <div class=\"col-md-6 mb-3\">","        <div class=\"card\">","            <div class=\"card-header\">","                <h5 class=\"mb-0\">üì¶ Packet Size Distribution</h5>","            </div>","            <div class=\"card-body\">","                <canvas id=\"packetSizeChart\" height=\"200\"></canvas>","            </div>","        </div>","    </div>","</div>","","<!-- Top IPs and Ports -->","<div class=\"row mb-4\">","    <!-- Top Source IPs -->","    <div class=\"col-md-4 mb-3\">","        <div class=\"card\">","            <div class=\"card-header\">","                <h5 class=\"mb-0\">üåê Top Source IPs</h5>","            </div>","            <div class=\"card-body\" style=\"max-height: 300px; overflow-y: auto;\">","                <ul class=\"list-group list-group-flush\">","                    {% for ip, count in stats.top_sources.items() %}","                    <li class=\"list-group-item d-flex justify-content-between align-items-center\">","                        <code>{{ ip }}</code>","                        <span class=\"badge bg-primary rounded-pill\">{{ count }}</span>","                    </li>","                    {% endfor %}","                </ul>","            </div>","        </div>","    </div>","    ","    <!-- Top Destination IPs -->","    <div class=\"col-md-4 mb-3\">","        <div class=\"card\">","            <div class=\"card-header\">","                <h5 class=\"mb-0\">üéØ Top Destination IPs</h5>","            </div>","            <div class=\"card-body\" style=\"max-height: 300px; overflow-y: auto;\">","                <ul class=\"list-group list-group-flush\">","                    {% for ip, count in stats.top_destinations.items() %}","                    <li class=\"list-group-item d-flex justify-content-between align-items-center\">","                        <code>{{ ip }}</code>","                        <span class=\"badge bg-success rounded-pill\">{{ count }}</span>","                    </li>","                    {% endfor %}","                </ul>","            </div>","        </div>","    </div>","    ","    <!-- Top Ports -->","    <div class=\"col-md-4 mb-3\">","        <div class=\"card\">","            <div class=\"card-header\">","                <h5 class=\"mb-0\">üîå Top Destination Ports</h5>","            </div>","            <div class=\"card-body\" style=\"max-height: 300px; overflow-y: auto;\">","                <ul class=\"list-group list-group-flush\">","                    {% for port, count in stats.port_activity.items() %}","                    <li class=\"list-group-item d-flex justify-content-between align-items-center\">","                        <span>","                            <strong>{{ port }}</strong>","                            {% if port == 80 %}<small class=\"text-muted\">(HTTP)</small>","                            {% elif port == 443 %}<small class=\"text-muted\">(HTTPS)</small>","                            {% elif port == 53 %}<small class=\"text-muted\">(DNS)</small>","                            {% elif port == 22 %}<small class=\"text-muted\">(SSH)</small>","                            {% elif port == 21 %}<small class=\"text-muted\">(FTP)</small>","                            {% elif port == 25 %}<small class=\"text-muted\">(SMTP)</small>","                            {% elif port == 3306 %}<small class=\"text-muted\">(MySQL)</small>","                            {% elif port == 3389 %}<small class=\"text-muted\">(RDP)</small>","                            {% endif %}","                        </span>","                        <span class=\"badge bg-info rounded-pill\">{{ count }}</span>","                    </li>","                    {% endfor %}","                </ul>","            </div>","        </div>","    </div>","</div>","","<!-- Suspicious Activity Alerts -->","{% if stats.suspicious_activity %}","<div class=\"row mb-4\">","    <div class=\"col-12\">","        <div class=\"card border-warning\">","            <div class=\"card-header bg-warning text-dark\">","                <h5 class=\"mb-0\">‚ö†Ô∏è Suspicious Activity Detected</h5>","            </div>","            <div class=\"card-body\">","                <div class=\"table-responsive\">","                    <table class=\"table table-sm\">","                        <thead>","                            <tr>","                                <th>Type</th>","                                <th>Details</th>","                                <th>Severity</th>","                            </tr>","                        </thead>","                        <tbody>","                            {% for alert in stats.suspicious_activity %}","                            <tr>","                                <td><strong>{{ alert.type }}</strong></td>","                                <td>{{ alert.detail }}</td>","                                <td>","                                    {% if alert.severity == 'high' %}","                                    <span class=\"badge bg-danger\">High</span>","                                    {% elif alert.severity == 'medium' %}","                                    <span class=\"badge bg-warning\">Medium</span>","                                    {% else %}","                                    <span class=\"badge bg-info\">Low</span>","                                    {% endif %}","                                </td>","                            </tr>","                            {% endfor %}","                        </tbody>","                    </table>","                </div>","            </div>","        </div>","    </div>","</div>","{% endif %}","{% endif %}"],"tokenizedAddedLines":[2,1000086,1000087,5,1000088,1000089,1000090,1000091,1000092,1000093,10,14,15,77,1000094,1000089,1000095,1000091,1000096,1000097,10,14,15,77,1000098,1000089,1000099,1000091,1000100,1000101,10,14,15,77,1000102,1000089,1000103,1000091,1000104,1000105,10,14,15,16,2,1000106,5,1000107,1000108,7,8,1000109,10,11,1000110,10,14,15,77,1000111,1000108,7,8,1000112,10,11,1000113,10,14,15,16,2,1000114,5,1000115,1000116,7,8,1000117,10,1000118,1000119,1000120,1000121,1000122,1000123,1000124,1000125,1000126,10,14,15,77,1000127,1000116,7,8,1000128,10,1000118,1000119,1000129,1000121,1000122,1000130,1000124,1000125,1000126,10,14,15,77,1000131,1000116,7,8,1000132,10,1000118,1000119,1000133,1000121,1000134,1000135,1000136,1000137,1000138,1000139,1000140,1000141,1000142,1000143,1000144,1000145,1000146,1000124,1000125,1000126,10,14,15,16,2,1000147,1000148,5,6,1000149,1000150,1000151,10,11,20,1000152,22,23,1000153,1000154,1000155,27,28,29,1000156,23,1000157,1000158,55,1000159,1000160,1000161,1000162,62,1000163,64,65,27,34,35,36,37,10,14,15,16,67,67]},{"originalStartLineNumberOneIndexed":109,"originalEndLineNumberExclusiveOneIndexed":109,"modifiedStartLineNumberOneIndexed":295,"modifiedEndLineNumberExclusiveOneIndexed":298,"addedLines":["<!-- Chart.js -->","<script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js\"></script>",""],"tokenizedAddedLines":[1000164,1000165,2]},{"originalStartLineNumberOneIndexed":125,"originalEndLineNumberExclusiveOneIndexed":125,"modifiedStartLineNumberOneIndexed":314,"modifiedEndLineNumberExclusiveOneIndexed":428,"addedLines":["    ","    {% if stats %}","    // Protocol Distribution Pie Chart","    const protocolCtx = document.getElementById('protocolChart');","    if (protocolCtx) {","        new Chart(protocolCtx, {","            type: 'doughnut',","            data: {","                labels: {{ stats.protocols.keys()|list|tojson }},","                datasets: [{","                    label: 'Packets',","                    data: {{ stats.protocols.values()|list|tojson }},","                    backgroundColor: [","                        'rgba(102, 126, 234, 0.8)',","                        'rgba(118, 75, 162, 0.8)',","                        'rgba(240, 147, 251, 0.8)',","                        'rgba(245, 87, 108, 0.8)',","                        'rgba(79, 172, 254, 0.8)',","                        'rgba(0, 242, 254, 0.8)',","                        'rgba(250, 112, 154, 0.8)',","                        'rgba(254, 225, 64, 0.8)',","                        'rgba(67, 233, 123, 0.8)',","                        'rgba(56, 178, 172, 0.8)'","                    ],","                    borderWidth: 2,","                    borderColor: '#fff'","                }]","            },","            options: {","                responsive: true,","                maintainAspectRatio: false,","                plugins: {","                    legend: {","                        position: 'right',","                        labels: {","                            padding: 15,","                            font: { size: 12 }","                        }","                    },","                    title: {","                        display: false","                    },","                    tooltip: {","                        callbacks: {","                            label: function(context) {","                                let label = context.label || '';","                                let value = context.parsed || 0;","                                let total = context.dataset.data.reduce((a, b) => a + b, 0);","                                let percentage = ((value / total) * 100).toFixed(1);","                                return label + ': ' + value.toLocaleString() + ' (' + percentage + '%)';","                            }","                        }","                    }","                }","            }","        });","    }","    ","    // Packet Size Distribution Bar Chart","    const packetSizeCtx = document.getElementById('packetSizeChart');","    if (packetSizeCtx) {","        new Chart(packetSizeCtx, {","            type: 'bar',","            data: {","                labels: ['Small (‚â§100)', 'Medium (101-500)', 'Large (>500)'],","                datasets: [{","                    label: 'Packet Count',","                    data: [","                        {{ stats.packet_sizes.small }},","                        {{ stats.packet_sizes.medium }},","                        {{ stats.packet_sizes.large }}","                    ],","                    backgroundColor: [","                        'rgba(79, 172, 254, 0.8)',","                        'rgba(102, 126, 234, 0.8)',","                        'rgba(118, 75, 162, 0.8)'","                    ],","                    borderColor: [","                        'rgba(79, 172, 254, 1)',","                        'rgba(102, 126, 234, 1)',","                        'rgba(118, 75, 162, 1)'","                    ],","                    borderWidth: 2","                }]","            },","            options: {","                responsive: true,","                maintainAspectRatio: false,","                scales: {","                    y: {","                        beginAtZero: true,","                        ticks: {","                            callback: function(value) {","                                return value.toLocaleString();","                            }","                        }","                    }","                },","                plugins: {","                    legend: {","                        display: false","                    },","                    tooltip: {","                        callbacks: {","                            label: function(context) {","                                return 'Packets: ' + context.parsed.y.toLocaleString();","                            }","                        }","                    }","                }","            }","        });","    }","    {% endif %}"],"tokenizedAddedLines":[77,1000166,1000167,1000168,1000169,1000170,1000171,1000172,1000173,1000174,1000175,1000176,1000177,1000178,1000179,1000180,1000181,1000182,1000183,1000184,1000185,1000186,1000187,1000188,1000189,1000190,1000191,1000192,1000193,1000194,1000195,1000196,1000197,1000198,1000199,1000200,1000201,1000202,1000203,1000204,1000205,1000203,1000206,1000207,1000208,1000209,1000210,1000211,1000212,1000213,1000214,1000202,1000215,1000216,1000217,1000218,1000219,77,1000220,1000221,1000222,1000223,1000224,1000172,1000225,1000174,1000226,1000227,1000228,1000229,1000230,1000188,1000177,1000182,1000178,1000231,1000188,1000232,1000233,1000234,1000235,1000188,1000236,1000191,1000192,1000193,1000194,1000195,1000237,1000238,1000239,1000240,1000241,1000242,1000214,1000202,1000215,1000243,1000196,1000197,1000205,1000203,1000206,1000207,1000208,1000244,1000214,1000202,1000215,1000216,1000217,1000218,1000219,84]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}