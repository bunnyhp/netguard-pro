{"fsPath":"\\home\\jarvis\\NetGuard\\TEST_CHART_FIX.html","fileUuid":"ebe49ef7-618c-4248-b72e-bea6af48a42a","fileSizeBytes":8585,"numLines":197,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":198,"addedLines":["<!DOCTYPE html>","<html>","<head>","    <title>Chart Fix Test</title>","    <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>","    <style>","        body { background: #1a1a1a; color: white; font-family: Arial; }","        .container { max-width: 800px; margin: 20px auto; padding: 20px; }","        .chart-container { width: 100%; height: 300px; margin: 20px 0; }","        button { background: #007bff; color: white; border: none; padding: 10px 20px; margin: 10px; cursor: pointer; border-radius: 4px; }","        button:hover { background: #0056b3; }","        .stats { display: flex; justify-content: space-around; margin: 20px 0; }","        .stat { text-align: center; padding: 10px; background: #2a2a2a; border-radius: 4px; }","    </style>","</head>","<body>","    <div class=\"container\">","        <h1>Network Traffic Chart Test</h1>","        ","        <div class=\"stats\">","            <div class=\"stat\">","                <div>Total Traffic</div>","                <div id=\"total-traffic\">0 MB</div>","            </div>","            <div class=\"stat\">","                <div>Peak Rate</div>","                <div id=\"peak-rate\">0 Mbps</div>","            </div>","            <div class=\"stat\">","                <div>Suspicious</div>","                <div id=\"suspicious-traffic\">0</div>","            </div>","            <div class=\"stat\">","                <div>Encrypted</div>","                <div id=\"encrypted-traffic\">0%</div>","            </div>","        </div>","        ","        <div class=\"chart-container\">","            <canvas id=\"trafficChart\"></canvas>","        </div>","        ","        <button onclick=\"loadTrafficData()\">Load Traffic Data</button>","        <button onclick=\"initializeTrafficChart()\">Recreate Chart</button>","        <button onclick=\"testChartUpdate()\">Test Chart Update</button>","        ","        <div id=\"debug-log\" style=\"background: #000; padding: 10px; margin-top: 20px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;\"></div>","    </div>","","    <script>","        let trafficChart;","        ","        function log(message) {","            const debugLog = document.getElementById('debug-log');","            const timestamp = new Date().toLocaleTimeString();","            debugLog.innerHTML += `[${timestamp}] ${message}<br>`;","            debugLog.scrollTop = debugLog.scrollHeight;","            console.log(message);","        }","        ","        function initializeTrafficChart() {","            log('Initializing traffic chart...');","            const trafficCtx = document.getElementById('trafficChart');","            if (!trafficCtx) {","                log('ERROR: trafficChart canvas element not found!');","                return;","            }","            ","            // Destroy existing chart if it exists","            if (trafficChart) {","                trafficChart.destroy();","                log('Destroyed existing chart');","            }","            ","            trafficChart = new Chart(trafficCtx.getContext('2d'), {","                type: 'bar',","                data: {","                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],","                    datasets: [{","                        label: 'Normal Traffic',","                        data: [0, 0, 0, 0, 0, 0, 0],","                        backgroundColor: '#4caf50'","                    }, {","                        label: 'Suspicious Traffic',","                        data: [0, 0, 0, 0, 0, 0, 0],","                        backgroundColor: '#f44336'","                    }]","                },","                options: {","                    responsive: true,","                    maintainAspectRatio: false,","                    plugins: {","                        legend: {","                            labels: { color: '#fff' }","                        }","                    },","                    scales: {","                        x: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.1)' }},","                        y: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.1)' }}","                    }","                }","            });","            log('Traffic chart initialized successfully');","        }","        ","        function loadTrafficData() {","            log('Loading traffic data...');","            fetch('/api/network-traffic-stats')","                .then(response => {","                    log(`API response: ${response.status}`);","                    return response.json();","                })","                .then(data => {","                    log(`Data received: ${JSON.stringify(data)}`);","                    ","                    // Update stats","                    document.getElementById('total-traffic').textContent = data.total_traffic_mb + ' MB';","                    document.getElementById('peak-rate').textContent = data.peak_rate_mbps + ' Mbps';","                    document.getElementById('suspicious-traffic').textContent = data.suspicious_count;","                    document.getElementById('encrypted-traffic').textContent = data.encrypted_percentage + '%';","                    ","                    log('Stats updated');","                    ","                    // Update chart","                    if (trafficChart) {","                        log('Updating chart...');","                        const baseTraffic = Math.max(1, data.total_traffic_mb / 7);","                        const baseSuspicious = Math.max(0, data.suspicious_count / 7);","                        ","                        const normalData = [","                            Math.round(baseTraffic * (0.8 + Math.random() * 0.4)),","                            Math.round(baseTraffic * (0.9 + Math.random() * 0.4)),","                            Math.round(baseTraffic * (1.0 + Math.random() * 0.4)),","                            Math.round(baseTraffic * (1.1 + Math.random() * 0.4)),","                            Math.round(baseTraffic * (0.7 + Math.random() * 0.4)),","                            Math.round(baseTraffic * (0.6 + Math.random() * 0.4)),","                            Math.round(baseTraffic * (0.8 + Math.random() * 0.4))","                        ];","                        ","                        const suspiciousData = [","                            Math.round(baseSuspicious * (0.5 + Math.random() * 1.0)),","                            Math.round(baseSuspicious * (0.8 + Math.random() * 1.0)),","                            Math.round(baseSuspicious * (0.3 + Math.random() * 1.0)),","                            Math.round(baseSuspicious * (1.2 + Math.random() * 1.0)),","                            Math.round(baseSuspicious * (0.4 + Math.random() * 1.0)),","                            Math.round(baseSuspicious * (0.2 + Math.random() * 1.0)),","                            Math.round(baseSuspicious * (0.6 + Math.random() * 1.0))","                        ];","                        ","                        log(`Normal data: ${normalData}`);","                        log(`Suspicious data: ${suspiciousData}`);","                        ","                        trafficChart.data.datasets[0].data = normalData;","                        trafficChart.data.datasets[1].data = suspiciousData;","                        ","                        try {","                            trafficChart.update('active');","                            log('Chart updated with animation');","                        } catch (e) {","                            log('Animation failed, trying simple update');","                            trafficChart.update();","                        }","                        ","                        log('Chart update complete');","                    } else {","                        log('ERROR: trafficChart is not defined!');","                    }","                })","                .catch(error => {","                    log(`ERROR: ${error.message}`);","                });","        }","        ","        function testChartUpdate() {","            log('Testing chart update with sample data...');","            if (trafficChart) {","                trafficChart.data.datasets[0].data = [10, 15, 8, 12, 6, 9, 11];","                trafficChart.data.datasets[1].data = [2, 1, 3, 1, 2, 1, 2];","                trafficChart.update();","                log('Test data applied to chart');","            } else {","                log('ERROR: Chart not initialized');","            }","        }","        ","        // Initialize when page loads","        document.addEventListener('DOMContentLoaded', function() {","            log('Page loaded, initializing...');","            initializeTrafficChart();","            setTimeout(() => {","                loadTrafficData();","            }, 1000);","        });","    </script>","</body>","</html>",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000013,1000014,1000015,1000016,1000017,1000018,1000019,1000020,1000021,1000022,1000023,1000020,1000024,1000025,1000023,1000020,1000026,1000027,1000023,1000020,1000028,1000029,1000023,1000030,1000018,1000031,1000032,1000030,1000018,1000033,1000034,1000035,1000018,1000036,1000037,1000038,1000039,1000040,1000018,1000041,1000042,1000043,1000044,1000045,1000046,1000047,1000018,1000048,1000049,1000050,1000051,1000052,1000053,1000054,1000055,1000056,1000057,1000058,1000059,1000054,1000055,1000060,1000061,1000062,1000063,1000064,1000065,1000066,1000067,1000068,1000069,1000066,1000070,1000071,1000072,1000073,1000074,1000075,1000076,1000077,1000078,1000079,1000080,1000081,1000082,1000083,1000084,1000085,1000086,1000087,1000047,1000018,1000088,1000089,1000090,1000091,1000092,1000093,1000094,1000095,1000096,1000097,1000098,1000099,1000100,1000101,1000102,1000097,1000103,1000097,1000104,1000105,1000106,1000107,1000108,1000109,1000110,1000111,1000112,1000113,1000114,1000115,1000116,1000117,1000118,1000109,1000119,1000120,1000121,1000122,1000123,1000124,1000125,1000126,1000118,1000109,1000127,1000128,1000109,1000129,1000130,1000109,1000131,1000132,1000133,1000134,1000135,1000136,1000079,1000109,1000137,1000138,1000139,1000084,1000094,1000140,1000141,1000142,1000047,1000018,1000143,1000144,1000057,1000145,1000146,1000147,1000148,1000149,1000150,1000054,1000047,1000018,1000151,1000152,1000153,1000154,1000155,1000156,1000157,1000158,1000159,1000160,1000161,1000038]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}