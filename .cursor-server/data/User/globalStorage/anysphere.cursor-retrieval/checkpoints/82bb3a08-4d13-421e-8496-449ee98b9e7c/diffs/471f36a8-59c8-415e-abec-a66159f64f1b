{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\p0f_collector.py","fileUuid":"471f36a8-59c8-415e-abec-a66159f64f1b","fileSizeBytes":9883,"numLines":315,"diffChanges":[{"originalStartLineNumberOneIndexed":16,"originalEndLineNumberExclusiveOneIndexed":17,"modifiedStartLineNumberOneIndexed":16,"modifiedEndLineNumberExclusiveOneIndexed":17,"addedLines":["INTERFACE = \"eno1\"  # Changed to Ethernet for better p0f fingerprinting"],"tokenizedAddedLines":[1000229]},{"originalStartLineNumberOneIndexed":164,"originalEndLineNumberExclusiveOneIndexed":164,"modifiedStartLineNumberOneIndexed":164,"modifiedEndLineNumberExclusiveOneIndexed":165,"addedLines":["            logging.debug(\"p0f log file doesn't exist yet\")"],"tokenizedAddedLines":[1000230]},{"originalStartLineNumberOneIndexed":175,"originalEndLineNumberExclusiveOneIndexed":175,"modifiedStartLineNumberOneIndexed":176,"modifiedEndLineNumberExclusiveOneIndexed":178,"addedLines":["        logging.info(f\"Read {len(new_lines)} new lines from position {last_pos}\")","        "],"tokenizedAddedLines":[1000231,76]},{"originalStartLineNumberOneIndexed":178,"originalEndLineNumberExclusiveOneIndexed":179,"modifiedStartLineNumberOneIndexed":181,"modifiedEndLineNumberExclusiveOneIndexed":182,"addedLines":["        # Parse entries (new p0f format: [timestamp] mod=type|cli=ip/port|srv=ip/port|...)"],"tokenizedAddedLines":[1000232]},{"originalStartLineNumberOneIndexed":180,"originalEndLineNumberExclusiveOneIndexed":181,"modifiedStartLineNumberOneIndexed":183,"modifiedEndLineNumberExclusiveOneIndexed":183},{"originalStartLineNumberOneIndexed":184,"originalEndLineNumberExclusiveOneIndexed":199,"modifiedStartLineNumberOneIndexed":186,"modifiedEndLineNumberExclusiveOneIndexed":228,"addedLines":["            if not line or not line.startswith('['):","                continue","            ","            # Parse new p0f line format","            entry = {'timestamp': datetime.now().isoformat()}","            ","            # Extract timestamp [2025/10/11 02:41:49]","            timestamp_match = re.search(r'\\[([^\\]]+)\\]', line)","            if timestamp_match:","                entry['log_timestamp'] = timestamp_match.group(1)","            ","            # Extract client IP and port: cli=IP/PORT","            cli_match = re.search(r'cli=([^/|]+)/(\\d+)', line)","            if cli_match:","                entry['src_ip'] = cli_match.group(1)","                entry['src_port'] = int(cli_match.group(2))","            ","            # Extract server IP and port: srv=IP/PORT","            srv_match = re.search(r'srv=([^/|]+)/(\\d+)', line)","            if srv_match:","                entry['dest_ip'] = srv_match.group(1)","                entry['dest_port'] = int(srv_match.group(2))","            ","            # Extract OS info: os=NAME","            os_match = re.search(r'os=([^|]+)', line)","            if os_match:","                os_info = os_match.group(1).strip()","                if os_info and os_info != '???':","                    entry['os_name'] = os_info","            ","            # Extract distance: dist=NUM","            dist_match = re.search(r'dist=(\\d+)', line)","            if dist_match:","                entry['distance'] = int(dist_match.group(1))","            ","            # Extract link type: link=TYPE","            link_match = re.search(r'link=([^|]+)', line)","            if link_match:","                entry['link_type'] = link_match.group(1).strip()","            ","            if 'src_ip' in entry:","                entries.append(entry)"],"tokenizedAddedLines":[1000233,199,96,1000234,1000235,96,1000236,1000237,1000238,1000239,96,1000240,1000241,1000242,1000243,1000244,96,1000245,1000246,1000247,1000248,1000249,96,1000250,1000251,1000252,1000253,1000254,1000255,96,1000256,1000257,1000258,1000259,96,1000260,1000261,1000262,1000263,96,1000264,1000265]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}