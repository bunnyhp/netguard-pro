{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"ccdc6e58-1f45-481b-8127-5961c2839543","fileSizeBytes":22320,"numLines":552,"diffChanges":[{"originalStartLineNumberOneIndexed":173,"originalEndLineNumberExclusiveOneIndexed":175,"modifiedStartLineNumberOneIndexed":173,"modifiedEndLineNumberExclusiveOneIndexed":176,"addedLines":["                # 1. FIXED: High port backdoor detection - only flag INCOMING connections to same high port","                # Multiple external sources connecting to YOUR high port = backdoor","                cursor.execute(f\"SELECT dest_port, COUNT(DISTINCT src_ip) as unique_sources, COUNT(*) as total FROM {table} WHERE dest_port > 50000 AND src_ip NOT LIKE '192.168.%' GROUP BY dest_port HAVING unique_sources > 3\")"],"tokenizedAddedLines":[1000374,1000375,1000376]},{"originalStartLineNumberOneIndexed":177,"originalEndLineNumberExclusiveOneIndexed":179,"modifiedStartLineNumberOneIndexed":178,"modifiedEndLineNumberExclusiveOneIndexed":180,"addedLines":["                        'type': 'Potential Backdoor Detected',","                        'detail': f'Port {row[0]}: {row[1]} different external IPs connecting ({row[2]} total connections)',"],"tokenizedAddedLines":[1000377,1000378]},{"originalStartLineNumberOneIndexed":182,"originalEndLineNumberExclusiveOneIndexed":186,"modifiedStartLineNumberOneIndexed":183,"modifiedEndLineNumberExclusiveOneIndexed":186,"addedLines":["                # 2. FIXED: Port scan detection - outbound SYN to many different ports","                cursor.execute(f\"SELECT src_ip, COUNT(DISTINCT dest_port) as unique_ports, COUNT(*) as total FROM {table} WHERE tcp_syn = 1 AND tcp_ack = 0 AND dest_ip NOT LIKE '192.168.%' GROUP BY src_ip HAVING unique_ports > 20\")","                for row in cursor.fetchall():"],"tokenizedAddedLines":[1000379,1000380,77]},{"originalStartLineNumberOneIndexed":188,"originalEndLineNumberExclusiveOneIndexed":189,"modifiedStartLineNumberOneIndexed":188,"modifiedEndLineNumberExclusiveOneIndexed":189,"addedLines":["                        'detail': f'Source {row[0]} scanning {row[1]} different ports ({row[2]} SYN attempts)',"],"tokenizedAddedLines":[1000381]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}