{"fsPath":"\\home\\jarvis\\NetGuard\\scripts\\tshark_collector.py","fileUuid":"7e348d17-dd05-4146-9fe4-e270fce8bbe5","fileSizeBytes":14289,"numLines":357,"diffChanges":[{"originalStartLineNumberOneIndexed":261,"originalEndLineNumberExclusiveOneIndexed":261,"modifiedStartLineNumberOneIndexed":261,"modifiedEndLineNumberExclusiveOneIndexed":262,"addedLines":["                # FIXED: Smarter detection to reduce false positives"],"tokenizedAddedLines":[1000291]},{"originalStartLineNumberOneIndexed":264,"originalEndLineNumberExclusiveOneIndexed":266,"modifiedStartLineNumberOneIndexed":265,"modifiedEndLineNumberExclusiveOneIndexed":279,"addedLines":["                # Get your local IP to differentiate inbound vs outbound","                local_ip = '192.168.1.244'  # Your wlo1 IP","                ","                # High ports on DESTINATION = suspicious ONLY if it's NOT your outbound connection","                # Real backdoors: External IP connecting TO your high ports","                # False positive: You connecting FROM your high ports to external servers","                if dest_port and dest_port > 50000 and src_ip and src_ip != local_ip:","                    # External source trying to connect to high dest port = REAL THREAT","                    threat_score += 5","                    is_suspicious = 1","                ","                # SYN without ACK = port scan attempt","                if tcp_syn and not tcp_ack and dest_ip and not dest_ip.startswith('192.168.'):","                    # Scanning external IPs = suspicious"],"tokenizedAddedLines":[1000292,1000293,164,1000294,1000295,1000296,1000297,1000298,1000299,233,164,1000300,1000301,1000302]},{"originalStartLineNumberOneIndexed":269,"originalEndLineNumberExclusiveOneIndexed":271,"modifiedStartLineNumberOneIndexed":282,"modifiedEndLineNumberExclusiveOneIndexed":284,"addedLines":["                # RST flags from external sources = potential attack","                if tcp_rst and src_ip and not src_ip.startswith('192.168.'):"],"tokenizedAddedLines":[1000303,1000304]},{"originalStartLineNumberOneIndexed":273,"originalEndLineNumberExclusiveOneIndexed":280,"modifiedStartLineNumberOneIndexed":286,"modifiedEndLineNumberExclusiveOneIndexed":289,"addedLines":["                # Low TTL = potential IP spoofing (but skip local traffic)","                if ip_ttl and ip_ttl < 32 and dest_ip and not dest_ip.startswith(('192.168.', '224.', '239.')):","                    threat_score += 4"],"tokenizedAddedLines":[1000305,1000306,1000307]},{"originalStartLineNumberOneIndexed":282,"originalEndLineNumberExclusiveOneIndexed":285,"modifiedStartLineNumberOneIndexed":291,"modifiedEndLineNumberExclusiveOneIndexed":294,"addedLines":["                # Very small TCP window from external = potential attack","                if tcp_window_size and tcp_window_size < 1000 and src_ip and not src_ip.startswith('192.168.'):","                    threat_score += 2"],"tokenizedAddedLines":[1000308,1000309,236]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}