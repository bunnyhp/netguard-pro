{"fsPath":"\\home\\jarvis\\NetGuard\\web\\app.py","fileUuid":"1cbca99c-8b09-44d4-b5e4-e1b0d2ffc0e2","fileSizeBytes":84348,"numLines":2113,"diffChanges":[{"originalStartLineNumberOneIndexed":997,"originalEndLineNumberExclusiveOneIndexed":998,"modifiedStartLineNumberOneIndexed":997,"modifiedEndLineNumberExclusiveOneIndexed":998,"addedLines":["    \"\"\"Enhanced IoT Devices Dashboard\"\"\""],"tokenizedAddedLines":[1001305]},{"originalStartLineNumberOneIndexed":1001,"originalEndLineNumberExclusiveOneIndexed":1002,"modifiedStartLineNumberOneIndexed":1001,"modifiedEndLineNumberExclusiveOneIndexed":1002,"addedLines":["    # Get all IoT devices with enhanced data"],"tokenizedAddedLines":[1001306]},{"originalStartLineNumberOneIndexed":1003,"originalEndLineNumberExclusiveOneIndexed":1025,"modifiedStartLineNumberOneIndexed":1003,"modifiedEndLineNumberExclusiveOneIndexed":1031,"addedLines":["        SELECT DISTINCT ","            d.*,","            COUNT(v.id) as vulnerability_count,","            MAX(v.severity) as max_vulnerability_severity,","            COALESCE(s.overall_score, 50) as security_score,","            COUNT(c.id) as communication_count,","            COUNT(b.id) as behavioral_entries","        FROM devices d","        LEFT JOIN iot_vulnerabilities v ON d.ip_address = v.device_ip AND v.resolved = 0","        LEFT JOIN iot_security_scores s ON d.ip_address = s.device_ip","        LEFT JOIN iot_communications c ON d.ip_address = c.device_ip AND c.timestamp > datetime('now', '-1 hour')","        LEFT JOIN iot_behavioral_data b ON d.ip_address = b.device_ip AND b.timestamp > datetime('now', '-1 hour')","        WHERE (","            d.device_type = 'IoT' OR","            d.device_category LIKE '%camera%' OR","            d.device_category LIKE '%tv%' OR","            d.device_category LIKE '%speaker%' OR","            d.device_category LIKE '%thermostat%' OR","            d.device_category LIKE '%plug%' OR","            d.device_category LIKE '%sensor%' OR","            d.vendor IN ('Amazon', 'Google', 'Samsung', 'LG', 'Sony', 'TP-Link', 'Belkin', 'Netgear', 'D-Link')","        )","        AND d.last_seen > datetime('now', '-24 hours')","        GROUP BY d.ip_address","        ORDER BY d.last_seen DESC","    \"\"\")","    ","    devices = []"],"tokenizedAddedLines":[1001307,1001308,1001309,1001310,1001311,1001312,1001313,735,756,1001314,1001315,1001316,1001317,1001318,1001319,1001320,1001321,1001322,1001323,1001324,1001325,988,1001326,1001327,1001328,571,342,1001329]},{"originalStartLineNumberOneIndexed":1026,"originalEndLineNumberExclusiveOneIndexed":1035,"modifiedStartLineNumberOneIndexed":1032,"modifiedEndLineNumberExclusiveOneIndexed":1039,"addedLines":["        device = dict(row)","        device['vulnerabilities'] = {","            'count': device['vulnerability_count'],","            'max_severity': device['max_vulnerability_severity'] or 0","        }","        device['total_packets'] = device.get('communication_count', 0)","        devices.append(device)"],"tokenizedAddedLines":[1001330,1001331,1001332,1001333,72,1001334,1001335]},{"originalStartLineNumberOneIndexed":1068,"originalEndLineNumberExclusiveOneIndexed":1069,"modifiedStartLineNumberOneIndexed":1072,"modifiedEndLineNumberExclusiveOneIndexed":1073,"addedLines":["    \"\"\"Get real domain communication patterns for IoT devices\"\"\""],"tokenizedAddedLines":[1001336]},{"originalStartLineNumberOneIndexed":1072,"originalEndLineNumberExclusiveOneIndexed":1073,"modifiedStartLineNumberOneIndexed":1076,"modifiedEndLineNumberExclusiveOneIndexed":1077,"addedLines":["    # Get real domain communications from iot_domain_patterns table"],"tokenizedAddedLines":[1001337]},{"originalStartLineNumberOneIndexed":1075,"originalEndLineNumberExclusiveOneIndexed":1076,"modifiedStartLineNumberOneIndexed":1079,"modifiedEndLineNumberExclusiveOneIndexed":1080,"addedLines":["            dp.device_ip,"],"tokenizedAddedLines":[1001338]},{"originalStartLineNumberOneIndexed":1078,"originalEndLineNumberExclusiveOneIndexed":1086,"modifiedStartLineNumberOneIndexed":1082,"modifiedEndLineNumberExclusiveOneIndexed":1093,"addedLines":["            dp.domain,","            dp.frequency,","            dp.first_seen,","            dp.last_seen,","            dp.risk_level,","            dp.analysis_notes","        FROM iot_domain_patterns dp","        JOIN devices d ON dp.device_ip = d.ip_address","        WHERE dp.timestamp > datetime('now', '-24 hours')","        ORDER BY dp.frequency DESC, dp.risk_level ASC","        LIMIT 20"],"tokenizedAddedLines":[1001339,1001340,1001341,1001342,1001343,1001344,1001345,1001346,1001347,1001348,1001349]},{"originalStartLineNumberOneIndexed":1091,"originalEndLineNumberExclusiveOneIndexed":1092,"modifiedStartLineNumberOneIndexed":1098,"modifiedEndLineNumberExclusiveOneIndexed":1103,"addedLines":["        device_name = f\"{device_info['hostname'] or device_info['device_category']} ({device_info['device_ip']})\"","        ","        # Map risk levels to text","        risk_levels = {0: 'Safe', 1: 'Low', 2: 'Medium', 3: 'High', 4: 'Critical'}","        risk_text = risk_levels.get(device_info['risk_level'], 'Unknown')"],"tokenizedAddedLines":[1001350,47,1001351,1001352,1001353]},{"originalStartLineNumberOneIndexed":1108,"originalEndLineNumberExclusiveOneIndexed":1109,"modifiedStartLineNumberOneIndexed":1119,"modifiedEndLineNumberExclusiveOneIndexed":1120,"addedLines":["    \"\"\"Get real-time security statistics for IoT devices\"\"\""],"tokenizedAddedLines":[1001354]},{"originalStartLineNumberOneIndexed":1112,"originalEndLineNumberExclusiveOneIndexed":1116,"modifiedStartLineNumberOneIndexed":1123,"modifiedEndLineNumberExclusiveOneIndexed":1142,"addedLines":["    # Get total IoT devices (enhanced detection)","    cursor.execute(\"\"\"","        SELECT COUNT(*) as total_devices","        FROM devices d","        WHERE (","            d.device_type = 'IoT' OR","            d.device_category LIKE '%camera%' OR","            d.device_category LIKE '%tv%' OR","            d.device_category LIKE '%speaker%' OR","            d.device_category LIKE '%thermostat%' OR","            d.device_category LIKE '%plug%' OR","            d.device_category LIKE '%sensor%' OR","            d.vendor IN ('Amazon', 'Google', 'Samsung', 'LG', 'Sony', 'TP-Link', 'Belkin', 'Netgear', 'D-Link')","        )","        AND d.last_seen > datetime('now', '-24 hours')","    \"\"\")","    total_devices = cursor.fetchone()['total_devices']","    ","    # Get secure devices (no vulnerabilities)"],"tokenizedAddedLines":[1001355,568,1001356,735,1001317,1001318,1001319,1001320,1001321,1001322,1001323,1001324,1001325,988,1001326,571,1001357,342,1001358]},{"originalStartLineNumberOneIndexed":1117,"originalEndLineNumberExclusiveOneIndexed":1118,"modifiedStartLineNumberOneIndexed":1143,"modifiedEndLineNumberExclusiveOneIndexed":1145,"addedLines":["        SELECT COUNT(DISTINCT d.ip_address) as secure_devices","        FROM devices d"],"tokenizedAddedLines":[1001359,735]},{"originalStartLineNumberOneIndexed":1119,"originalEndLineNumberExclusiveOneIndexed":1123,"modifiedStartLineNumberOneIndexed":1146,"modifiedEndLineNumberExclusiveOneIndexed":1162,"addedLines":["        WHERE (","            d.device_type = 'IoT' OR","            d.device_category LIKE '%camera%' OR","            d.device_category LIKE '%tv%' OR","            d.device_category LIKE '%speaker%' OR","            d.device_category LIKE '%thermostat%' OR","            d.device_category LIKE '%plug%' OR","            d.device_category LIKE '%sensor%' OR","            d.vendor IN ('Amazon', 'Google', 'Samsung', 'LG', 'Sony', 'TP-Link', 'Belkin', 'Netgear', 'D-Link')","        )","        AND d.last_seen > datetime('now', '-24 hours')","        AND v.id IS NULL","    \"\"\")","    secure_devices = cursor.fetchone()['secure_devices']","    ","    # Get vulnerable devices"],"tokenizedAddedLines":[1001317,1001318,1001319,1001320,1001321,1001322,1001323,1001324,1001325,988,1001326,1001360,571,1001361,342,1001362]},{"originalStartLineNumberOneIndexed":1124,"originalEndLineNumberExclusiveOneIndexed":1129,"modifiedStartLineNumberOneIndexed":1163,"modifiedEndLineNumberExclusiveOneIndexed":1187,"addedLines":["        SELECT COUNT(DISTINCT d.ip_address) as vulnerable_devices","        FROM devices d","        JOIN iot_vulnerabilities v ON d.ip_address = v.device_ip AND v.resolved = 0","        WHERE (","            d.device_type = 'IoT' OR","            d.device_category LIKE '%camera%' OR","            d.device_category LIKE '%tv%' OR","            d.device_category LIKE '%speaker%' OR","            d.device_category LIKE '%thermostat%' OR","            d.device_category LIKE '%plug%' OR","            d.device_category LIKE '%sensor%' OR","            d.vendor IN ('Amazon', 'Google', 'Samsung', 'LG', 'Sony', 'TP-Link', 'Belkin', 'Netgear', 'D-Link')","        )","        AND d.last_seen > datetime('now', '-24 hours')","    \"\"\")","    vulnerable_devices = cursor.fetchone()['vulnerable_devices']","    ","    # Get domains tracked","    cursor.execute(\"SELECT COUNT(DISTINCT domain) as domains_tracked FROM iot_domain_patterns\")","    domains_tracked = cursor.fetchone()['domains_tracked']","    ","    # Get active alerts","    cursor.execute(\"SELECT COUNT(*) as active_alerts FROM iot_security_alerts WHERE status = 'active'\")","    active_alerts = cursor.fetchone()['active_alerts']"],"tokenizedAddedLines":[1001363,735,1001364,1001317,1001318,1001319,1001320,1001321,1001322,1001323,1001324,1001325,988,1001326,571,1001365,342,1001366,1001367,1001368,342,1001369,1001370,1001371]},{"originalStartLineNumberOneIndexed":1133,"originalEndLineNumberExclusiveOneIndexed":1136,"modifiedStartLineNumberOneIndexed":1191,"modifiedEndLineNumberExclusiveOneIndexed":1197,"addedLines":["        'totalDevices': total_devices,","        'secureDevices': secure_devices,","        'vulnerableDevices': vulnerable_devices,","        'monitoringDevices': total_devices,","        'domainsTracked': domains_tracked,","        'activeAlerts': active_alerts,"],"tokenizedAddedLines":[1001372,1001373,1001374,1001375,1001376,1001377]},{"originalStartLineNumberOneIndexed":1765,"originalEndLineNumberExclusiveOneIndexed":1766,"modifiedStartLineNumberOneIndexed":1826,"modifiedEndLineNumberExclusiveOneIndexed":1827,"addedLines":["        {'name': 'Enhanced IoT Security Scanner', 'description': 'Advanced IoT security monitoring', 'icon': 'üîê', 'script': 'enhanced_iot_security_scanner.py'},"],"tokenizedAddedLines":[1001378]},{"originalStartLineNumberOneIndexed":1851,"originalEndLineNumberExclusiveOneIndexed":1853,"modifiedStartLineNumberOneIndexed":1912,"modifiedEndLineNumberExclusiveOneIndexed":1914,"addedLines":["            'name': 'enhanced-iot-security-scanner',","            'description': 'Enhanced IoT security monitoring service',"],"tokenizedAddedLines":[1001379,1001380]},{"originalStartLineNumberOneIndexed":1854,"originalEndLineNumberExclusiveOneIndexed":1855,"modifiedStartLineNumberOneIndexed":1915,"modifiedEndLineNumberExclusiveOneIndexed":1916,"addedLines":["            'service': 'enhanced-iot-security-scanner'"],"tokenizedAddedLines":[1001381]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}