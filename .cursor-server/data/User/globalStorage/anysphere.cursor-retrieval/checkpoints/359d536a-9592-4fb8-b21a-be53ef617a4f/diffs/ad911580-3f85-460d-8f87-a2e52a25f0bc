{"fsPath":"\\home\\jarvis\\NetGuard\\web\\templates\\iot_devices.html","fileUuid":"ad911580-3f85-460d-8f87-a2e52a25f0bc","fileSizeBytes":13992,"numLines":292,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":293,"addedLines":["{% extends \"base.html\" %}","","{% block title %}IoT Devices - NetGuard Pro{% endblock %}","","{% block content %}","<div class=\"row mb-4\">","    <div class=\"col-12\">","        <div class=\"card\" style=\"border: 2px solid var(--primary-color);\">","            <div class=\"card-header\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff;\">","                <h4 class=\"mb-0\">","                    <i class=\"fas fa-microchip\"></i> IoT Device Security Dashboard","                </h4>","            </div>","            <div class=\"card-body\">","                <p class=\"mb-0\" style=\"color: var(--text-secondary);\">","                    Monitor and secure all IoT devices on your network. Track vulnerabilities, security scores, and device activity.","                </p>","            </div>","        </div>","    </div>","</div>","","<!-- Statistics Row -->","<div class=\"row mb-4\">","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-microchip\"></i> Total IoT Devices</div>","            <div class=\"stat-number\">{{ devices|length }}</div>","        </div>","    </div>","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-shield-alt\" style=\"color: #4caf50;\"></i> Secure Devices</div>","            <div class=\"stat-number\">{{ devices|selectattr('vulnerabilities.count', 'equalto', 0)|list|length }}</div>","        </div>","    </div>","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-exclamation-triangle\" style=\"color: #ff9800;\"></i> Vulnerable Devices</div>","            <div class=\"stat-number\" style=\"color: #ff9800;\">{{ devices|selectattr('vulnerabilities.count', 'greaterthan', 0)|list|length }}</div>","        </div>","    </div>","    <div class=\"col-md-3\">","        <div class=\"stat-card text-center\">","            <div class=\"stat-label\"><i class=\"fas fa-chart-line\"></i> Avg Security Score</div>","            <div class=\"stat-number\">{{ (devices|map(attribute='security_score')|sum / devices|length)|round(0)|int if devices else 0 }}</div>","        </div>","    </div>","</div>","","{% if devices %}","<!-- IoT Devices Grid -->","<div class=\"row\">","    {% for device in devices %}","    <div class=\"col-md-6 col-lg-4 mb-4\">","        <div class=\"card h-100\" style=\"border-left: 4px solid {% if device.vulnerabilities.count == 0 %}#4caf50{% elif device.vulnerabilities.max_severity >= 3 %}#f44336{% else %}#ff9800{% endif %};\">","            <div class=\"card-body\">","                <!-- Device Header -->","                <div class=\"d-flex justify-content-between align-items-start mb-3\">","                    <div>","                        <h5 class=\"card-title mb-1\" style=\"color: #fff;\">","                            <i class=\"fas fa-{{ ","                                'camera' if 'camera' in device.device_category|lower","                                else 'tv' if 'tv' in device.device_category|lower","                                else 'lightbulb' if 'light' in device.device_category|lower","                                else 'speaker' if 'speaker' in device.device_category|lower","                                else 'thermometer-half' if 'thermostat' in device.device_category|lower","                                else 'plug' if 'plug' in device.device_category|lower","                                else 'microchip'","                            }}\"></i>","                            {{ device.hostname or device.ip_address }}","                        </h5>","                        <div style=\"font-size: 0.85rem; color: var(--text-secondary);\">","                            {{ device.device_category }}","                        </div>","                    </div>","                    <div class=\"text-end\">","                        <div style=\"font-size: 1.5rem; font-weight: 700; color: {% if device.security_score >= 80 %}#4caf50{% elif device.security_score >= 50 %}#ff9800{% else %}#f44336{% endif %};\">","                            {{ device.security_score }}","                        </div>","                        <div style=\"font-size: 0.75rem; color: var(--text-secondary);\">Security</div>","                    </div>","                </div>","","                <!-- Device Info -->","                <div class=\"mb-3\" style=\"border-top: 1px solid var(--border-color); padding-top: 15px;\">","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">IP Address:</span>","                        <span style=\"color: #fff; font-size: 0.85rem; font-family: monospace;\">{{ device.ip_address }}</span>","                    </div>","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">MAC Address:</span>","                        <span style=\"color: #fff; font-size: 0.85rem; font-family: monospace;\">{{ device.mac_address }}</span>","                    </div>","                    <div class=\"d-flex justify-content-between mb-2\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Vendor:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\">{{ device.vendor }}</span>","                    </div>","                    <div class=\"d-flex justify-content-between\">","                        <span style=\"color: var(--text-secondary); font-size: 0.85rem;\">Last Seen:</span>","                        <span style=\"color: #fff; font-size: 0.85rem;\">{{ device.last_seen.split(' ')[1][:5] if ' ' in device.last_seen else device.last_seen[:5] }}</span>","                    </div>","                </div>","","                <!-- Vulnerability Status -->","                {% if device.vulnerabilities.count > 0 %}","                <div class=\"alert alert-{% if device.vulnerabilities.max_severity >= 3 %}danger{% else %}warning{% endif %} mb-0\" style=\"padding: 10px;\">","                    <div class=\"d-flex justify-content-between align-items-center\">","                        <div>","                            <i class=\"fas fa-exclamation-triangle\"></i>","                            <strong>{{ device.vulnerabilities.count }}</strong> ","                            {{ 'Vulnerability' if device.vulnerabilities.count == 1 else 'Vulnerabilities' }}","                        </div>","                        <button class=\"btn btn-sm btn-{% if device.vulnerabilities.max_severity >= 3 %}danger{% else %}warning{% endif %}\" ","                                onclick=\"showVulnerabilities('{{ device.ip_address }}')\">","                            <i class=\"fas fa-eye\"></i> View","                        </button>","                    </div>","                </div>","                {% else %}","                <div class=\"alert alert-success mb-0\" style=\"padding: 10px;\">","                    <i class=\"fas fa-check-circle\"></i> No vulnerabilities detected","                </div>","                {% endif %}","","                <!-- Activity Stats -->","                <div class=\"mt-3\" style=\"border-top: 1px solid var(--border-color); padding-top: 10px;\">","                    <div class=\"row text-center\">","                        <div class=\"col-6\">","                            <div style=\"color: var(--text-secondary); font-size: 0.75rem;\">Packets</div>","                            <div style=\"color: #fff; font-weight: 600; font-size: 0.95rem;\">{{ device.total_packets|default(0) }}</div>","                        </div>","                        <div class=\"col-6\">","                            <div style=\"color: var(--text-secondary); font-size: 0.75rem;\">Data</div>","                            <div style=\"color: #fff; font-weight: 600; font-size: 0.95rem;\">","                                {% if device.total_bytes|default(0) > 1073741824 %}","                                    {{ (device.total_bytes / 1073741824)|round(1) }} GB","                                {% elif device.total_bytes|default(0) > 1048576 %}","                                    {{ (device.total_bytes / 1048576)|round(1) }} MB","                                {% elif device.total_bytes|default(0) > 1024 %}","                                    {{ (device.total_bytes / 1024)|round(1) }} KB","                                {% else %}","                                    {{ device.total_bytes|default(0) }} B","                                {% endif %}","                            </div>","                        </div>","                    </div>","                </div>","            </div>","        </div>","    </div>","    {% endfor %}","</div>","{% else %}","<!-- No Devices Found -->","<div class=\"row\">","    <div class=\"col-12\">","        <div class=\"card\">","            <div class=\"card-body text-center py-5\">","                <i class=\"fas fa-microchip\" style=\"font-size: 4rem; color: var(--text-secondary); opacity: 0.3;\"></i>","                <h3 class=\"mt-3\" style=\"color: #fff;\">No IoT Devices Found</h3>","                <p style=\"color: var(--text-secondary);\">","                    The device tracker hasn't identified any IoT devices yet.<br>","                    IoT devices will appear here automatically as they're discovered on your network.","                </p>","            </div>","        </div>","    </div>","</div>","{% endif %}","","<!-- Vulnerability Modal -->","<div class=\"modal fade\" id=\"vulnerabilityModal\" tabindex=\"-1\">","    <div class=\"modal-dialog modal-lg\">","        <div class=\"modal-content\" style=\"background: var(--bg-secondary); border: 1px solid var(--border-color);\">","            <div class=\"modal-header\" style=\"border-bottom: 1px solid var(--border-color);\">","                <h5 class=\"modal-title\" style=\"color: #fff;\">","                    <i class=\"fas fa-exclamation-triangle\"></i> Device Vulnerabilities","                </h5>","                <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\"></button>","            </div>","            <div class=\"modal-body\" id=\"vulnerabilityContent\">","                <div class=\"text-center py-4\">","                    <div class=\"spinner-border text-primary\" role=\"status\">","                        <span class=\"visually-hidden\">Loading...</span>","                    </div>","                </div>","            </div>","        </div>","    </div>","</div>","","<script>","function showVulnerabilities(deviceIp) {","    const modal = new bootstrap.Modal(document.getElementById('vulnerabilityModal'));","    const content = document.getElementById('vulnerabilityContent');","    ","    content.innerHTML = `","        <div class=\"text-center py-4\">","            <div class=\"spinner-border text-primary\" role=\"status\">","                <span class=\"visually-hidden\">Loading...</span>","            </div>","        </div>","    `;","    ","    modal.show();","    ","    fetch('/iot-devices/' + deviceIp + '/vulnerabilities')","        .then(response => response.json())","        .then(vulnerabilities => {","            if (vulnerabilities.length === 0) {","                content.innerHTML = '<div class=\"text-center py-4\" style=\"color: var(--text-secondary);\">No vulnerabilities found</div>';","                return;","            }","            ","            let html = '';","            vulnerabilities.forEach(vuln => {","                const severityColor = {","                    'CRITICAL': '#f44336',","                    'HIGH': '#ff5722',","                    'MEDIUM': '#ff9800',","                    'LOW': '#ffc107'","                }[vuln.severity] || '#9e9e9e';","                ","                html += `","                    <div class=\"card mb-3\" style=\"background: var(--bg-primary); border-left: 4px solid ${severityColor};\">","                        <div class=\"card-body\">","                            <div class=\"d-flex justify-content-between align-items-start mb-2\">","                                <h6 style=\"color: #fff; margin: 0;\">","                                    <span class=\"badge\" style=\"background: ${severityColor};\">${vuln.severity}</span>","                                    ${vuln.vulnerability_type.replace(/_/g, ' ').toUpperCase()}","                                </h6>","                                <small style=\"color: var(--text-secondary);\">${vuln.detected_at.split(' ')[0]}</small>","                            </div>","                            <p style=\"color: var(--text-secondary); margin-bottom: 10px; font-size: 0.9rem;\">","                                ${vuln.description}","                            </p>","                            <div style=\"background: rgba(0, 212, 255, 0.05); padding: 10px; border-left: 3px solid var(--primary-color); border-radius: 4px;\">","                                <strong style=\"color: var(--primary-color); font-size: 0.85rem;\">","                                    <i class=\"fas fa-lightbulb\"></i> Recommendation:","                                </strong>","                                <div style=\"color: #fff; font-size: 0.85rem; margin-top: 5px;\">","                                    ${vuln.recommendation}","                                </div>","                            </div>","                        </div>","                    </div>","                `;","            });","            ","            content.innerHTML = html;","        })","        .catch(error => {","            content.innerHTML = '<div class=\"alert alert-danger\">Error loading vulnerabilities</div>';","            console.error('Error:', error);","        });","}","","// Auto-refresh every 60 seconds","setTimeout(() => location.reload(), 60000);","</script>","","<style>",".stat-card {","    background: var(--bg-secondary);","    border: 1px solid var(--border-color);","    border-radius: 8px;","    padding: 20px;","    transition: transform 0.2s;","}","",".stat-card:hover {","    transform: translateY(-2px);","}","",".stat-label {","    font-size: 0.85rem;","    color: var(--text-secondary);","    text-transform: uppercase;","    letter-spacing: 0.5px;","    margin-bottom: 10px;","}","",".stat-number {","    font-size: 2rem;","    font-weight: 700;","    color: var(--primary-color);","}","</style>","{% endblock %}","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000001,1000003,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000013,1000014,1000015,1000011,1000016,1000017,1000018,1000001,1000019,1000004,1000020,1000021,1000022,1000023,1000016,1000017,1000020,1000021,1000024,1000025,1000016,1000017,1000020,1000021,1000026,1000027,1000016,1000017,1000020,1000021,1000028,1000029,1000016,1000017,1000018,1000001,1000030,1000031,1000032,1000033,1000034,1000035,1000012,1000036,1000037,1000038,1000039,1000040,1000041,1000042,1000043,1000044,1000045,1000046,1000047,1000048,1000049,1000050,1000051,1000052,1000053,1000054,1000055,1000056,1000057,1000053,1000058,1000054,1000059,1000001,1000060,1000061,1000062,1000063,1000064,1000054,1000062,1000065,1000066,1000054,1000062,1000067,1000068,1000054,1000069,1000070,1000071,1000054,1000059,1000001,1000072,1000073,1000074,1000075,1000076,1000077,1000078,1000079,1000053,1000080,1000081,1000082,1000083,1000054,1000059,1000084,1000085,1000086,1000059,1000087,1000001,1000088,1000089,1000090,1000091,1000092,1000093,1000053,1000091,1000094,1000095,1000096,1000097,1000098,1000099,1000100,1000101,1000102,1000103,1000104,1000105,1000053,1000054,1000059,1000011,1000016,1000017,1000106,1000018,1000107,1000108,1000032,1000005,1000109,1000110,1000111,1000112,1000113,1000114,1000115,1000015,1000011,1000016,1000017,1000018,1000116,1000001,1000117,1000118,1000119,1000120,1000121,1000122,1000123,1000124,1000125,1000011,1000126,1000127,1000128,1000129,1000054,1000059,1000011,1000016,1000017,1000018,1000001,1000130,1000131,1000132,1000133,1000134,1000135,1000136,1000137,1000138,1000011,1000016,1000139,1000134,1000140,1000134,1000141,1000142,1000143,1000144,1000145,1000146,1000147,1000148,1000149,1000150,1000151,1000152,1000153,1000154,1000155,1000156,1000157,1000158,1000159,1000160,1000161,1000162,1000163,1000164,1000165,1000166,1000105,1000167,1000168,1000169,1000170,1000171,1000172,1000173,1000174,1000175,1000176,1000105,1000053,1000054,1000177,1000178,1000148,1000179,1000180,1000181,1000182,1000183,1000184,1000185,1000001,1000186,1000187,1000188,1000001,1000189,1000190,1000191,1000192,1000193,1000194,1000195,1000185,1000001,1000196,1000197,1000185,1000001,1000198,1000199,1000200,1000201,1000202,1000203,1000185,1000001,1000204,1000205,1000206,1000207,1000185,1000208,1000209,1000001,1000001]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}